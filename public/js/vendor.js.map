{"version":3,"sources":["select2.full.min.js","sweetalert.min.js","toastr.min.js","switchery.js","bootstrap-datepicker.js","bootstrap-datepicker.es.min.js","redactor.js","krause.js","table.js","imagemanager.js","filemanager.js","es_ar.js"],"names":[],"mappings":"AAAA;AACA;AACA;ACFA;ACAA;AACA;ACDA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvoDA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC38QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"vendor.js","sourcesContent":["/*! Select2 4.0.3 | https://github.com/select2/select2/blob/master/LICENSE.md */!function(a){\"function\"==typeof define&&define.amd?define([\"jquery\"],a):a(\"object\"==typeof exports?require(\"jquery\"):jQuery)}(function(a){var b=function(){if(a&&a.fn&&a.fn.select2&&a.fn.select2.amd)var b=a.fn.select2.amd;var b;return function(){if(!b||!b.requirejs){b?c=b:b={};var a,c,d;!function(b){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split(\"/\"),o=s.map,p=o&&o[\"*\"]||{};if(a&&\".\"===a.charAt(0))if(b){for(a=a.split(\"/\"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,\"\")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if(m=a[k],\".\"===m)a.splice(k,1),k-=1;else if(\"..\"===m){if(1===k&&(\"..\"===a[2]||\"..\"===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join(\"/\")}else 0===a.indexOf(\"./\")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split(\"/\"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join(\"/\"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join(\"/\")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join(\"/\"))}return a}function g(a,c){return function(){var d=v.call(arguments,0);return\"string\"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(b,d.concat([a,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var c=r[a];delete r[a],t[a]=!0,m.apply(b,c)}if(!e(q,a)&&!e(t,a))throw new Error(\"No \"+a);return q[a]}function k(a){var b,c=a?a.indexOf(\"!\"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+\"!\"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return\"undefined\"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:\"\",exports:q[a],config:l(a)}}},m=function(a,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||a,\"undefined\"===v||\"function\"===v){for(c=!c.length&&d.length?[\"require\",\"exports\",\"module\"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,\"require\"===k)u[n]=p.require(a);else if(\"exports\"===k)u[n]=p.exports(a),s=!0;else if(\"module\"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+\" missing \"+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[a],u):void 0,a&&(h&&h.exports!==b&&h.exports!==q[a]?q[a]=h.exports:l===b&&s||(q[a]=l))}else a&&(q[a]=d)},a=c=n=function(a,c,d,e,f){if(\"string\"==typeof a)return p[a]?p[a](c):j(o(a,c).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(a=c,c=d,d=null):a=b}return c=c||function(){},\"function\"==typeof d&&(d=e,e=f),e?m(b,a,c,d):setTimeout(function(){m(b,a,c,d)},4),n},n.config=function(a){return n(a)},a._defined=q,d=function(a,b,c){if(\"string\"!=typeof a)throw new Error(\"See almond README: incorrect module build, no module name\");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),b.requirejs=a,b.require=c,b.define=d}}(),b.define(\"almond\",function(){}),b.define(\"jquery\",[],function(){var b=a||$;return null==b&&console&&console.error&&console.error(\"Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page.\"),b}),b.define(\"select2/utils\",[\"jquery\"],function(a){function b(a){var b=a.prototype,c=[];for(var d in b){var e=b[d];\"function\"==typeof e&&\"constructor\"!==d&&c.push(d)}return c}var c={};c.Extend=function(a,b){function c(){this.constructor=a}var d={}.hasOwnProperty;for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},c.Decorate=function(a,c){function d(){var b=Array.prototype.unshift,d=c.prototype.constructor.length,e=a.prototype.constructor;d>0&&(b.call(arguments,a.prototype.constructor),e=c.prototype.constructor),e.apply(this,arguments)}function e(){this.constructor=d}var f=b(c),g=b(a);c.displayName=a.displayName,d.prototype=new e;for(var h=0;h<g.length;h++){var i=g[h];d.prototype[i]=a.prototype[i]}for(var j=(function(a){var b=function(){};a in d.prototype&&(b=d.prototype[a]);var e=c.prototype[a];return function(){var a=Array.prototype.unshift;return a.call(arguments,b),e.apply(this,arguments)}}),k=0;k<f.length;k++){var l=f[k];d.prototype[l]=j(l)}return d};var d=function(){this.listeners={}};return d.prototype.on=function(a,b){this.listeners=this.listeners||{},a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b]},d.prototype.trigger=function(a){var b=Array.prototype.slice,c=b.call(arguments,1);this.listeners=this.listeners||{},null==c&&(c=[]),0===c.length&&c.push({}),c[0]._type=a,a in this.listeners&&this.invoke(this.listeners[a],b.call(arguments,1)),\"*\"in this.listeners&&this.invoke(this.listeners[\"*\"],arguments)},d.prototype.invoke=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c].apply(this,b)},c.Observable=d,c.generateChars=function(a){for(var b=\"\",c=0;a>c;c++){var d=Math.floor(36*Math.random());b+=d.toString(36)}return b},c.bind=function(a,b){return function(){a.apply(b,arguments)}},c._convertData=function(a){for(var b in a){var c=b.split(\"-\"),d=a;if(1!==c.length){for(var e=0;e<c.length;e++){var f=c[e];f=f.substring(0,1).toLowerCase()+f.substring(1),f in d||(d[f]={}),e==c.length-1&&(d[f]=a[b]),d=d[f]}delete a[b]}}return a},c.hasScroll=function(b,c){var d=a(c),e=c.style.overflowX,f=c.style.overflowY;return e!==f||\"hidden\"!==f&&\"visible\"!==f?\"scroll\"===e||\"scroll\"===f?!0:d.innerHeight()<c.scrollHeight||d.innerWidth()<c.scrollWidth:!1},c.escapeMarkup=function(a){var b={\"\\\\\":\"&#92;\",\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"/\":\"&#47;\"};return\"string\"!=typeof a?a:String(a).replace(/[&<>\"'\\/\\\\]/g,function(a){return b[a]})},c.appendMany=function(b,c){if(\"1.7\"===a.fn.jquery.substr(0,3)){var d=a();a.map(c,function(a){d=d.add(a)}),c=d}b.append(c)},c}),b.define(\"select2/results\",[\"jquery\",\"./utils\"],function(a,b){function c(a,b,d){this.$element=a,this.data=d,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<ul class=\"select2-results__options\" role=\"tree\"></ul>');return this.options.get(\"multiple\")&&b.attr(\"aria-multiselectable\",\"true\"),this.$results=b,b},c.prototype.clear=function(){this.$results.empty()},c.prototype.displayMessage=function(b){var c=this.options.get(\"escapeMarkup\");this.clear(),this.hideLoading();var d=a('<li role=\"treeitem\" aria-live=\"assertive\" class=\"select2-results__option\"></li>'),e=this.options.get(\"translations\").get(b.message);d.append(c(e(b.args))),d[0].className+=\" select2-results__message\",this.$results.append(d)},c.prototype.hideMessages=function(){this.$results.find(\".select2-results__message\").remove()},c.prototype.append=function(a){this.hideLoading();var b=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger(\"results:message\",{message:\"noResults\"}));a.results=this.sort(a.results);for(var c=0;c<a.results.length;c++){var d=a.results[c],e=this.option(d);b.push(e)}this.$results.append(b)},c.prototype.position=function(a,b){var c=b.find(\".select2-results\");c.append(a)},c.prototype.sort=function(a){var b=this.options.get(\"sorter\");return b(a)},c.prototype.highlightFirstItem=function(){var a=this.$results.find(\".select2-results__option[aria-selected]\"),b=a.filter(\"[aria-selected=true]\");b.length>0?b.first().trigger(\"mouseenter\"):a.first().trigger(\"mouseenter\"),this.ensureHighlightVisible()},c.prototype.setClasses=function(){var b=this;this.data.current(function(c){var d=a.map(c,function(a){return a.id.toString()}),e=b.$results.find(\".select2-results__option[aria-selected]\");e.each(function(){var b=a(this),c=a.data(this,\"data\"),e=\"\"+c.id;null!=c.element&&c.element.selected||null==c.element&&a.inArray(e,d)>-1?b.attr(\"aria-selected\",\"true\"):b.attr(\"aria-selected\",\"false\")})})},c.prototype.showLoading=function(a){this.hideLoading();var b=this.options.get(\"translations\").get(\"searching\"),c={disabled:!0,loading:!0,text:b(a)},d=this.option(c);d.className+=\" loading-results\",this.$results.prepend(d)},c.prototype.hideLoading=function(){this.$results.find(\".loading-results\").remove()},c.prototype.option=function(b){var c=document.createElement(\"li\");c.className=\"select2-results__option\";var d={role:\"treeitem\",\"aria-selected\":\"false\"};b.disabled&&(delete d[\"aria-selected\"],d[\"aria-disabled\"]=\"true\"),null==b.id&&delete d[\"aria-selected\"],null!=b._resultId&&(c.id=b._resultId),b.title&&(c.title=b.title),b.children&&(d.role=\"group\",d[\"aria-label\"]=b.text,delete d[\"aria-selected\"]);for(var e in d){var f=d[e];c.setAttribute(e,f)}if(b.children){var g=a(c),h=document.createElement(\"strong\");h.className=\"select2-results__group\";a(h);this.template(b,h);for(var i=[],j=0;j<b.children.length;j++){var k=b.children[j],l=this.option(k);i.push(l)}var m=a(\"<ul></ul>\",{\"class\":\"select2-results__options select2-results__options--nested\"});m.append(i),g.append(h),g.append(m)}else this.template(b,c);return a.data(c,\"data\",b),c},c.prototype.bind=function(b,c){var d=this,e=b.id+\"-results\";this.$results.attr(\"id\",e),b.on(\"results:all\",function(a){d.clear(),d.append(a.data),b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"results:append\",function(a){d.append(a.data),b.isOpen()&&d.setClasses()}),b.on(\"query\",function(a){d.hideMessages(),d.showLoading(a)}),b.on(\"select\",function(){b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"unselect\",function(){b.isOpen()&&(d.setClasses(),d.highlightFirstItem())}),b.on(\"open\",function(){d.$results.attr(\"aria-expanded\",\"true\"),d.$results.attr(\"aria-hidden\",\"false\"),d.setClasses(),d.ensureHighlightVisible()}),b.on(\"close\",function(){d.$results.attr(\"aria-expanded\",\"false\"),d.$results.attr(\"aria-hidden\",\"true\"),d.$results.removeAttr(\"aria-activedescendant\")}),b.on(\"results:toggle\",function(){var a=d.getHighlightedResults();0!==a.length&&a.trigger(\"mouseup\")}),b.on(\"results:select\",function(){var a=d.getHighlightedResults();if(0!==a.length){var b=a.data(\"data\");\"true\"==a.attr(\"aria-selected\")?d.trigger(\"close\",{}):d.trigger(\"select\",{data:b})}}),b.on(\"results:previous\",function(){var a=d.getHighlightedResults(),b=d.$results.find(\"[aria-selected]\"),c=b.index(a);if(0!==c){var e=c-1;0===a.length&&(e=0);var f=b.eq(e);f.trigger(\"mouseenter\");var g=d.$results.offset().top,h=f.offset().top,i=d.$results.scrollTop()+(h-g);0===e?d.$results.scrollTop(0):0>h-g&&d.$results.scrollTop(i)}}),b.on(\"results:next\",function(){var a=d.getHighlightedResults(),b=d.$results.find(\"[aria-selected]\"),c=b.index(a),e=c+1;if(!(e>=b.length)){var f=b.eq(e);f.trigger(\"mouseenter\");var g=d.$results.offset().top+d.$results.outerHeight(!1),h=f.offset().top+f.outerHeight(!1),i=d.$results.scrollTop()+h-g;0===e?d.$results.scrollTop(0):h>g&&d.$results.scrollTop(i)}}),b.on(\"results:focus\",function(a){a.element.addClass(\"select2-results__option--highlighted\")}),b.on(\"results:message\",function(a){d.displayMessage(a)}),a.fn.mousewheel&&this.$results.on(\"mousewheel\",function(a){var b=d.$results.scrollTop(),c=d.$results.get(0).scrollHeight-b+a.deltaY,e=a.deltaY>0&&b-a.deltaY<=0,f=a.deltaY<0&&c<=d.$results.height();e?(d.$results.scrollTop(0),a.preventDefault(),a.stopPropagation()):f&&(d.$results.scrollTop(d.$results.get(0).scrollHeight-d.$results.height()),a.preventDefault(),a.stopPropagation())}),this.$results.on(\"mouseup\",\".select2-results__option[aria-selected]\",function(b){var c=a(this),e=c.data(\"data\");return\"true\"===c.attr(\"aria-selected\")?void(d.options.get(\"multiple\")?d.trigger(\"unselect\",{originalEvent:b,data:e}):d.trigger(\"close\",{})):void d.trigger(\"select\",{originalEvent:b,data:e})}),this.$results.on(\"mouseenter\",\".select2-results__option[aria-selected]\",function(b){var c=a(this).data(\"data\");d.getHighlightedResults().removeClass(\"select2-results__option--highlighted\"),d.trigger(\"results:focus\",{data:c,element:a(this)})})},c.prototype.getHighlightedResults=function(){var a=this.$results.find(\".select2-results__option--highlighted\");return a},c.prototype.destroy=function(){this.$results.remove()},c.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var b=this.$results.find(\"[aria-selected]\"),c=b.index(a),d=this.$results.offset().top,e=a.offset().top,f=this.$results.scrollTop()+(e-d),g=e-d;f-=2*a.outerHeight(!1),2>=c?this.$results.scrollTop(0):(g>this.$results.outerHeight()||0>g)&&this.$results.scrollTop(f)}},c.prototype.template=function(b,c){var d=this.options.get(\"templateResult\"),e=this.options.get(\"escapeMarkup\"),f=d(b,c);null==f?c.style.display=\"none\":\"string\"==typeof f?c.innerHTML=e(f):a(c).append(f)},c}),b.define(\"select2/keys\",[],function(){var a={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return a}),b.define(\"select2/selection/base\",[\"jquery\",\"../utils\",\"../keys\"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,b.Observable),d.prototype.render=function(){var b=a('<span class=\"select2-selection\" role=\"combobox\"  aria-haspopup=\"true\" aria-expanded=\"false\"></span>');return this._tabindex=0,null!=this.$element.data(\"old-tabindex\")?this._tabindex=this.$element.data(\"old-tabindex\"):null!=this.$element.attr(\"tabindex\")&&(this._tabindex=this.$element.attr(\"tabindex\")),b.attr(\"title\",this.$element.attr(\"title\")),b.attr(\"tabindex\",this._tabindex),this.$selection=b,b},d.prototype.bind=function(a,b){var d=this,e=(a.id+\"-container\",a.id+\"-results\");this.container=a,this.$selection.on(\"focus\",function(a){d.trigger(\"focus\",a)}),this.$selection.on(\"blur\",function(a){d._handleBlur(a)}),this.$selection.on(\"keydown\",function(a){d.trigger(\"keypress\",a),a.which===c.SPACE&&a.preventDefault()}),a.on(\"results:focus\",function(a){d.$selection.attr(\"aria-activedescendant\",a.data._resultId)}),a.on(\"selection:update\",function(a){d.update(a.data)}),a.on(\"open\",function(){d.$selection.attr(\"aria-expanded\",\"true\"),d.$selection.attr(\"aria-owns\",e),d._attachCloseHandler(a)}),a.on(\"close\",function(){d.$selection.attr(\"aria-expanded\",\"false\"),d.$selection.removeAttr(\"aria-activedescendant\"),d.$selection.removeAttr(\"aria-owns\"),d.$selection.focus(),d._detachCloseHandler(a)}),a.on(\"enable\",function(){d.$selection.attr(\"tabindex\",d._tabindex)}),a.on(\"disable\",function(){d.$selection.attr(\"tabindex\",\"-1\")})},d.prototype._handleBlur=function(b){var c=this;window.setTimeout(function(){document.activeElement==c.$selection[0]||a.contains(c.$selection[0],document.activeElement)||c.trigger(\"blur\",b)},1)},d.prototype._attachCloseHandler=function(b){a(document.body).on(\"mousedown.select2.\"+b.id,function(b){var c=a(b.target),d=c.closest(\".select2\"),e=a(\".select2.select2-container--open\");e.each(function(){var b=a(this);if(this!=d[0]){var c=b.data(\"element\");c.select2(\"close\")}})})},d.prototype._detachCloseHandler=function(b){a(document.body).off(\"mousedown.select2.\"+b.id)},d.prototype.position=function(a,b){var c=b.find(\".selection\");c.append(a)},d.prototype.destroy=function(){this._detachCloseHandler(this.container)},d.prototype.update=function(a){throw new Error(\"The `update` method must be defined in child classes.\")},d}),b.define(\"select2/selection/single\",[\"jquery\",\"./base\",\"../utils\",\"../keys\"],function(a,b,c,d){function e(){e.__super__.constructor.apply(this,arguments)}return c.Extend(e,b),e.prototype.render=function(){var a=e.__super__.render.call(this);return a.addClass(\"select2-selection--single\"),a.html('<span class=\"select2-selection__rendered\"></span><span class=\"select2-selection__arrow\" role=\"presentation\"><b role=\"presentation\"></b></span>'),a},e.prototype.bind=function(a,b){var c=this;e.__super__.bind.apply(this,arguments);var d=a.id+\"-container\";this.$selection.find(\".select2-selection__rendered\").attr(\"id\",d),this.$selection.attr(\"aria-labelledby\",d),this.$selection.on(\"mousedown\",function(a){1===a.which&&c.trigger(\"toggle\",{originalEvent:a})}),this.$selection.on(\"focus\",function(a){}),this.$selection.on(\"blur\",function(a){}),a.on(\"focus\",function(b){a.isOpen()||c.$selection.focus()}),a.on(\"selection:update\",function(a){c.update(a.data)})},e.prototype.clear=function(){this.$selection.find(\".select2-selection__rendered\").empty()},e.prototype.display=function(a,b){var c=this.options.get(\"templateSelection\"),d=this.options.get(\"escapeMarkup\");return d(c(a,b))},e.prototype.selectionContainer=function(){return a(\"<span></span>\")},e.prototype.update=function(a){if(0===a.length)return void this.clear();var b=a[0],c=this.$selection.find(\".select2-selection__rendered\"),d=this.display(b,c);c.empty().append(d),c.prop(\"title\",b.title||b.text)},e}),b.define(\"select2/selection/multiple\",[\"jquery\",\"./base\",\"../utils\"],function(a,b,c){function d(a,b){d.__super__.constructor.apply(this,arguments)}return c.Extend(d,b),d.prototype.render=function(){var a=d.__super__.render.call(this);return a.addClass(\"select2-selection--multiple\"),a.html('<ul class=\"select2-selection__rendered\"></ul>'),a},d.prototype.bind=function(b,c){var e=this;d.__super__.bind.apply(this,arguments),this.$selection.on(\"click\",function(a){e.trigger(\"toggle\",{originalEvent:a})}),this.$selection.on(\"click\",\".select2-selection__choice__remove\",function(b){if(!e.options.get(\"disabled\")){var c=a(this),d=c.parent(),f=d.data(\"data\");e.trigger(\"unselect\",{originalEvent:b,data:f})}})},d.prototype.clear=function(){this.$selection.find(\".select2-selection__rendered\").empty()},d.prototype.display=function(a,b){var c=this.options.get(\"templateSelection\"),d=this.options.get(\"escapeMarkup\");return d(c(a,b))},d.prototype.selectionContainer=function(){var b=a('<li class=\"select2-selection__choice\"><span class=\"select2-selection__choice__remove\" role=\"presentation\">&times;</span></li>');return b},d.prototype.update=function(a){if(this.clear(),0!==a.length){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=this.selectionContainer(),g=this.display(e,f);f.append(g),f.prop(\"title\",e.title||e.text),f.data(\"data\",e),b.push(f)}var h=this.$selection.find(\".select2-selection__rendered\");c.appendMany(h,b)}},d}),b.define(\"select2/selection/placeholder\",[\"../utils\"],function(a){function b(a,b,c){this.placeholder=this.normalizePlaceholder(c.get(\"placeholder\")),a.call(this,b,c)}return b.prototype.normalizePlaceholder=function(a,b){return\"string\"==typeof b&&(b={id:\"\",text:b}),b},b.prototype.createPlaceholder=function(a,b){var c=this.selectionContainer();return c.html(this.display(b)),c.addClass(\"select2-selection__placeholder\").removeClass(\"select2-selection__choice\"),c},b.prototype.update=function(a,b){var c=1==b.length&&b[0].id!=this.placeholder.id,d=b.length>1;if(d||c)return a.call(this,b);this.clear();var e=this.createPlaceholder(this.placeholder);this.$selection.find(\".select2-selection__rendered\").append(e)},b}),b.define(\"select2/selection/allowClear\",[\"jquery\",\"../keys\"],function(a,b){function c(){}return c.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),null==this.placeholder&&this.options.get(\"debug\")&&window.console&&console.error&&console.error(\"Select2: The `allowClear` option should be used in combination with the `placeholder` option.\"),this.$selection.on(\"mousedown\",\".select2-selection__clear\",function(a){d._handleClear(a)}),b.on(\"keypress\",function(a){d._handleKeyboardClear(a,b)})},c.prototype._handleClear=function(a,b){if(!this.options.get(\"disabled\")){var c=this.$selection.find(\".select2-selection__clear\");if(0!==c.length){b.stopPropagation();for(var d=c.data(\"data\"),e=0;e<d.length;e++){var f={data:d[e]};if(this.trigger(\"unselect\",f),f.prevented)return}this.$element.val(this.placeholder.id).trigger(\"change\"),this.trigger(\"toggle\",{})}}},c.prototype._handleKeyboardClear=function(a,c,d){d.isOpen()||(c.which==b.DELETE||c.which==b.BACKSPACE)&&this._handleClear(c)},c.prototype.update=function(b,c){if(b.call(this,c),!(this.$selection.find(\".select2-selection__placeholder\").length>0||0===c.length)){var d=a('<span class=\"select2-selection__clear\">&times;</span>');d.data(\"data\",c),this.$selection.find(\".select2-selection__rendered\").prepend(d)}},c}),b.define(\"select2/selection/search\",[\"jquery\",\"../utils\",\"../keys\"],function(a,b,c){function d(a,b,c){a.call(this,b,c)}return d.prototype.render=function(b){var c=a('<li class=\"select2-search select2-search--inline\"><input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" role=\"textbox\" aria-autocomplete=\"list\" /></li>');this.$searchContainer=c,this.$search=c.find(\"input\");var d=b.call(this);return this._transferTabIndex(),d},d.prototype.bind=function(a,b,d){var e=this;a.call(this,b,d),b.on(\"open\",function(){e.$search.trigger(\"focus\")}),b.on(\"close\",function(){e.$search.val(\"\"),e.$search.removeAttr(\"aria-activedescendant\"),e.$search.trigger(\"focus\")}),b.on(\"enable\",function(){e.$search.prop(\"disabled\",!1),e._transferTabIndex()}),b.on(\"disable\",function(){e.$search.prop(\"disabled\",!0)}),b.on(\"focus\",function(a){e.$search.trigger(\"focus\")}),b.on(\"results:focus\",function(a){e.$search.attr(\"aria-activedescendant\",a.id)}),this.$selection.on(\"focusin\",\".select2-search--inline\",function(a){e.trigger(\"focus\",a)}),this.$selection.on(\"focusout\",\".select2-search--inline\",function(a){e._handleBlur(a)}),this.$selection.on(\"keydown\",\".select2-search--inline\",function(a){a.stopPropagation(),e.trigger(\"keypress\",a),e._keyUpPrevented=a.isDefaultPrevented();var b=a.which;if(b===c.BACKSPACE&&\"\"===e.$search.val()){var d=e.$searchContainer.prev(\".select2-selection__choice\");if(d.length>0){var f=d.data(\"data\");e.searchRemoveChoice(f),a.preventDefault()}}});var f=document.documentMode,g=f&&11>=f;this.$selection.on(\"input.searchcheck\",\".select2-search--inline\",function(a){return g?void e.$selection.off(\"input.search input.searchcheck\"):void e.$selection.off(\"keyup.search\")}),this.$selection.on(\"keyup.search input.search\",\".select2-search--inline\",function(a){if(g&&\"input\"===a.type)return void e.$selection.off(\"input.search input.searchcheck\");var b=a.which;b!=c.SHIFT&&b!=c.CTRL&&b!=c.ALT&&b!=c.TAB&&e.handleSearch(a)})},d.prototype._transferTabIndex=function(a){this.$search.attr(\"tabindex\",this.$selection.attr(\"tabindex\")),this.$selection.attr(\"tabindex\",\"-1\")},d.prototype.createPlaceholder=function(a,b){this.$search.attr(\"placeholder\",b.text)},d.prototype.update=function(a,b){var c=this.$search[0]==document.activeElement;this.$search.attr(\"placeholder\",\"\"),a.call(this,b),this.$selection.find(\".select2-selection__rendered\").append(this.$searchContainer),this.resizeSearch(),c&&this.$search.focus()},d.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var a=this.$search.val();this.trigger(\"query\",{term:a})}this._keyUpPrevented=!1},d.prototype.searchRemoveChoice=function(a,b){this.trigger(\"unselect\",{data:b}),this.$search.val(b.text),this.handleSearch()},d.prototype.resizeSearch=function(){this.$search.css(\"width\",\"25px\");var a=\"\";if(\"\"!==this.$search.attr(\"placeholder\"))a=this.$selection.find(\".select2-selection__rendered\").innerWidth();else{var b=this.$search.val().length+1;a=.75*b+\"em\"}this.$search.css(\"width\",a)},d}),b.define(\"select2/selection/eventRelay\",[\"jquery\"],function(a){function b(){}return b.prototype.bind=function(b,c,d){var e=this,f=[\"open\",\"opening\",\"close\",\"closing\",\"select\",\"selecting\",\"unselect\",\"unselecting\"],g=[\"opening\",\"closing\",\"selecting\",\"unselecting\"];b.call(this,c,d),c.on(\"*\",function(b,c){if(-1!==a.inArray(b,f)){c=c||{};var d=a.Event(\"select2:\"+b,{params:c});e.$element.trigger(d),-1!==a.inArray(b,g)&&(c.prevented=d.isDefaultPrevented())}})},b}),b.define(\"select2/translation\",[\"jquery\",\"require\"],function(a,b){function c(a){this.dict=a||{}}return c.prototype.all=function(){return this.dict},c.prototype.get=function(a){return this.dict[a]},c.prototype.extend=function(b){this.dict=a.extend({},b.all(),this.dict)},c._cache={},c.loadPath=function(a){if(!(a in c._cache)){var d=b(a);c._cache[a]=d}return new c(c._cache[a])},c}),b.define(\"select2/diacritics\",[],function(){var a={\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"AA\",\"\":\"AE\",\"\":\"AE\",\"\":\"AE\",\"\":\"AO\",\"\":\"AU\",\"\":\"AV\",\"\":\"AV\",\"\":\"AY\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"B\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"D\",\"\":\"DZ\",\"\":\"DZ\",\"\":\"Dz\",\"\":\"Dz\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"F\",\"\":\"F\",\"\":\"F\",\"\":\"F\",\"\":\"F\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"H\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"J\",\"\":\"J\",\"\":\"J\",\"\":\"J\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"K\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"LJ\",\"\":\"Lj\",\"\":\"M\",\"\":\"M\",\"\":\"M\",\"\":\"M\",\"\":\"M\",\"\":\"M\",\"\":\"M\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"NJ\",\"\":\"Nj\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"OI\",\"\":\"OO\",\"\":\"OU\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"P\",\"\":\"Q\",\"\":\"Q\",\"\":\"Q\",\"\":\"Q\",\"\":\"Q\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"TZ\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"V\",\"\":\"V\",\"\":\"V\",\"\":\"V\",\"\":\"V\",\"\":\"V\",\"\":\"V\",\"\":\"VY\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"W\",\"\":\"X\",\"\":\"X\",\"\":\"X\",\"\":\"X\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Y\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"aa\",\"\":\"ae\",\"\":\"ae\",\"\":\"ae\",\"\":\"ao\",\"\":\"au\",\"\":\"av\",\"\":\"av\",\"\":\"ay\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"b\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"d\",\"\":\"dz\",\"\":\"dz\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"f\",\"\":\"f\",\"\":\"f\",\"\":\"f\",\"\":\"f\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"h\",\"\":\"hv\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"j\",\"\":\"j\",\"\":\"j\",\"\":\"j\",\"\":\"j\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"k\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"lj\",\"\":\"m\",\"\":\"m\",\"\":\"m\",\"\":\"m\",\"\":\"m\",\"\":\"m\",\"\":\"m\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"nj\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"oi\",\"\":\"ou\",\"\":\"oo\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"p\",\"\":\"q\",\"\":\"q\",\"\":\"q\",\"\":\"q\",\"\":\"q\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"tz\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"v\",\"\":\"v\",\"\":\"v\",\"\":\"v\",\"\":\"v\",\"\":\"v\",\"\":\"v\",\"\":\"vy\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"w\",\"\":\"x\",\"\":\"x\",\"\":\"x\",\"\":\"x\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"y\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\",\"\":\"\"};return a}),b.define(\"select2/data/base\",[\"../utils\"],function(a){function b(a,c){b.__super__.constructor.call(this)}return a.Extend(b,a.Observable),b.prototype.current=function(a){throw new Error(\"The `current` method must be defined in child classes.\")},b.prototype.query=function(a,b){throw new Error(\"The `query` method must be defined in child classes.\")},b.prototype.bind=function(a,b){},b.prototype.destroy=function(){},b.prototype.generateResultId=function(b,c){var d=b.id+\"-result-\";return d+=a.generateChars(4),d+=null!=c.id?\"-\"+c.id.toString():\"-\"+a.generateChars(4)},b}),b.define(\"select2/data/select\",[\"./base\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,a),d.prototype.current=function(a){var b=[],d=this;this.$element.find(\":selected\").each(function(){var a=c(this),e=d.item(a);b.push(e)}),a(b)},d.prototype.select=function(a){var b=this;if(a.selected=!0,c(a.element).is(\"option\"))return a.element.selected=!0,void this.$element.trigger(\"change\");\nif(this.$element.prop(\"multiple\"))this.current(function(d){var e=[];a=[a],a.push.apply(a,d);for(var f=0;f<a.length;f++){var g=a[f].id;-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger(\"change\")});else{var d=a.id;this.$element.val(d),this.$element.trigger(\"change\")}},d.prototype.unselect=function(a){var b=this;if(this.$element.prop(\"multiple\"))return a.selected=!1,c(a.element).is(\"option\")?(a.element.selected=!1,void this.$element.trigger(\"change\")):void this.current(function(d){for(var e=[],f=0;f<d.length;f++){var g=d[f].id;g!==a.id&&-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger(\"change\")})},d.prototype.bind=function(a,b){var c=this;this.container=a,a.on(\"select\",function(a){c.select(a.data)}),a.on(\"unselect\",function(a){c.unselect(a.data)})},d.prototype.destroy=function(){this.$element.find(\"*\").each(function(){c.removeData(this,\"data\")})},d.prototype.query=function(a,b){var d=[],e=this,f=this.$element.children();f.each(function(){var b=c(this);if(b.is(\"option\")||b.is(\"optgroup\")){var f=e.item(b),g=e.matches(a,f);null!==g&&d.push(g)}}),b({results:d})},d.prototype.addOptions=function(a){b.appendMany(this.$element,a)},d.prototype.option=function(a){var b;a.children?(b=document.createElement(\"optgroup\"),b.label=a.text):(b=document.createElement(\"option\"),void 0!==b.textContent?b.textContent=a.text:b.innerText=a.text),a.id&&(b.value=a.id),a.disabled&&(b.disabled=!0),a.selected&&(b.selected=!0),a.title&&(b.title=a.title);var d=c(b),e=this._normalizeItem(a);return e.element=b,c.data(b,\"data\",e),d},d.prototype.item=function(a){var b={};if(b=c.data(a[0],\"data\"),null!=b)return b;if(a.is(\"option\"))b={id:a.val(),text:a.text(),disabled:a.prop(\"disabled\"),selected:a.prop(\"selected\"),title:a.prop(\"title\")};else if(a.is(\"optgroup\")){b={text:a.prop(\"label\"),children:[],title:a.prop(\"title\")};for(var d=a.children(\"option\"),e=[],f=0;f<d.length;f++){var g=c(d[f]),h=this.item(g);e.push(h)}b.children=e}return b=this._normalizeItem(b),b.element=a[0],c.data(a[0],\"data\",b),b},d.prototype._normalizeItem=function(a){c.isPlainObject(a)||(a={id:a,text:a}),a=c.extend({},{text:\"\"},a);var b={selected:!1,disabled:!1};return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),c.extend({},b,a)},d.prototype.matches=function(a,b){var c=this.options.get(\"matcher\");return c(a,b)},d}),b.define(\"select2/data/array\",[\"./select\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){var c=b.get(\"data\")||[];d.__super__.constructor.call(this,a,b),this.addOptions(this.convertToOptions(c))}return b.Extend(d,a),d.prototype.select=function(a){var b=this.$element.find(\"option\").filter(function(b,c){return c.value==a.id.toString()});0===b.length&&(b=this.option(a),this.addOptions(b)),d.__super__.select.call(this,a)},d.prototype.convertToOptions=function(a){function d(a){return function(){return c(this).val()==a.id}}for(var e=this,f=this.$element.find(\"option\"),g=f.map(function(){return e.item(c(this)).id}).get(),h=[],i=0;i<a.length;i++){var j=this._normalizeItem(a[i]);if(c.inArray(j.id,g)>=0){var k=f.filter(d(j)),l=this.item(k),m=c.extend(!0,{},j,l),n=this.option(m);k.replaceWith(n)}else{var o=this.option(j);if(j.children){var p=this.convertToOptions(j.children);b.appendMany(o,p)}h.push(o)}}return h},d}),b.define(\"select2/data/ajax\",[\"./array\",\"../utils\",\"jquery\"],function(a,b,c){function d(a,b){this.ajaxOptions=this._applyDefaults(b.get(\"ajax\")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),d.__super__.constructor.call(this,a,b)}return b.Extend(d,a),d.prototype._applyDefaults=function(a){var b={data:function(a){return c.extend({},a,{q:a.term})},transport:function(a,b,d){var e=c.ajax(a);return e.then(b),e.fail(d),e}};return c.extend({},b,a,!0)},d.prototype.processResults=function(a){return a},d.prototype.query=function(a,b){function d(){var d=f.transport(f,function(d){var f=e.processResults(d,a);e.options.get(\"debug\")&&window.console&&console.error&&(f&&f.results&&c.isArray(f.results)||console.error(\"Select2: The AJAX results did not return an array in the `results` key of the response.\")),b(f)},function(){d.status&&\"0\"===d.status||e.trigger(\"results:message\",{message:\"errorLoading\"})});e._request=d}var e=this;null!=this._request&&(c.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=c.extend({type:\"GET\"},this.ajaxOptions);\"function\"==typeof f.url&&(f.url=f.url.call(this.$element,a)),\"function\"==typeof f.data&&(f.data=f.data.call(this.$element,a)),this.ajaxOptions.delay&&null!=a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(d,this.ajaxOptions.delay)):d()},d}),b.define(\"select2/data/tags\",[\"jquery\"],function(a){function b(b,c,d){var e=d.get(\"tags\"),f=d.get(\"createTag\");void 0!==f&&(this.createTag=f);var g=d.get(\"insertTag\");if(void 0!==g&&(this.insertTag=g),b.call(this,c,d),a.isArray(e))for(var h=0;h<e.length;h++){var i=e[h],j=this._normalizeItem(i),k=this.option(j);this.$element.append(k)}}return b.prototype.query=function(a,b,c){function d(a,f){for(var g=a.results,h=0;h<g.length;h++){var i=g[h],j=null!=i.children&&!d({results:i.children},!0),k=i.text===b.term;if(k||j)return f?!1:(a.data=g,void c(a))}if(f)return!0;var l=e.createTag(b);if(null!=l){var m=e.option(l);m.attr(\"data-select2-tag\",!0),e.addOptions([m]),e.insertTag(g,l)}a.results=g,c(a)}var e=this;return this._removeOldTags(),null==b.term||null!=b.page?void a.call(this,b,c):void a.call(this,b,d)},b.prototype.createTag=function(b,c){var d=a.trim(c.term);return\"\"===d?null:{id:d,text:d}},b.prototype.insertTag=function(a,b,c){b.unshift(c)},b.prototype._removeOldTags=function(b){var c=(this._lastTag,this.$element.find(\"option[data-select2-tag]\"));c.each(function(){this.selected||a(this).remove()})},b}),b.define(\"select2/data/tokenizer\",[\"jquery\"],function(a){function b(a,b,c){var d=c.get(\"tokenizer\");void 0!==d&&(this.tokenizer=d),a.call(this,b,c)}return b.prototype.bind=function(a,b,c){a.call(this,b,c),this.$search=b.dropdown.$search||b.selection.$search||c.find(\".select2-search__field\")},b.prototype.query=function(b,c,d){function e(b){var c=g._normalizeItem(b),d=g.$element.find(\"option\").filter(function(){return a(this).val()===c.id});if(!d.length){var e=g.option(c);e.attr(\"data-select2-tag\",!0),g._removeOldTags(),g.addOptions([e])}f(c)}function f(a){g.trigger(\"select\",{data:a})}var g=this;c.term=c.term||\"\";var h=this.tokenizer(c,this.options,e);h.term!==c.term&&(this.$search.length&&(this.$search.val(h.term),this.$search.focus()),c.term=h.term),b.call(this,c,d)},b.prototype.tokenizer=function(b,c,d,e){for(var f=d.get(\"tokenSeparators\")||[],g=c.term,h=0,i=this.createTag||function(a){return{id:a.term,text:a.term}};h<g.length;){var j=g[h];if(-1!==a.inArray(j,f)){var k=g.substr(0,h),l=a.extend({},c,{term:k}),m=i(l);null!=m?(e(m),g=g.substr(h+1)||\"\",h=0):h++}else h++}return{term:g}},b}),b.define(\"select2/data/minimumInputLength\",[],function(){function a(a,b,c){this.minimumInputLength=c.get(\"minimumInputLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||\"\",b.term.length<this.minimumInputLength?void this.trigger(\"results:message\",{message:\"inputTooShort\",args:{minimum:this.minimumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define(\"select2/data/maximumInputLength\",[],function(){function a(a,b,c){this.maximumInputLength=c.get(\"maximumInputLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||\"\",this.maximumInputLength>0&&b.term.length>this.maximumInputLength?void this.trigger(\"results:message\",{message:\"inputTooLong\",args:{maximum:this.maximumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define(\"select2/data/maximumSelectionLength\",[],function(){function a(a,b,c){this.maximumSelectionLength=c.get(\"maximumSelectionLength\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){var d=this;this.current(function(e){var f=null!=e?e.length:0;return d.maximumSelectionLength>0&&f>=d.maximumSelectionLength?void d.trigger(\"results:message\",{message:\"maximumSelected\",args:{maximum:d.maximumSelectionLength}}):void a.call(d,b,c)})},a}),b.define(\"select2/dropdown\",[\"jquery\",\"./utils\"],function(a,b){function c(a,b){this.$element=a,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<span class=\"select2-dropdown\"><span class=\"select2-results\"></span></span>');return b.attr(\"dir\",this.options.get(\"dir\")),this.$dropdown=b,b},c.prototype.bind=function(){},c.prototype.position=function(a,b){},c.prototype.destroy=function(){this.$dropdown.remove()},c}),b.define(\"select2/dropdown/search\",[\"jquery\",\"../utils\"],function(a,b){function c(){}return c.prototype.render=function(b){var c=b.call(this),d=a('<span class=\"select2-search select2-search--dropdown\"><input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" role=\"textbox\" /></span>');return this.$searchContainer=d,this.$search=d.find(\"input\"),c.prepend(d),c},c.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),this.$search.on(\"keydown\",function(a){e.trigger(\"keypress\",a),e._keyUpPrevented=a.isDefaultPrevented()}),this.$search.on(\"input\",function(b){a(this).off(\"keyup\")}),this.$search.on(\"keyup input\",function(a){e.handleSearch(a)}),c.on(\"open\",function(){e.$search.attr(\"tabindex\",0),e.$search.focus(),window.setTimeout(function(){e.$search.focus()},0)}),c.on(\"close\",function(){e.$search.attr(\"tabindex\",-1),e.$search.val(\"\")}),c.on(\"focus\",function(){c.isOpen()&&e.$search.focus()}),c.on(\"results:all\",function(a){if(null==a.query.term||\"\"===a.query.term){var b=e.showSearch(a);b?e.$searchContainer.removeClass(\"select2-search--hide\"):e.$searchContainer.addClass(\"select2-search--hide\")}})},c.prototype.handleSearch=function(a){if(!this._keyUpPrevented){var b=this.$search.val();this.trigger(\"query\",{term:b})}this._keyUpPrevented=!1},c.prototype.showSearch=function(a,b){return!0},c}),b.define(\"select2/dropdown/hidePlaceholder\",[],function(){function a(a,b,c,d){this.placeholder=this.normalizePlaceholder(c.get(\"placeholder\")),a.call(this,b,c,d)}return a.prototype.append=function(a,b){b.results=this.removePlaceholder(b.results),a.call(this,b)},a.prototype.normalizePlaceholder=function(a,b){return\"string\"==typeof b&&(b={id:\"\",text:b}),b},a.prototype.removePlaceholder=function(a,b){for(var c=b.slice(0),d=b.length-1;d>=0;d--){var e=b[d];this.placeholder.id===e.id&&c.splice(d,1)}return c},a}),b.define(\"select2/dropdown/infiniteScroll\",[\"jquery\"],function(a){function b(a,b,c,d){this.lastParams={},a.call(this,b,c,d),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return b.prototype.append=function(a,b){this.$loadingMore.remove(),this.loading=!1,a.call(this,b),this.showLoadingMore(b)&&this.$results.append(this.$loadingMore)},b.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),c.on(\"query\",function(a){e.lastParams=a,e.loading=!0}),c.on(\"query:append\",function(a){e.lastParams=a,e.loading=!0}),this.$results.on(\"scroll\",function(){var b=a.contains(document.documentElement,e.$loadingMore[0]);if(!e.loading&&b){var c=e.$results.offset().top+e.$results.outerHeight(!1),d=e.$loadingMore.offset().top+e.$loadingMore.outerHeight(!1);c+50>=d&&e.loadMore()}})},b.prototype.loadMore=function(){this.loading=!0;var b=a.extend({},{page:1},this.lastParams);b.page++,this.trigger(\"query:append\",b)},b.prototype.showLoadingMore=function(a,b){return b.pagination&&b.pagination.more},b.prototype.createLoadingMore=function(){var b=a('<li class=\"select2-results__option select2-results__option--load-more\"role=\"treeitem\" aria-disabled=\"true\"></li>'),c=this.options.get(\"translations\").get(\"loadingMore\");return b.html(c(this.lastParams)),b},b}),b.define(\"select2/dropdown/attachBody\",[\"jquery\",\"../utils\"],function(a,b){function c(b,c,d){this.$dropdownParent=d.get(\"dropdownParent\")||a(document.body),b.call(this,c,d)}return c.prototype.bind=function(a,b,c){var d=this,e=!1;a.call(this,b,c),b.on(\"open\",function(){d._showDropdown(),d._attachPositioningHandler(b),e||(e=!0,b.on(\"results:all\",function(){d._positionDropdown(),d._resizeDropdown()}),b.on(\"results:append\",function(){d._positionDropdown(),d._resizeDropdown()}))}),b.on(\"close\",function(){d._hideDropdown(),d._detachPositioningHandler(b)}),this.$dropdownContainer.on(\"mousedown\",function(a){a.stopPropagation()})},c.prototype.destroy=function(a){a.call(this),this.$dropdownContainer.remove()},c.prototype.position=function(a,b,c){b.attr(\"class\",c.attr(\"class\")),b.removeClass(\"select2\"),b.addClass(\"select2-container--open\"),b.css({position:\"absolute\",top:-999999}),this.$container=c},c.prototype.render=function(b){var c=a(\"<span></span>\"),d=b.call(this);return c.append(d),this.$dropdownContainer=c,c},c.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},c.prototype._attachPositioningHandler=function(c,d){var e=this,f=\"scroll.select2.\"+d.id,g=\"resize.select2.\"+d.id,h=\"orientationchange.select2.\"+d.id,i=this.$container.parents().filter(b.hasScroll);i.each(function(){a(this).data(\"select2-scroll-position\",{x:a(this).scrollLeft(),y:a(this).scrollTop()})}),i.on(f,function(b){var c=a(this).data(\"select2-scroll-position\");a(this).scrollTop(c.y)}),a(window).on(f+\" \"+g+\" \"+h,function(a){e._positionDropdown(),e._resizeDropdown()})},c.prototype._detachPositioningHandler=function(c,d){var e=\"scroll.select2.\"+d.id,f=\"resize.select2.\"+d.id,g=\"orientationchange.select2.\"+d.id,h=this.$container.parents().filter(b.hasScroll);h.off(e),a(window).off(e+\" \"+f+\" \"+g)},c.prototype._positionDropdown=function(){var b=a(window),c=this.$dropdown.hasClass(\"select2-dropdown--above\"),d=this.$dropdown.hasClass(\"select2-dropdown--below\"),e=null,f=this.$container.offset();f.bottom=f.top+this.$container.outerHeight(!1);var g={height:this.$container.outerHeight(!1)};g.top=f.top,g.bottom=f.top+g.height;var h={height:this.$dropdown.outerHeight(!1)},i={top:b.scrollTop(),bottom:b.scrollTop()+b.height()},j=i.top<f.top-h.height,k=i.bottom>f.bottom+h.height,l={left:f.left,top:g.bottom},m=this.$dropdownParent;\"static\"===m.css(\"position\")&&(m=m.offsetParent());var n=m.offset();l.top-=n.top,l.left-=n.left,c||d||(e=\"below\"),k||!j||c?!j&&k&&c&&(e=\"below\"):e=\"above\",(\"above\"==e||c&&\"below\"!==e)&&(l.top=g.top-n.top-h.height),null!=e&&(this.$dropdown.removeClass(\"select2-dropdown--below select2-dropdown--above\").addClass(\"select2-dropdown--\"+e),this.$container.removeClass(\"select2-container--below select2-container--above\").addClass(\"select2-container--\"+e)),this.$dropdownContainer.css(l)},c.prototype._resizeDropdown=function(){var a={width:this.$container.outerWidth(!1)+\"px\"};this.options.get(\"dropdownAutoWidth\")&&(a.minWidth=a.width,a.position=\"relative\",a.width=\"auto\"),this.$dropdown.css(a)},c.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},c}),b.define(\"select2/dropdown/minimumResultsForSearch\",[],function(){function a(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];e.children?c+=a(e.children):c++}return c}function b(a,b,c,d){this.minimumResultsForSearch=c.get(\"minimumResultsForSearch\"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),a.call(this,b,c,d)}return b.prototype.showSearch=function(b,c){return a(c.data.results)<this.minimumResultsForSearch?!1:b.call(this,c)},b}),b.define(\"select2/dropdown/selectOnClose\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on(\"close\",function(a){d._handleSelectOnClose(a)})},a.prototype._handleSelectOnClose=function(a,b){if(b&&null!=b.originalSelect2Event){var c=b.originalSelect2Event;if(\"select\"===c._type||\"unselect\"===c._type)return}var d=this.getHighlightedResults();if(!(d.length<1)){var e=d.data(\"data\");null!=e.element&&e.element.selected||null==e.element&&e.selected||this.trigger(\"select\",{data:e})}},a}),b.define(\"select2/dropdown/closeOnSelect\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on(\"select\",function(a){d._selectTriggered(a)}),b.on(\"unselect\",function(a){d._selectTriggered(a)})},a.prototype._selectTriggered=function(a,b){var c=b.originalEvent;c&&c.ctrlKey||this.trigger(\"close\",{originalEvent:c,originalSelect2Event:b})},a}),b.define(\"select2/i18n/en\",[],function(){return{errorLoading:function(){return\"The results could not be loaded.\"},inputTooLong:function(a){var b=a.input.length-a.maximum,c=\"Please delete \"+b+\" character\";return 1!=b&&(c+=\"s\"),c},inputTooShort:function(a){var b=a.minimum-a.input.length,c=\"Please enter \"+b+\" or more characters\";return c},loadingMore:function(){return\"Loading more results\"},maximumSelected:function(a){var b=\"You can only select \"+a.maximum+\" item\";return 1!=a.maximum&&(b+=\"s\"),b},noResults:function(){return\"No results found\"},searching:function(){return\"Searching\"}}}),b.define(\"select2/defaults\",[\"jquery\",\"require\",\"./results\",\"./selection/single\",\"./selection/multiple\",\"./selection/placeholder\",\"./selection/allowClear\",\"./selection/search\",\"./selection/eventRelay\",\"./utils\",\"./translation\",\"./diacritics\",\"./data/select\",\"./data/array\",\"./data/ajax\",\"./data/tags\",\"./data/tokenizer\",\"./data/minimumInputLength\",\"./data/maximumInputLength\",\"./data/maximumSelectionLength\",\"./dropdown\",\"./dropdown/search\",\"./dropdown/hidePlaceholder\",\"./dropdown/infiniteScroll\",\"./dropdown/attachBody\",\"./dropdown/minimumResultsForSearch\",\"./dropdown/selectOnClose\",\"./dropdown/closeOnSelect\",\"./i18n/en\"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){function D(){this.reset()}D.prototype.apply=function(l){if(l=a.extend(!0,{},this.defaults,l),null==l.dataAdapter){if(null!=l.ajax?l.dataAdapter=o:null!=l.data?l.dataAdapter=n:l.dataAdapter=m,l.minimumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,r)),l.maximumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,s)),l.maximumSelectionLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,t)),l.tags&&(l.dataAdapter=j.Decorate(l.dataAdapter,p)),(null!=l.tokenSeparators||null!=l.tokenizer)&&(l.dataAdapter=j.Decorate(l.dataAdapter,q)),null!=l.query){var C=b(l.amdBase+\"compat/query\");l.dataAdapter=j.Decorate(l.dataAdapter,C)}if(null!=l.initSelection){var D=b(l.amdBase+\"compat/initSelection\");l.dataAdapter=j.Decorate(l.dataAdapter,D)}}if(null==l.resultsAdapter&&(l.resultsAdapter=c,null!=l.ajax&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,x)),null!=l.placeholder&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,w)),l.selectOnClose&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,A))),null==l.dropdownAdapter){if(l.multiple)l.dropdownAdapter=u;else{var E=j.Decorate(u,v);l.dropdownAdapter=E}if(0!==l.minimumResultsForSearch&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,z)),l.closeOnSelect&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,B)),null!=l.dropdownCssClass||null!=l.dropdownCss||null!=l.adaptDropdownCssClass){var F=b(l.amdBase+\"compat/dropdownCss\");l.dropdownAdapter=j.Decorate(l.dropdownAdapter,F)}l.dropdownAdapter=j.Decorate(l.dropdownAdapter,y)}if(null==l.selectionAdapter){if(l.multiple?l.selectionAdapter=e:l.selectionAdapter=d,null!=l.placeholder&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,g)),l.multiple&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,h)),null!=l.containerCssClass||null!=l.containerCss||null!=l.adaptContainerCssClass){var G=b(l.amdBase+\"compat/containerCss\");l.selectionAdapter=j.Decorate(l.selectionAdapter,G)}l.selectionAdapter=j.Decorate(l.selectionAdapter,i)}if(\"string\"==typeof l.language)if(l.language.indexOf(\"-\")>0){var H=l.language.split(\"-\"),I=H[0];l.language=[l.language,I]}else l.language=[l.language];if(a.isArray(l.language)){var J=new k;l.language.push(\"en\");for(var K=l.language,L=0;L<K.length;L++){var M=K[L],N={};try{N=k.loadPath(M)}catch(O){try{M=this.defaults.amdLanguageBase+M,N=k.loadPath(M)}catch(P){l.debug&&window.console&&console.warn&&console.warn('Select2: The language file for \"'+M+'\" could not be automatically loaded. A fallback will be used instead.');continue}}J.extend(N)}l.translations=J}else{var Q=k.loadPath(this.defaults.amdLanguageBase+\"en\"),R=new k(l.language);R.extend(Q),l.translations=R}return l},D.prototype.reset=function(){function b(a){function b(a){return l[a]||a}return a.replace(/[^\\u0000-\\u007E]/g,b)}function c(d,e){if(\"\"===a.trim(d.term))return e;if(e.children&&e.children.length>0){for(var f=a.extend(!0,{},e),g=e.children.length-1;g>=0;g--){var h=e.children[g],i=c(d,h);null==i&&f.children.splice(g,1)}return f.children.length>0?f:c(d,f)}var j=b(e.text).toUpperCase(),k=b(d.term).toUpperCase();return j.indexOf(k)>-1?e:null}this.defaults={amdBase:\"./\",amdLanguageBase:\"./i18n/\",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:j.escapeMarkup,language:C,matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(a){return a},templateResult:function(a){return a.text},templateSelection:function(a){return a.text},theme:\"default\",width:\"resolve\"}},D.prototype.set=function(b,c){var d=a.camelCase(b),e={};e[d]=c;var f=j._convertData(e);a.extend(this.defaults,f)};var E=new D;return E}),b.define(\"select2/options\",[\"require\",\"jquery\",\"./defaults\",\"./utils\"],function(a,b,c,d){function e(b,e){if(this.options=b,null!=e&&this.fromElement(e),this.options=c.apply(this.options),e&&e.is(\"input\")){var f=a(this.get(\"amdBase\")+\"compat/inputData\");this.options.dataAdapter=d.Decorate(this.options.dataAdapter,f)}}return e.prototype.fromElement=function(a){var c=[\"select2\"];null==this.options.multiple&&(this.options.multiple=a.prop(\"multiple\")),null==this.options.disabled&&(this.options.disabled=a.prop(\"disabled\")),null==this.options.language&&(a.prop(\"lang\")?this.options.language=a.prop(\"lang\").toLowerCase():a.closest(\"[lang]\").prop(\"lang\")&&(this.options.language=a.closest(\"[lang]\").prop(\"lang\"))),null==this.options.dir&&(a.prop(\"dir\")?this.options.dir=a.prop(\"dir\"):a.closest(\"[dir]\").prop(\"dir\")?this.options.dir=a.closest(\"[dir]\").prop(\"dir\"):this.options.dir=\"ltr\"),a.prop(\"disabled\",this.options.disabled),a.prop(\"multiple\",this.options.multiple),a.data(\"select2Tags\")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags=\"true\"` attributes and will be removed in future versions of Select2.'),a.data(\"data\",a.data(\"select2Tags\")),a.data(\"tags\",!0)),a.data(\"ajaxUrl\")&&(this.options.debug&&window.console&&console.warn&&console.warn(\"Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2.\"),a.attr(\"ajax--url\",a.data(\"ajaxUrl\")),a.data(\"ajax--url\",a.data(\"ajaxUrl\")));var e={};e=b.fn.jquery&&\"1.\"==b.fn.jquery.substr(0,2)&&a[0].dataset?b.extend(!0,{},a[0].dataset,a.data()):a.data();var f=b.extend(!0,{},e);f=d._convertData(f);for(var g in f)b.inArray(g,c)>-1||(b.isPlainObject(this.options[g])?b.extend(this.options[g],f[g]):this.options[g]=f[g]);return this},e.prototype.get=function(a){return this.options[a]},e.prototype.set=function(a,b){this.options[a]=b},e}),b.define(\"select2/core\",[\"jquery\",\"./options\",\"./utils\",\"./keys\"],function(a,b,c,d){var e=function(a,c){null!=a.data(\"select2\")&&a.data(\"select2\").destroy(),this.$element=a,this.id=this._generateId(a),c=c||{},this.options=new b(c,a),e.__super__.constructor.call(this);var d=a.attr(\"tabindex\")||0;a.data(\"old-tabindex\",d),a.attr(\"tabindex\",\"-1\");var f=this.options.get(\"dataAdapter\");this.dataAdapter=new f(a,this.options);var g=this.render();this._placeContainer(g);var h=this.options.get(\"selectionAdapter\");this.selection=new h(a,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,g);var i=this.options.get(\"dropdownAdapter\");this.dropdown=new i(a,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,g);var j=this.options.get(\"resultsAdapter\");this.results=new j(a,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var k=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(a){k.trigger(\"selection:update\",{data:a})}),a.addClass(\"select2-hidden-accessible\"),a.attr(\"aria-hidden\",\"true\"),this._syncAttributes(),a.data(\"select2\",this)};return c.Extend(e,c.Observable),e.prototype._generateId=function(a){var b=\"\";return b=null!=a.attr(\"id\")?a.attr(\"id\"):null!=a.attr(\"name\")?a.attr(\"name\")+\"-\"+c.generateChars(2):c.generateChars(4),b=b.replace(/(:|\\.|\\[|\\]|,)/g,\"\"),b=\"select2-\"+b},e.prototype._placeContainer=function(a){a.insertAfter(this.$element);var b=this._resolveWidth(this.$element,this.options.get(\"width\"));null!=b&&a.css(\"width\",b)},e.prototype._resolveWidth=function(a,b){var c=/^width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if(\"resolve\"==b){var d=this._resolveWidth(a,\"style\");return null!=d?d:this._resolveWidth(a,\"element\")}if(\"element\"==b){var e=a.outerWidth(!1);return 0>=e?\"auto\":e+\"px\"}if(\"style\"==b){var f=a.attr(\"style\");if(\"string\"!=typeof f)return null;for(var g=f.split(\";\"),h=0,i=g.length;i>h;h+=1){var j=g[h].replace(/\\s/g,\"\"),k=j.match(c);if(null!==k&&k.length>=1)return k[1]}return null}return b},e.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},e.prototype._registerDomEvents=function(){var b=this;this.$element.on(\"change.select2\",function(){b.dataAdapter.current(function(a){b.trigger(\"selection:update\",{data:a})})}),this.$element.on(\"focus.select2\",function(a){b.trigger(\"focus\",a)}),this._syncA=c.bind(this._syncAttributes,this),this._syncS=c.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent(\"onpropertychange\",this._syncA);var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=d?(this._observer=new d(function(c){a.each(c,b._syncA),a.each(c,b._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener(\"DOMAttrModified\",b._syncA,!1),this.$element[0].addEventListener(\"DOMNodeInserted\",b._syncS,!1),this.$element[0].addEventListener(\"DOMNodeRemoved\",b._syncS,!1))},e.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerSelectionEvents=function(){var b=this,c=[\"toggle\",\"focus\"];this.selection.on(\"toggle\",function(){b.toggleDropdown()}),this.selection.on(\"focus\",function(a){b.focus(a)}),this.selection.on(\"*\",function(d,e){-1===a.inArray(d,c)&&b.trigger(d,e)})},e.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerResultsEvents=function(){var a=this;this.results.on(\"*\",function(b,c){a.trigger(b,c)})},e.prototype._registerEvents=function(){var a=this;this.on(\"open\",function(){a.$container.addClass(\"select2-container--open\")}),this.on(\"close\",function(){a.$container.removeClass(\"select2-container--open\")}),this.on(\"enable\",function(){a.$container.removeClass(\"select2-container--disabled\")}),this.on(\"disable\",function(){a.$container.addClass(\"select2-container--disabled\")}),this.on(\"blur\",function(){a.$container.removeClass(\"select2-container--focus\")}),this.on(\"query\",function(b){a.isOpen()||a.trigger(\"open\",{}),this.dataAdapter.query(b,function(c){a.trigger(\"results:all\",{data:c,query:b})})}),this.on(\"query:append\",function(b){this.dataAdapter.query(b,function(c){a.trigger(\"results:append\",{data:c,query:b})})}),this.on(\"keypress\",function(b){var c=b.which;a.isOpen()?c===d.ESC||c===d.TAB||c===d.UP&&b.altKey?(a.close(),b.preventDefault()):c===d.ENTER?(a.trigger(\"results:select\",{}),b.preventDefault()):c===d.SPACE&&b.ctrlKey?(a.trigger(\"results:toggle\",{}),b.preventDefault()):c===d.UP?(a.trigger(\"results:previous\",{}),b.preventDefault()):c===d.DOWN&&(a.trigger(\"results:next\",{}),b.preventDefault()):(c===d.ENTER||c===d.SPACE||c===d.DOWN&&b.altKey)&&(a.open(),b.preventDefault())})},e.prototype._syncAttributes=function(){this.options.set(\"disabled\",this.$element.prop(\"disabled\")),this.options.get(\"disabled\")?(this.isOpen()&&this.close(),this.trigger(\"disable\",{})):this.trigger(\"enable\",{})},e.prototype._syncSubtree=function(a,b){var c=!1,d=this;if(!a||!a.target||\"OPTION\"===a.target.nodeName||\"OPTGROUP\"===a.target.nodeName){if(b)if(b.addedNodes&&b.addedNodes.length>0)for(var e=0;e<b.addedNodes.length;e++){var f=b.addedNodes[e];f.selected&&(c=!0)}else b.removedNodes&&b.removedNodes.length>0&&(c=!0);else c=!0;c&&this.dataAdapter.current(function(a){d.trigger(\"selection:update\",{data:a})})}},e.prototype.trigger=function(a,b){var c=e.__super__.trigger,d={open:\"opening\",close:\"closing\",select:\"selecting\",unselect:\"unselecting\"};if(void 0===b&&(b={}),a in d){var f=d[a],g={prevented:!1,name:a,args:b};if(c.call(this,f,g),g.prevented)return void(b.prevented=!0)}c.call(this,a,b)},e.prototype.toggleDropdown=function(){this.options.get(\"disabled\")||(this.isOpen()?this.close():this.open())},e.prototype.open=function(){this.isOpen()||this.trigger(\"query\",{})},e.prototype.close=function(){this.isOpen()&&this.trigger(\"close\",{})},e.prototype.isOpen=function(){return this.$container.hasClass(\"select2-container--open\")},e.prototype.hasFocus=function(){return this.$container.hasClass(\"select2-container--focus\")},e.prototype.focus=function(a){this.hasFocus()||(this.$container.addClass(\"select2-container--focus\"),this.trigger(\"focus\",{}))},e.prototype.enable=function(a){this.options.get(\"debug\")&&window.console&&console.warn&&console.warn('Select2: The `select2(\"enable\")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop(\"disabled\") instead.'),(null==a||0===a.length)&&(a=[!0]);var b=!a[0];this.$element.prop(\"disabled\",b)},e.prototype.data=function(){this.options.get(\"debug\")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2(\"data\")`. You should consider setting the value instead using `$element.val()`.');var a=[];return this.dataAdapter.current(function(b){a=b}),a},e.prototype.val=function(b){if(this.options.get(\"debug\")&&window.console&&console.warn&&console.warn('Select2: The `select2(\"val\")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==b||0===b.length)return this.$element.val();var c=b[0];a.isArray(c)&&(c=a.map(c,function(a){return a.toString()})),this.$element.val(c).trigger(\"change\")},e.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent(\"onpropertychange\",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener(\"DOMAttrModified\",this._syncA,!1),this.$element[0].removeEventListener(\"DOMNodeInserted\",this._syncS,!1),this.$element[0].removeEventListener(\"DOMNodeRemoved\",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(\".select2\"),this.$element.attr(\"tabindex\",this.$element.data(\"old-tabindex\")),this.$element.removeClass(\"select2-hidden-accessible\"),this.$element.attr(\"aria-hidden\",\"false\"),this.$element.removeData(\"select2\"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null;\n},e.prototype.render=function(){var b=a('<span class=\"select2 select2-container\"><span class=\"selection\"></span><span class=\"dropdown-wrapper\" aria-hidden=\"true\"></span></span>');return b.attr(\"dir\",this.options.get(\"dir\")),this.$container=b,this.$container.addClass(\"select2-container--\"+this.options.get(\"theme\")),b.data(\"element\",this.$element),b},e}),b.define(\"select2/compat/utils\",[\"jquery\"],function(a){function b(b,c,d){var e,f,g=[];e=a.trim(b.attr(\"class\")),e&&(e=\"\"+e,a(e.split(/\\s+/)).each(function(){0===this.indexOf(\"select2-\")&&g.push(this)})),e=a.trim(c.attr(\"class\")),e&&(e=\"\"+e,a(e.split(/\\s+/)).each(function(){0!==this.indexOf(\"select2-\")&&(f=d(this),null!=f&&g.push(f))})),b.attr(\"class\",g.join(\" \"))}return{syncCssClasses:b}}),b.define(\"select2/compat/containerCss\",[\"jquery\",\"./utils\"],function(a,b){function c(a){return null}function d(){}return d.prototype.render=function(d){var e=d.call(this),f=this.options.get(\"containerCssClass\")||\"\";a.isFunction(f)&&(f=f(this.$element));var g=this.options.get(\"adaptContainerCssClass\");if(g=g||c,-1!==f.indexOf(\":all:\")){f=f.replace(\":all:\",\"\");var h=g;g=function(a){var b=h(a);return null!=b?b+\" \"+a:a}}var i=this.options.get(\"containerCss\")||{};return a.isFunction(i)&&(i=i(this.$element)),b.syncCssClasses(e,this.$element,g),e.css(i),e.addClass(f),e},d}),b.define(\"select2/compat/dropdownCss\",[\"jquery\",\"./utils\"],function(a,b){function c(a){return null}function d(){}return d.prototype.render=function(d){var e=d.call(this),f=this.options.get(\"dropdownCssClass\")||\"\";a.isFunction(f)&&(f=f(this.$element));var g=this.options.get(\"adaptDropdownCssClass\");if(g=g||c,-1!==f.indexOf(\":all:\")){f=f.replace(\":all:\",\"\");var h=g;g=function(a){var b=h(a);return null!=b?b+\" \"+a:a}}var i=this.options.get(\"dropdownCss\")||{};return a.isFunction(i)&&(i=i(this.$element)),b.syncCssClasses(e,this.$element,g),e.css(i),e.addClass(f),e},d}),b.define(\"select2/compat/initSelection\",[\"jquery\"],function(a){function b(a,b,c){c.get(\"debug\")&&window.console&&console.warn&&console.warn(\"Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2\"),this.initSelection=c.get(\"initSelection\"),this._isInitialized=!1,a.call(this,b,c)}return b.prototype.current=function(b,c){var d=this;return this._isInitialized?void b.call(this,c):void this.initSelection.call(null,this.$element,function(b){d._isInitialized=!0,a.isArray(b)||(b=[b]),c(b)})},b}),b.define(\"select2/compat/inputData\",[\"jquery\"],function(a){function b(a,b,c){this._currentData=[],this._valueSeparator=c.get(\"valueSeparator\")||\",\",\"hidden\"===b.prop(\"type\")&&c.get(\"debug\")&&console&&console.warn&&console.warn(\"Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead.\"),a.call(this,b,c)}return b.prototype.current=function(b,c){function d(b,c){var e=[];return b.selected||-1!==a.inArray(b.id,c)?(b.selected=!0,e.push(b)):b.selected=!1,b.children&&e.push.apply(e,d(b.children,c)),e}for(var e=[],f=0;f<this._currentData.length;f++){var g=this._currentData[f];e.push.apply(e,d(g,this.$element.val().split(this._valueSeparator)))}c(e)},b.prototype.select=function(b,c){if(this.options.get(\"multiple\")){var d=this.$element.val();d+=this._valueSeparator+c.id,this.$element.val(d),this.$element.trigger(\"change\")}else this.current(function(b){a.map(b,function(a){a.selected=!1})}),this.$element.val(c.id),this.$element.trigger(\"change\")},b.prototype.unselect=function(a,b){var c=this;b.selected=!1,this.current(function(a){for(var d=[],e=0;e<a.length;e++){var f=a[e];b.id!=f.id&&d.push(f.id)}c.$element.val(d.join(c._valueSeparator)),c.$element.trigger(\"change\")})},b.prototype.query=function(a,b,c){for(var d=[],e=0;e<this._currentData.length;e++){var f=this._currentData[e],g=this.matches(b,f);null!==g&&d.push(g)}c({results:d})},b.prototype.addOptions=function(b,c){var d=a.map(c,function(b){return a.data(b[0],\"data\")});this._currentData.push.apply(this._currentData,d)},b}),b.define(\"select2/compat/matcher\",[\"jquery\"],function(a){function b(b){function c(c,d){var e=a.extend(!0,{},d);if(null==c.term||\"\"===a.trim(c.term))return e;if(d.children){for(var f=d.children.length-1;f>=0;f--){var g=d.children[f],h=b(c.term,g.text,g);h||e.children.splice(f,1)}if(e.children.length>0)return e}return b(c.term,d.text,d)?e:null}return c}return b}),b.define(\"select2/compat/query\",[],function(){function a(a,b,c){c.get(\"debug\")&&window.console&&console.warn&&console.warn(\"Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2.\"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){b.callback=c;var d=this.options.get(\"query\");d.call(null,b)},a}),b.define(\"select2/dropdown/attachContainer\",[],function(){function a(a,b,c){a.call(this,b,c)}return a.prototype.position=function(a,b,c){var d=c.find(\".dropdown-wrapper\");d.append(b),b.addClass(\"select2-dropdown--below\"),c.addClass(\"select2-container--below\")},a}),b.define(\"select2/dropdown/stopPropagation\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){a.call(this,b,c);var d=[\"blur\",\"change\",\"click\",\"dblclick\",\"focus\",\"focusin\",\"focusout\",\"input\",\"keydown\",\"keyup\",\"keypress\",\"mousedown\",\"mouseenter\",\"mouseleave\",\"mousemove\",\"mouseover\",\"mouseup\",\"search\",\"touchend\",\"touchstart\"];this.$dropdown.on(d.join(\" \"),function(a){a.stopPropagation()})},a}),b.define(\"select2/selection/stopPropagation\",[],function(){function a(){}return a.prototype.bind=function(a,b,c){a.call(this,b,c);var d=[\"blur\",\"change\",\"click\",\"dblclick\",\"focus\",\"focusin\",\"focusout\",\"input\",\"keydown\",\"keyup\",\"keypress\",\"mousedown\",\"mouseenter\",\"mouseleave\",\"mousemove\",\"mouseover\",\"mouseup\",\"search\",\"touchend\",\"touchstart\"];this.$selection.on(d.join(\" \"),function(a){a.stopPropagation()})},a}),function(c){\"function\"==typeof b.define&&b.define.amd?b.define(\"jquery-mousewheel\",[\"jquery\"],c):\"object\"==typeof exports?module.exports=c:c(a)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type=\"mousewheel\",\"detail\"in g&&(m=-1*g.detail),\"wheelDelta\"in g&&(m=g.wheelDelta),\"wheelDeltaY\"in g&&(m=g.wheelDeltaY),\"wheelDeltaX\"in g&&(l=-1*g.wheelDeltaX),\"axis\"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,\"deltaY\"in g&&(m=-1*g.deltaY,j=m),\"deltaX\"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,\"mousewheel-line-height\");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,\"mousewheel-page-height\");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?\"floor\":\"ceil\"](j/f),l=Math[l>=1?\"floor\":\"ceil\"](l/f),m=Math[m>=1?\"floor\":\"ceil\"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&\"mousewheel\"===a.type&&b%120===0}var e,f,g=[\"wheel\",\"mousewheel\",\"DOMMouseScroll\",\"MozMousePixelScroll\"],h=\"onwheel\"in document||document.documentMode>=9?[\"wheel\"]:[\"mousewheel\",\"DomMouseScroll\",\"MozMousePixelScroll\"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:\"3.1.12\",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,\"mousewheel-line-height\",k.getLineHeight(this)),a.data(this,\"mousewheel-page-height\",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,\"mousewheel-line-height\"),a.removeData(this,\"mousewheel-page-height\")},getLineHeight:function(b){var c=a(b),d=c[\"offsetParent\"in a.fn?\"offsetParent\":\"parent\"]();return d.length||(d=a(\"body\")),parseInt(d.css(\"fontSize\"),10)||parseInt(c.css(\"fontSize\"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind(\"mousewheel\",a):this.trigger(\"mousewheel\")},unmousewheel:function(a){return this.unbind(\"mousewheel\",a)}})}),b.define(\"jquery.select2\",[\"jquery\",\"jquery-mousewheel\",\"./select2/core\",\"./select2/defaults\"],function(a,b,c,d){if(null==a.fn.select2){var e=[\"open\",\"close\",\"destroy\"];a.fn.select2=function(b){if(b=b||{},\"object\"==typeof b)return this.each(function(){var d=a.extend(!0,{},b);new c(a(this),d)}),this;if(\"string\"==typeof b){var d,f=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=a(this).data(\"select2\");null==c&&window.console&&console.error&&console.error(\"The select2('\"+b+\"') method was called on an element that is not using Select2.\"),d=c[b].apply(c,f)}),a.inArray(b,e)>-1?this:d}throw new Error(\"Invalid arguments for Select2: \"+b)}}return null==a.fn.select2.defaults&&(a.fn.select2.defaults=d),c}),{define:b.define,require:b.require}}(),c=b.require(\"jquery.select2\");return a.fn.select2.amd=b,c});","!function(e,t,n){\"use strict\";!function o(e,t,n){function a(s,l){if(!t[s]){if(!e[s]){var i=\"function\"==typeof require&&require;if(!l&&i)return i(s,!0);if(r)return r(s,!0);var u=new Error(\"Cannot find module '\"+s+\"'\");throw u.code=\"MODULE_NOT_FOUND\",u}var c=t[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return a(n?n:t)},c,c.exports,o,e,t,n)}return t[s].exports}for(var r=\"function\"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(o){var a,r,s,l,i=function(e){return e&&e.__esModule?e:{\"default\":e}},u=o(\"./modules/handle-dom\"),c=o(\"./modules/utils\"),d=o(\"./modules/handle-swal-dom\"),f=o(\"./modules/handle-click\"),p=o(\"./modules/handle-key\"),m=i(p),v=o(\"./modules/default-params\"),y=i(v),h=o(\"./modules/set-params\"),g=i(h);s=l=function(){function o(e){var t=s;return t[e]===n?y[\"default\"][e]:t[e]}var s=arguments[0];if(u.addClass(t.body,\"stop-scrolling\"),d.resetInput(),s===n)return c.logStr(\"SweetAlert expects at least 1 attribute!\"),!1;var l=c.extend({},y[\"default\"]);switch(typeof s){case\"string\":l.title=s,l.text=arguments[1]||\"\",l.type=arguments[2]||\"\";break;case\"object\":if(s.title===n)return c.logStr('Missing \"title\" argument!'),!1;l.title=s.title;for(var i in y[\"default\"])l[i]=o(i);l.confirmButtonText=l.showCancelButton?\"Confirm\":y[\"default\"].confirmButtonText,l.confirmButtonText=o(\"confirmButtonText\"),l.doneFunction=arguments[1]||null;break;default:return c.logStr('Unexpected type of argument! Expected \"string\" or \"object\", got '+typeof s),!1}g[\"default\"](l),d.fixVerticalPosition(),d.openModal(arguments[1]);for(var p=d.getModal(),v=p.querySelectorAll(\"button\"),h=[\"onclick\",\"onmouseover\",\"onmouseout\",\"onmousedown\",\"onmouseup\",\"onfocus\"],b=function(e){return f.handleButton(e,l,p)},w=0;w<v.length;w++)for(var C=0;C<h.length;C++){var S=h[C];v[w][S]=b}d.getOverlay().onclick=b,a=e.onkeydown;var x=function(e){return m[\"default\"](e,l,p)};e.onkeydown=x,e.onfocus=function(){setTimeout(function(){r!==n&&(r.focus(),r=n)},0)}},s.setDefaults=l.setDefaults=function(e){if(!e)throw new Error(\"userParams is required\");if(\"object\"!=typeof e)throw new Error(\"userParams has to be a object\");c.extend(y[\"default\"],e)},s.close=l.close=function(){var o=d.getModal();u.fadeOut(d.getOverlay(),5),u.fadeOut(o,5),u.removeClass(o,\"showSweetAlert\"),u.addClass(o,\"hideSweetAlert\"),u.removeClass(o,\"visible\");var s=o.querySelector(\".sa-icon.sa-success\");u.removeClass(s,\"animate\"),u.removeClass(s.querySelector(\".sa-tip\"),\"animateSuccessTip\"),u.removeClass(s.querySelector(\".sa-long\"),\"animateSuccessLong\");var l=o.querySelector(\".sa-icon.sa-error\");u.removeClass(l,\"animateErrorIcon\"),u.removeClass(l.querySelector(\".sa-x-mark\"),\"animateXMark\");var i=o.querySelector(\".sa-icon.sa-warning\");return u.removeClass(i,\"pulseWarning\"),u.removeClass(i.querySelector(\".sa-body\"),\"pulseWarningIns\"),u.removeClass(i.querySelector(\".sa-dot\"),\"pulseWarningIns\"),setTimeout(function(){var e=o.getAttribute(\"data-custom-class\");u.removeClass(o,e)},300),u.removeClass(t.body,\"stop-scrolling\"),e.onkeydown=a,e.previousActiveElement&&e.previousActiveElement.focus(),r=n,clearTimeout(o.timeout),!0},s.showInputError=l.showInputError=function(e){var t=d.getModal(),n=t.querySelector(\".sa-input-error\");u.addClass(n,\"show\");var o=t.querySelector(\".sa-error-container\");u.addClass(o,\"show\"),o.querySelector(\"p\").innerHTML=e,t.querySelector(\"input\").focus()},s.resetInputError=l.resetInputError=function(e){if(e&&13===e.keyCode)return!1;var t=d.getModal(),n=t.querySelector(\".sa-input-error\");u.removeClass(n,\"show\");var o=t.querySelector(\".sa-error-container\");u.removeClass(o,\"show\")},\"undefined\"!=typeof e?e.sweetAlert=e.swal=s:c.logStr(\"SweetAlert is a frontend module!\")},{\"./modules/default-params\":2,\"./modules/handle-click\":3,\"./modules/handle-dom\":4,\"./modules/handle-key\":5,\"./modules/handle-swal-dom\":6,\"./modules/set-params\":8,\"./modules/utils\":9}],2:[function(e,t,n){Object.defineProperty(n,\"__esModule\",{value:!0});var o={title:\"\",text:\"\",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:\"OK\",confirmButtonColor:\"#AEDEF4\",cancelButtonText:\"Cancel\",imageUrl:null,imageSize:null,timer:null,customClass:\"\",html:!1,animation:!0,allowEscapeKey:!0,inputType:\"text\",inputPlaceholder:\"\",inputValue:\"\"};n[\"default\"]=o,t.exports=n[\"default\"]},{}],3:[function(t,n,o){Object.defineProperty(o,\"__esModule\",{value:!0});var a=t(\"./utils\"),r=(t(\"./handle-swal-dom\"),t(\"./handle-dom\")),s=function(t,n,o){function s(e){m&&n.confirmButtonColor&&(p.style.backgroundColor=e)}var u,c,d,f=t||e.event,p=f.target||f.srcElement,m=-1!==p.className.indexOf(\"confirm\"),v=-1!==p.className.indexOf(\"sweet-overlay\"),y=r.hasClass(o,\"visible\"),h=n.doneFunction&&\"true\"===o.getAttribute(\"data-has-done-function\");switch(m&&n.confirmButtonColor&&(u=n.confirmButtonColor,c=a.colorLuminance(u,-.04),d=a.colorLuminance(u,-.14)),f.type){case\"mouseover\":s(c);break;case\"mouseout\":s(u);break;case\"mousedown\":s(d);break;case\"mouseup\":s(c);break;case\"focus\":var g=o.querySelector(\"button.confirm\"),b=o.querySelector(\"button.cancel\");m?b.style.boxShadow=\"none\":g.style.boxShadow=\"none\";break;case\"click\":var w=o===p,C=r.isDescendant(o,p);if(!w&&!C&&y&&!n.allowOutsideClick)break;m&&h&&y?l(o,n):h&&y||v?i(o,n):r.isDescendant(o,p)&&\"BUTTON\"===p.tagName&&sweetAlert.close()}},l=function(e,t){var n=!0;r.hasClass(e,\"show-input\")&&(n=e.querySelector(\"input\").value,n||(n=\"\")),t.doneFunction(n),t.closeOnConfirm&&sweetAlert.close()},i=function(e,t){var n=String(t.doneFunction).replace(/\\s/g,\"\"),o=\"function(\"===n.substring(0,9)&&\")\"!==n.substring(9,10);o&&t.doneFunction(!1),t.closeOnCancel&&sweetAlert.close()};o[\"default\"]={handleButton:s,handleConfirm:l,handleCancel:i},n.exports=o[\"default\"]},{\"./handle-dom\":4,\"./handle-swal-dom\":6,\"./utils\":9}],4:[function(n,o,a){Object.defineProperty(a,\"__esModule\",{value:!0});var r=function(e,t){return new RegExp(\" \"+t+\" \").test(\" \"+e.className+\" \")},s=function(e,t){r(e,t)||(e.className+=\" \"+t)},l=function(e,t){var n=\" \"+e.className.replace(/[\\t\\r\\n]/g,\" \")+\" \";if(r(e,t)){for(;n.indexOf(\" \"+t+\" \")>=0;)n=n.replace(\" \"+t+\" \",\" \");e.className=n.replace(/^\\s+|\\s+$/g,\"\")}},i=function(e){var n=t.createElement(\"div\");return n.appendChild(t.createTextNode(e)),n.innerHTML},u=function(e){e.style.opacity=\"\",e.style.display=\"block\"},c=function(e){if(e&&!e.length)return u(e);for(var t=0;t<e.length;++t)u(e[t])},d=function(e){e.style.opacity=\"\",e.style.display=\"none\"},f=function(e){if(e&&!e.length)return d(e);for(var t=0;t<e.length;++t)d(e[t])},p=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},m=function(e){e.style.left=\"-9999px\",e.style.display=\"block\";var t,n=e.clientHeight;return t=\"undefined\"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue(\"padding-top\"),10):parseInt(e.currentStyle.padding),e.style.left=\"\",e.style.display=\"none\",\"-\"+parseInt((n+t)/2)+\"px\"},v=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display=\"block\";var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(o,t)});o()}e.style.display=\"block\"},y=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,o=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(o,t):e.style.display=\"none\"});o()},h=function(n){if(\"function\"==typeof MouseEvent){var o=new MouseEvent(\"click\",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(o)}else if(t.createEvent){var a=t.createEvent(\"MouseEvents\");a.initEvent(\"click\",!1,!1),n.dispatchEvent(a)}else t.createEventObject?n.fireEvent(\"onclick\"):\"function\"==typeof n.onclick&&n.onclick()},g=function(t){\"function\"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty(\"cancelBubble\")&&(e.event.cancelBubble=!0)};a.hasClass=r,a.addClass=s,a.removeClass=l,a.escapeHtml=i,a._show=u,a.show=c,a._hide=d,a.hide=f,a.isDescendant=p,a.getTopMargin=m,a.fadeIn=v,a.fadeOut=y,a.fireClick=h,a.stopEventPropagation=g},{}],5:[function(t,o,a){Object.defineProperty(a,\"__esModule\",{value:!0});var r=t(\"./handle-dom\"),s=t(\"./handle-swal-dom\"),l=function(t,o,a){var l=t||e.event,i=l.keyCode||l.which,u=a.querySelector(\"button.confirm\"),c=a.querySelector(\"button.cancel\"),d=a.querySelectorAll(\"button[tabindex]\");if(-1!==[9,13,32,27].indexOf(i)){for(var f=l.target||l.srcElement,p=-1,m=0;m<d.length;m++)if(f===d[m]){p=m;break}9===i?(f=-1===p?u:p===d.length-1?d[0]:d[p+1],r.stopEventPropagation(l),f.focus(),o.confirmButtonColor&&s.setFocusStyle(f,o.confirmButtonColor)):13===i?(\"INPUT\"===f.tagName&&(f=u,u.focus()),f=-1===p?u:n):27===i&&o.allowEscapeKey===!0?(f=c,r.fireClick(f,l)):f=n}};a[\"default\"]=l,o.exports=a[\"default\"]},{\"./handle-dom\":4,\"./handle-swal-dom\":6}],6:[function(n,o,a){var r=function(e){return e&&e.__esModule?e:{\"default\":e}};Object.defineProperty(a,\"__esModule\",{value:!0});var s=n(\"./utils\"),l=n(\"./handle-dom\"),i=n(\"./default-params\"),u=r(i),c=n(\"./injected-html\"),d=r(c),f=\".sweet-alert\",p=\".sweet-overlay\",m=function(){var e=t.createElement(\"div\");for(e.innerHTML=d[\"default\"];e.firstChild;)t.body.appendChild(e.firstChild)},v=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=t.querySelector(f);return e||(m(),e=v()),e}),y=function(){var e=v();return e?e.querySelector(\"input\"):void 0},h=function(){return t.querySelector(p)},g=function(e,t){var n=s.hexToRgb(t);e.style.boxShadow=\"0 0 2px rgba(\"+n+\", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)\"},b=function(n){var o=v();l.fadeIn(h(),10),l.show(o),l.addClass(o,\"showSweetAlert\"),l.removeClass(o,\"hideSweetAlert\"),e.previousActiveElement=t.activeElement;var a=o.querySelector(\"button.confirm\");a.focus(),setTimeout(function(){l.addClass(o,\"visible\")},500);var r=o.getAttribute(\"data-timer\");if(\"null\"!==r&&\"\"!==r){var s=n;o.timeout=setTimeout(function(){var e=(s||null)&&\"true\"===o.getAttribute(\"data-has-done-function\");e?s(null):sweetAlert.close()},r)}},w=function(){var e=v(),t=y();l.removeClass(e,\"show-input\"),t.value=u[\"default\"].inputValue,t.setAttribute(\"type\",u[\"default\"].inputType),t.setAttribute(\"placeholder\",u[\"default\"].inputPlaceholder),C()},C=function(e){if(e&&13===e.keyCode)return!1;var t=v(),n=t.querySelector(\".sa-input-error\");l.removeClass(n,\"show\");var o=t.querySelector(\".sa-error-container\");l.removeClass(o,\"show\")},S=function(){var e=v();e.style.marginTop=l.getTopMargin(v())};a.sweetAlertInitialize=m,a.getModal=v,a.getOverlay=h,a.getInput=y,a.setFocusStyle=g,a.openModal=b,a.resetInput=w,a.resetInputError=C,a.fixVerticalPosition=S},{\"./default-params\":2,\"./handle-dom\":4,\"./injected-html\":7,\"./utils\":9}],7:[function(e,t,n){Object.defineProperty(n,\"__esModule\",{value:!0});var o='<div class=\"sweet-overlay\" tabIndex=\"-1\"></div><div class=\"sweet-alert\"><div class=\"sa-icon sa-error\">\\n      <span class=\"sa-x-mark\">\\n        <span class=\"sa-line sa-left\"></span>\\n        <span class=\"sa-line sa-right\"></span>\\n      </span>\\n    </div><div class=\"sa-icon sa-warning\">\\n      <span class=\"sa-body\"></span>\\n      <span class=\"sa-dot\"></span>\\n    </div><div class=\"sa-icon sa-info\"></div><div class=\"sa-icon sa-success\">\\n      <span class=\"sa-line sa-tip\"></span>\\n      <span class=\"sa-line sa-long\"></span>\\n\\n      <div class=\"sa-placeholder\"></div>\\n      <div class=\"sa-fix\"></div>\\n    </div><div class=\"sa-icon sa-custom\"></div><h2>Title</h2>\\n    <p>Text</p>\\n    <fieldset>\\n      <input type=\"text\" tabIndex=\"3\" />\\n      <div class=\"sa-input-error\"></div>\\n    </fieldset><div class=\"sa-error-container\">\\n      <div class=\"icon\">!</div>\\n      <p>Not valid!</p>\\n    </div><div class=\"sa-button-container\">\\n      <button class=\"cancel\" tabIndex=\"2\">Cancel</button>\\n      <button class=\"confirm\" tabIndex=\"1\">OK</button>\\n    </div></div>';n[\"default\"]=o,t.exports=n[\"default\"]},{}],8:[function(e,t,o){Object.defineProperty(o,\"__esModule\",{value:!0});var a=e(\"./utils\"),r=e(\"./handle-swal-dom\"),s=e(\"./handle-dom\"),l=[\"error\",\"warning\",\"info\",\"success\",\"input\",\"prompt\"],i=function(e){var t=r.getModal(),o=t.querySelector(\"h2\"),i=t.querySelector(\"p\"),u=t.querySelector(\"button.cancel\"),c=t.querySelector(\"button.confirm\");if(o.innerHTML=e.html?e.title:s.escapeHtml(e.title).split(\"\\n\").join(\"<br>\"),i.innerHTML=e.html?e.text:s.escapeHtml(e.text||\"\").split(\"\\n\").join(\"<br>\"),e.text&&s.show(i),e.customClass)s.addClass(t,e.customClass),t.setAttribute(\"data-custom-class\",e.customClass);else{var d=t.getAttribute(\"data-custom-class\");s.removeClass(t,d),t.setAttribute(\"data-custom-class\",\"\")}if(s.hide(t.querySelectorAll(\".sa-icon\")),e.type&&!a.isIE8()){var f=function(){for(var o=!1,a=0;a<l.length;a++)if(e.type===l[a]){o=!0;break}if(!o)return logStr(\"Unknown alert type: \"+e.type),{v:!1};var i=[\"success\",\"error\",\"warning\",\"info\"],u=n;-1!==i.indexOf(e.type)&&(u=t.querySelector(\".sa-icon.sa-\"+e.type),s.show(u));var c=r.getInput();switch(e.type){case\"success\":s.addClass(u,\"animate\"),s.addClass(u.querySelector(\".sa-tip\"),\"animateSuccessTip\"),s.addClass(u.querySelector(\".sa-long\"),\"animateSuccessLong\");break;case\"error\":s.addClass(u,\"animateErrorIcon\"),s.addClass(u.querySelector(\".sa-x-mark\"),\"animateXMark\");break;case\"warning\":s.addClass(u,\"pulseWarning\"),s.addClass(u.querySelector(\".sa-body\"),\"pulseWarningIns\"),s.addClass(u.querySelector(\".sa-dot\"),\"pulseWarningIns\");break;case\"input\":case\"prompt\":c.setAttribute(\"type\",e.inputType),c.value=e.inputValue,c.setAttribute(\"placeholder\",e.inputPlaceholder),s.addClass(t,\"show-input\"),setTimeout(function(){c.focus(),c.addEventListener(\"keyup\",swal.resetInputError)},400)}}();if(\"object\"==typeof f)return f.v}if(e.imageUrl){var p=t.querySelector(\".sa-icon.sa-custom\");p.style.backgroundImage=\"url(\"+e.imageUrl+\")\",s.show(p);var m=80,v=80;if(e.imageSize){var y=e.imageSize.toString().split(\"x\"),h=y[0],g=y[1];h&&g?(m=h,v=g):logStr(\"Parameter imageSize expects value with format WIDTHxHEIGHT, got \"+e.imageSize)}p.setAttribute(\"style\",p.getAttribute(\"style\")+\"width:\"+m+\"px; height:\"+v+\"px\")}t.setAttribute(\"data-has-cancel-button\",e.showCancelButton),e.showCancelButton?u.style.display=\"inline-block\":s.hide(u),t.setAttribute(\"data-has-confirm-button\",e.showConfirmButton),e.showConfirmButton?c.style.display=\"inline-block\":s.hide(c),e.cancelButtonText&&(u.innerHTML=s.escapeHtml(e.cancelButtonText)),e.confirmButtonText&&(c.innerHTML=s.escapeHtml(e.confirmButtonText)),e.confirmButtonColor&&(c.style.backgroundColor=e.confirmButtonColor,r.setFocusStyle(c,e.confirmButtonColor)),t.setAttribute(\"data-allow-outside-click\",e.allowOutsideClick);var b=e.doneFunction?!0:!1;t.setAttribute(\"data-has-done-function\",b),e.animation?\"string\"==typeof e.animation?t.setAttribute(\"data-animation\",e.animation):t.setAttribute(\"data-animation\",\"pop\"):t.setAttribute(\"data-animation\",\"none\"),t.setAttribute(\"data-timer\",e.timer)};o[\"default\"]=i,t.exports=o[\"default\"]},{\"./handle-dom\":4,\"./handle-swal-dom\":6,\"./utils\":9}],9:[function(t,n,o){Object.defineProperty(o,\"__esModule\",{value:!0});var a=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r=function(e){var t=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+\", \"+parseInt(t[2],16)+\", \"+parseInt(t[3],16):null},s=function(){return e.attachEvent&&!e.addEventListener},l=function(t){e.console&&e.console.log(\"SweetAlert: \"+t)},i=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,\"\"),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,a=\"#\";for(o=0;3>o;o++)n=parseInt(e.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),a+=(\"00\"+n).substr(n.length);return a};o.extend=a,o.hexToRgb=r,o.isIE8=s,o.logStr=l,o.colorLuminance=i},{}]},{},[1]),\"function\"==typeof define&&define.amd?define(function(){return sweetAlert}):\"undefined\"!=typeof module&&module.exports&&(module.exports=sweetAlert)}(window,document);","!function(e){e([\"jquery\"],function(e){return function(){function t(e,t,n){return f({type:O.error,iconClass:g().iconClasses.error,message:e,optionsOverride:n,title:t})}function n(t,n){return t||(t=g()),v=e(\"#\"+t.containerId),v.length?v:(n&&(v=c(t)),v)}function i(e,t,n){return f({type:O.info,iconClass:g().iconClasses.info,message:e,optionsOverride:n,title:t})}function o(e){w=e}function s(e,t,n){return f({type:O.success,iconClass:g().iconClasses.success,message:e,optionsOverride:n,title:t})}function a(e,t,n){return f({type:O.warning,iconClass:g().iconClasses.warning,message:e,optionsOverride:n,title:t})}function r(e){var t=g();v||n(t),l(e,t)||u(t)}function d(t){var i=g();return v||n(i),t&&0===e(\":focus\",t).length?void h(t):void(v.children().length&&v.remove())}function u(t){for(var n=v.children(),i=n.length-1;i>=0;i--)l(e(n[i]),t)}function l(t,n){return t&&0===e(\":focus\",t).length?(t[n.hideMethod]({duration:n.hideDuration,easing:n.hideEasing,complete:function(){h(t)}}),!0):!1}function c(t){return v=e(\"<div/>\").attr(\"id\",t.containerId).addClass(t.positionClass).attr(\"aria-live\",\"polite\").attr(\"role\",\"alert\"),v.appendTo(e(t.target)),v}function p(){return{tapToDismiss:!0,toastClass:\"toast\",containerId:\"toast-container\",debug:!1,showMethod:\"fadeIn\",showDuration:300,showEasing:\"swing\",onShown:void 0,hideMethod:\"fadeOut\",hideDuration:1e3,hideEasing:\"swing\",onHidden:void 0,extendedTimeOut:1e3,iconClasses:{error:\"toast-error\",info:\"toast-info\",success:\"toast-success\",warning:\"toast-warning\"},iconClass:\"toast-info\",positionClass:\"toast-top-right\",timeOut:5e3,titleClass:\"toast-title\",messageClass:\"toast-message\",target:\"body\",closeHtml:'<button type=\"button\">&times;</button>',newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function m(e){w&&w(e)}function f(t){function i(t){return!e(\":focus\",l).length||t?(clearTimeout(O.intervalId),l[r.hideMethod]({duration:r.hideDuration,easing:r.hideEasing,complete:function(){h(l),r.onHidden&&\"hidden\"!==b.state&&r.onHidden(),b.state=\"hidden\",b.endTime=new Date,m(b)}})):void 0}function o(){(r.timeOut>0||r.extendedTimeOut>0)&&(u=setTimeout(i,r.extendedTimeOut),O.maxHideTime=parseFloat(r.extendedTimeOut),O.hideEta=(new Date).getTime()+O.maxHideTime)}function s(){clearTimeout(u),O.hideEta=0,l.stop(!0,!0)[r.showMethod]({duration:r.showDuration,easing:r.showEasing})}function a(){var e=(O.hideEta-(new Date).getTime())/O.maxHideTime*100;f.width(e+\"%\")}var r=g(),d=t.iconClass||r.iconClass;if(\"undefined\"!=typeof t.optionsOverride&&(r=e.extend(r,t.optionsOverride),d=t.optionsOverride.iconClass||d),r.preventDuplicates){if(t.message===C)return;C=t.message}T++,v=n(r,!0);var u=null,l=e(\"<div/>\"),c=e(\"<div/>\"),p=e(\"<div/>\"),f=e(\"<div/>\"),w=e(r.closeHtml),O={intervalId:null,hideEta:null,maxHideTime:null},b={toastId:T,state:\"visible\",startTime:new Date,options:r,map:t};return t.iconClass&&l.addClass(r.toastClass).addClass(d),t.title&&(c.append(t.title).addClass(r.titleClass),l.append(c)),t.message&&(p.append(t.message).addClass(r.messageClass),l.append(p)),r.closeButton&&(w.addClass(\"toast-close-button\").attr(\"role\",\"button\"),l.prepend(w)),r.progressBar&&(f.addClass(\"toast-progress\"),l.prepend(f)),l.hide(),r.newestOnTop?v.prepend(l):v.append(l),l[r.showMethod]({duration:r.showDuration,easing:r.showEasing,complete:r.onShown}),r.timeOut>0&&(u=setTimeout(i,r.timeOut),O.maxHideTime=parseFloat(r.timeOut),O.hideEta=(new Date).getTime()+O.maxHideTime,r.progressBar&&(O.intervalId=setInterval(a,10))),l.hover(s,o),!r.onclick&&r.tapToDismiss&&l.click(i),r.closeButton&&w&&w.click(function(e){e.stopPropagation?e.stopPropagation():void 0!==e.cancelBubble&&e.cancelBubble!==!0&&(e.cancelBubble=!0),i(!0)}),r.onclick&&l.click(function(){r.onclick(),i()}),m(b),r.debug&&console&&console.log(b),l}function g(){return e.extend({},p(),b.options)}function h(e){v||(v=n()),e.is(\":visible\")||(e.remove(),e=null,0===v.children().length&&(v.remove(),C=void 0))}var v,w,C,T=0,O={error:\"error\",info:\"info\",success:\"success\",warning:\"warning\"},b={clear:r,remove:d,error:t,getContainer:n,info:i,options:{},subscribe:o,success:s,version:\"2.1.0\",warning:a};return b}()})}(\"function\"==typeof define&&define.amd?define:function(e,t){\"undefined\"!=typeof module&&module.exports?module.exports=t(require(\"jquery\")):window.toastr=t(window.jQuery)});\n//# sourceMappingURL=/toastr.js.map","(function(){function require(path,parent,orig){var resolved=require.resolve(path);if(null==resolved){orig=orig||path;parent=parent||\"root\";var err=new Error('Failed to require \"'+orig+'\" from \"'+parent+'\"');err.path=orig;err.parent=parent;err.require=true;throw err}var module=require.modules[resolved];if(!module._resolving&&!module.exports){var mod={};mod.exports={};mod.client=mod.component=true;module._resolving=true;module.call(this,mod.exports,require.relative(resolved),mod);delete module._resolving;module.exports=mod.exports}return module.exports}require.modules={};require.aliases={};require.resolve=function(path){if(path.charAt(0)===\"/\")path=path.slice(1);var paths=[path,path+\".js\",path+\".json\",path+\"/index.js\",path+\"/index.json\"];for(var i=0;i<paths.length;i++){var path=paths[i];if(require.modules.hasOwnProperty(path))return path;if(require.aliases.hasOwnProperty(path))return require.aliases[path]}};require.normalize=function(curr,path){var segs=[];if(\".\"!=path.charAt(0))return path;curr=curr.split(\"/\");path=path.split(\"/\");for(var i=0;i<path.length;++i){if(\"..\"==path[i]){curr.pop()}else if(\".\"!=path[i]&&\"\"!=path[i]){segs.push(path[i])}}return curr.concat(segs).join(\"/\")};require.register=function(path,definition){require.modules[path]=definition};require.alias=function(from,to){if(!require.modules.hasOwnProperty(from)){throw new Error('Failed to alias \"'+from+'\", it does not exist')}require.aliases[to]=from};require.relative=function(parent){var p=require.normalize(parent,\"..\");function lastIndexOf(arr,obj){var i=arr.length;while(i--){if(arr[i]===obj)return i}return-1}function localRequire(path){var resolved=localRequire.resolve(path);return require(resolved,parent,path)}localRequire.resolve=function(path){var c=path.charAt(0);if(\"/\"==c)return path.slice(1);if(\".\"==c)return require.normalize(p,path);var segs=parent.split(\"/\");var i=lastIndexOf(segs,\"deps\")+1;if(!i)i=0;path=segs.slice(0,i+1).join(\"/\")+\"/deps/\"+path;return path};localRequire.exists=function(path){return require.modules.hasOwnProperty(localRequire.resolve(path))};return localRequire};require.register(\"abpetkov-transitionize/transitionize.js\",function(exports,require,module){module.exports=Transitionize;function Transitionize(element,props){if(!(this instanceof Transitionize))return new Transitionize(element,props);this.element=element;this.props=props||{};this.init()}Transitionize.prototype.isSafari=function(){return/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)};Transitionize.prototype.init=function(){var transitions=[];for(var key in this.props){transitions.push(key+\" \"+this.props[key])}this.element.style.transition=transitions.join(\", \");if(this.isSafari())this.element.style.webkitTransition=transitions.join(\", \")}});require.register(\"ftlabs-fastclick/lib/fastclick.js\",function(exports,require,module){function FastClick(layer){\"use strict\";var oldOnClick,self=this;this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=10;this.layer=layer;if(!layer||!layer.nodeType){throw new TypeError(\"Layer must be a document node\")}this.onClick=function(){return FastClick.prototype.onClick.apply(self,arguments)};this.onMouse=function(){return FastClick.prototype.onMouse.apply(self,arguments)};this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(self,arguments)};this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(self,arguments)};this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(self,arguments)};this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(self,arguments)};if(FastClick.notNeeded(layer)){return}if(this.deviceIsAndroid){layer.addEventListener(\"mouseover\",this.onMouse,true);layer.addEventListener(\"mousedown\",this.onMouse,true);layer.addEventListener(\"mouseup\",this.onMouse,true)}layer.addEventListener(\"click\",this.onClick,true);layer.addEventListener(\"touchstart\",this.onTouchStart,false);layer.addEventListener(\"touchmove\",this.onTouchMove,false);layer.addEventListener(\"touchend\",this.onTouchEnd,false);layer.addEventListener(\"touchcancel\",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;if(type===\"click\"){rmv.call(layer,type,callback.hijacked||callback,capture)}else{rmv.call(layer,type,callback,capture)}};layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;if(type===\"click\"){adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){if(!event.propagationStopped){callback(event)}}),capture)}else{adv.call(layer,type,callback,capture)}}}if(typeof layer.onclick===\"function\"){oldOnClick=layer.onclick;layer.addEventListener(\"click\",function(event){oldOnClick(event)},false);layer.onclick=null}}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf(\"Android\")>0;FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\\d(_\\d)?/.test(navigator.userAgent);FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\\d{2})_\\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(target){\"use strict\";switch(target.nodeName.toLowerCase()){case\"button\":case\"select\":case\"textarea\":if(target.disabled){return true}break;case\"input\":if(this.deviceIsIOS&&target.type===\"file\"||target.disabled){return true}break;case\"label\":case\"video\":return true}return/\\bneedsclick\\b/.test(target.className)};FastClick.prototype.needsFocus=function(target){\"use strict\";switch(target.nodeName.toLowerCase()){case\"textarea\":return true;case\"select\":return!this.deviceIsAndroid;case\"input\":switch(target.type){case\"button\":case\"checkbox\":case\"file\":case\"image\":case\"radio\":case\"submit\":return false}return!target.disabled&&!target.readOnly;default:return/\\bneedsfocus\\b/.test(target.className)}};FastClick.prototype.sendClick=function(targetElement,event){\"use strict\";var clickEvent,touch;if(document.activeElement&&document.activeElement!==targetElement){document.activeElement.blur()}touch=event.changedTouches[0];clickEvent=document.createEvent(\"MouseEvents\");clickEvent.initMouseEvent(this.determineEventType(targetElement),true,true,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,false,false,false,false,0,null);clickEvent.forwardedTouchEvent=true;targetElement.dispatchEvent(clickEvent)};FastClick.prototype.determineEventType=function(targetElement){\"use strict\";if(this.deviceIsAndroid&&targetElement.tagName.toLowerCase()===\"select\"){return\"mousedown\"}return\"click\"};FastClick.prototype.focus=function(targetElement){\"use strict\";var length;if(this.deviceIsIOS&&targetElement.setSelectionRange&&targetElement.type.indexOf(\"date\")!==0&&targetElement.type!==\"time\"){length=targetElement.value.length;targetElement.setSelectionRange(length,length)}else{targetElement.focus()}};FastClick.prototype.updateScrollParent=function(targetElement){\"use strict\";var scrollParent,parentElement;scrollParent=targetElement.fastClickScrollParent;if(!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement;targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}if(scrollParent){scrollParent.fastClickLastScrollTop=scrollParent.scrollTop}};FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){\"use strict\";if(eventTarget.nodeType===Node.TEXT_NODE){return eventTarget.parentNode}return eventTarget};FastClick.prototype.onTouchStart=function(event){\"use strict\";var targetElement,touch,selection;if(event.targetTouches.length>1){return true}targetElement=this.getTargetElementFromEventTarget(event.target);touch=event.targetTouches[0];if(this.deviceIsIOS){selection=window.getSelection();if(selection.rangeCount&&!selection.isCollapsed){return true}if(!this.deviceIsIOS4){if(touch.identifier===this.lastTouchIdentifier){event.preventDefault();return false}this.lastTouchIdentifier=touch.identifier;this.updateScrollParent(targetElement)}}this.trackingClick=true;this.trackingClickStart=event.timeStamp;this.targetElement=targetElement;this.touchStartX=touch.pageX;this.touchStartY=touch.pageY;if(event.timeStamp-this.lastClickTime<200){event.preventDefault()}return true};FastClick.prototype.touchHasMoved=function(event){\"use strict\";var touch=event.changedTouches[0],boundary=this.touchBoundary;if(Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary){return true}return false};FastClick.prototype.onTouchMove=function(event){\"use strict\";if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event)){this.trackingClick=false;this.targetElement=null}return true};FastClick.prototype.findControl=function(labelElement){\"use strict\";if(labelElement.control!==undefined){return labelElement.control}if(labelElement.htmlFor){return document.getElementById(labelElement.htmlFor)}return labelElement.querySelector(\"button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea\")};FastClick.prototype.onTouchEnd=function(event){\"use strict\";var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick){return true}if(event.timeStamp-this.lastClickTime<200){this.cancelNextClick=true;return true}this.cancelNextClick=false;this.lastClickTime=event.timeStamp;trackingClickStart=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(this.deviceIsIOSWithBadTarget){touch=event.changedTouches[0];targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement;targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent}targetTagName=targetElement.tagName.toLowerCase();if(targetTagName===\"label\"){forElement=this.findControl(targetElement);if(forElement){this.focus(targetElement);if(this.deviceIsAndroid){return false}targetElement=forElement}}else if(this.needsFocus(targetElement)){if(event.timeStamp-trackingClickStart>100||this.deviceIsIOS&&window.top!==window&&targetTagName===\"input\"){this.targetElement=null;return false}this.focus(targetElement);if(!this.deviceIsIOS4||targetTagName!==\"select\"){this.targetElement=null;event.preventDefault()}return false}if(this.deviceIsIOS&&!this.deviceIsIOS4){scrollParent=targetElement.fastClickScrollParent;if(scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop){return true}}if(!this.needsClick(targetElement)){event.preventDefault();this.sendClick(targetElement,event)}return false};FastClick.prototype.onTouchCancel=function(){\"use strict\";this.trackingClick=false;this.targetElement=null};FastClick.prototype.onMouse=function(event){\"use strict\";if(!this.targetElement){return true}if(event.forwardedTouchEvent){return true}if(!event.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(event.stopImmediatePropagation){event.stopImmediatePropagation()}else{event.propagationStopped=true}event.stopPropagation();event.preventDefault();return false}return true};FastClick.prototype.onClick=function(event){\"use strict\";var permitted;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(event.target.type===\"submit\"&&event.detail===0){return true}permitted=this.onMouse(event);if(!permitted){this.targetElement=null}return permitted};FastClick.prototype.destroy=function(){\"use strict\";var layer=this.layer;if(this.deviceIsAndroid){layer.removeEventListener(\"mouseover\",this.onMouse,true);layer.removeEventListener(\"mousedown\",this.onMouse,true);layer.removeEventListener(\"mouseup\",this.onMouse,true)}layer.removeEventListener(\"click\",this.onClick,true);layer.removeEventListener(\"touchstart\",this.onTouchStart,false);layer.removeEventListener(\"touchmove\",this.onTouchMove,false);layer.removeEventListener(\"touchend\",this.onTouchEnd,false);layer.removeEventListener(\"touchcancel\",this.onTouchCancel,false)};FastClick.notNeeded=function(layer){\"use strict\";var metaViewport;var chromeVersion;if(typeof window.ontouchstart===\"undefined\"){return true}chromeVersion=+(/Chrome\\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(chromeVersion){if(FastClick.prototype.deviceIsAndroid){metaViewport=document.querySelector(\"meta[name=viewport]\");if(metaViewport){if(metaViewport.content.indexOf(\"user-scalable=no\")!==-1){return true}if(chromeVersion>31&&window.innerWidth<=window.screen.width){return true}}}else{return true}}if(layer.style.msTouchAction===\"none\"){return true}return false};FastClick.attach=function(layer){\"use strict\";return new FastClick(layer)};if(typeof define!==\"undefined\"&&define.amd){define(function(){\"use strict\";return FastClick})}else if(typeof module!==\"undefined\"&&module.exports){module.exports=FastClick.attach;module.exports.FastClick=FastClick}else{window.FastClick=FastClick}});require.register(\"switchery/switchery.js\",function(exports,require,module){var transitionize=require(\"transitionize\"),fastclick=require(\"fastclick\");module.exports=Switchery;var defaults={color:\"#64bd63\",secondaryColor:\"#dfdfdf\",className:\"switchery\",disabled:false,disabledOpacity:.5,speed:\"0.4s\"};function Switchery(element,options){if(!(this instanceof Switchery))return new Switchery(element,options);this.element=element;this.options=options||{};for(var i in defaults){if(this.options[i]==null){this.options[i]=defaults[i]}}if(this.element!=null&&this.element.type==\"checkbox\")this.init()}Switchery.prototype.hide=function(){this.element.style.display=\"none\"};Switchery.prototype.show=function(){var switcher=this.create();this.insertAfter(this.element,switcher)};Switchery.prototype.create=function(){this.switcher=document.createElement(\"span\");this.jack=document.createElement(\"small\");this.switcher.appendChild(this.jack);this.switcher.className=this.options.className;return this.switcher};Switchery.prototype.insertAfter=function(reference,target){reference.parentNode.insertBefore(target,reference.nextSibling)};Switchery.prototype.isChecked=function(){return this.element.checked};Switchery.prototype.isDisabled=function(){return this.options.disabled||this.element.disabled};Switchery.prototype.setPosition=function(clicked){var checked=this.isChecked(),switcher=this.switcher,jack=this.jack;if(clicked&&checked)checked=false;else if(clicked&&!checked)checked=true;if(checked===true){this.element.checked=true;if(window.getComputedStyle)jack.style.left=parseInt(window.getComputedStyle(switcher).width)-parseInt(window.getComputedStyle(jack).width)+\"px\";else jack.style.left=parseInt(switcher.currentStyle[\"width\"])-parseInt(jack.currentStyle[\"width\"])+\"px\";if(this.options.color)this.colorize();this.setSpeed()}else{jack.style.left=0;this.element.checked=false;this.switcher.style.boxShadow=\"inset 0 0 0 0 \"+this.options.secondaryColor;this.switcher.style.borderColor=this.options.secondaryColor;this.switcher.style.backgroundColor=\"\";this.setSpeed()}};Switchery.prototype.setSpeed=function(){var switcherProp={},jackProp={left:this.options.speed.replace(/[a-z]/,\"\")/2+\"s\"};if(this.isChecked()){switcherProp={border:this.options.speed,\"box-shadow\":this.options.speed,\"background-color\":this.options.speed.replace(/[a-z]/,\"\")*3+\"s\"}}else{switcherProp={border:this.options.speed,\"box-shadow\":this.options.speed}}transitionize(this.switcher,switcherProp);transitionize(this.jack,jackProp)};Switchery.prototype.setAttributes=function(){var id=this.element.getAttribute(\"id\"),name=this.element.getAttribute(\"name\");if(id)this.switcher.setAttribute(\"id\",id);if(name)this.switcher.setAttribute(\"name\",name)};Switchery.prototype.colorize=function(){this.switcher.style.backgroundColor=this.options.color;this.switcher.style.borderColor=this.options.color;this.switcher.style.boxShadow=\"inset 0 0 0 16px \"+this.options.color};Switchery.prototype.handleOnchange=function(state){if(typeof Event===\"function\"||!document.fireEvent){var event=document.createEvent(\"HTMLEvents\");event.initEvent(\"change\",true,true);this.element.dispatchEvent(event)}else{this.element.fireEvent(\"onchange\")}};Switchery.prototype.handleChange=function(){var self=this,el=this.element;if(el.addEventListener){el.addEventListener(\"change\",function(){self.setPosition()})}else{el.attachEvent(\"onchange\",function(){self.setPosition()})}};Switchery.prototype.handleClick=function(){var self=this,switcher=this.switcher;if(this.isDisabled()===false){fastclick(switcher);if(switcher.addEventListener){switcher.addEventListener(\"click\",function(){self.setPosition(true);self.handleOnchange(self.element.checked)})}else{switcher.attachEvent(\"onclick\",function(){self.setPosition(true);self.handleOnchange(self.element.checked)})}}else{this.element.disabled=true;this.switcher.style.opacity=this.options.disabledOpacity}};Switchery.prototype.disableLabel=function(){var parent=this.element.parentNode,labels=document.getElementsByTagName(\"label\"),attached=null;for(var i=0;i<labels.length;i++){if(labels[i].getAttribute(\"for\")===this.element.id){attached=true}}if(attached===true||parent.tagName.toLowerCase()===\"label\"){if(parent.addEventListener){parent.addEventListener(\"click\",function(e){e.preventDefault()})}else{parent.attachEvent(\"onclick\",function(e){e.returnValue=false})}}};Switchery.prototype.markAsSwitched=function(){this.element.setAttribute(\"data-switchery\",true)};Switchery.prototype.markedAsSwitched=function(){return this.element.getAttribute(\"data-switchery\")};Switchery.prototype.init=function(){this.hide();this.show();this.setPosition();this.setAttributes();this.markAsSwitched();this.disableLabel();this.handleChange();this.handleClick()}});require.alias(\"abpetkov-transitionize/transitionize.js\",\"switchery/deps/transitionize/transitionize.js\");require.alias(\"abpetkov-transitionize/transitionize.js\",\"switchery/deps/transitionize/index.js\");require.alias(\"abpetkov-transitionize/transitionize.js\",\"transitionize/index.js\");require.alias(\"abpetkov-transitionize/transitionize.js\",\"abpetkov-transitionize/index.js\");require.alias(\"ftlabs-fastclick/lib/fastclick.js\",\"switchery/deps/fastclick/lib/fastclick.js\");require.alias(\"ftlabs-fastclick/lib/fastclick.js\",\"switchery/deps/fastclick/index.js\");require.alias(\"ftlabs-fastclick/lib/fastclick.js\",\"fastclick/index.js\");require.alias(\"ftlabs-fastclick/lib/fastclick.js\",\"ftlabs-fastclick/index.js\");require.alias(\"switchery/switchery.js\",\"switchery/index.js\");if(typeof exports==\"object\"){module.exports=require(\"switchery\")}else if(typeof define==\"function\"&&define.amd){define(function(){return require(\"switchery\")})}else{this[\"Switchery\"]=require(\"switchery\")}})();","/* =========================================================\n * bootstrap-datepicker.js\n * Repo: https://github.com/eternicode/bootstrap-datepicker/\n * Demo: http://eternicode.github.io/bootstrap-datepicker/\n * Docs: http://bootstrap-datepicker.readthedocs.org/\n * Forked from http://www.eyecon.ro/bootstrap-datepicker\n * =========================================================\n * Started by Stefan Petre; improvements by Andrew Rowls + contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * ========================================================= */\n\n(function($, undefined){\n\n\tvar $window = $(window);\n\n\tfunction UTCDate(){\n\t\treturn new Date(Date.UTC.apply(Date, arguments));\n\t}\n\tfunction UTCToday(){\n\t\tvar today = new Date();\n\t\treturn UTCDate(today.getFullYear(), today.getMonth(), today.getDate());\n\t}\n\tfunction alias(method){\n\t\treturn function(){\n\t\t\treturn this[method].apply(this, arguments);\n\t\t};\n\t}\n\n\tvar DateArray = (function(){\n\t\tvar extras = {\n\t\t\tget: function(i){\n\t\t\t\treturn this.slice(i)[0];\n\t\t\t},\n\t\t\tcontains: function(d){\n\t\t\t\t// Array.indexOf is not cross-browser;\n\t\t\t\t// $.inArray doesn't work with Dates\n\t\t\t\tvar val = d && d.valueOf();\n\t\t\t\tfor (var i=0, l=this.length; i < l; i++)\n\t\t\t\t\tif (this[i].valueOf() === val)\n\t\t\t\t\t\treturn i;\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\tremove: function(i){\n\t\t\t\tthis.splice(i,1);\n\t\t\t},\n\t\t\treplace: function(new_array){\n\t\t\t\tif (!new_array)\n\t\t\t\t\treturn;\n\t\t\t\tif (!$.isArray(new_array))\n\t\t\t\t\tnew_array = [new_array];\n\t\t\t\tthis.clear();\n\t\t\t\tthis.push.apply(this, new_array);\n\t\t\t},\n\t\t\tclear: function(){\n\t\t\t\tthis.splice(0);\n\t\t\t},\n\t\t\tcopy: function(){\n\t\t\t\tvar a = new DateArray();\n\t\t\t\ta.replace(this);\n\t\t\t\treturn a;\n\t\t\t}\n\t\t};\n\n\t\treturn function(){\n\t\t\tvar a = [];\n\t\t\ta.push.apply(a, arguments);\n\t\t\t$.extend(a, extras);\n\t\t\treturn a;\n\t\t};\n\t})();\n\n\n\t// Picker object\n\n\tvar Datepicker = function(element, options){\n\t\tthis.dates = new DateArray();\n\t\tthis.viewDate = UTCToday();\n\t\tthis.focusDate = null;\n\n\t\tthis._process_options(options);\n\n\t\tthis.element = $(element);\n\t\tthis.isInline = false;\n\t\tthis.isInput = this.element.is('input');\n\t\tthis.component = this.element.is('.date') ? this.element.find('.add-on, .input-group-addon, .btn') : false;\n\t\tthis.hasInput = this.component && this.element.find('input').length;\n\t\tif (this.component && this.component.length === 0)\n\t\t\tthis.component = false;\n\n\t\tthis.picker = $(DPGlobal.template);\n\t\tthis._buildEvents();\n\t\tthis._attachEvents();\n\n\t\tif (this.isInline){\n\t\t\tthis.picker.addClass('datepicker-inline').appendTo(this.element);\n\t\t}\n\t\telse {\n\t\t\tthis.picker.addClass('datepicker-dropdown dropdown-menu');\n\t\t}\n\n\t\tif (this.o.rtl){\n\t\t\tthis.picker.addClass('datepicker-rtl');\n\t\t}\n\n\t\tthis.viewMode = this.o.startView;\n\n\t\tif (this.o.calendarWeeks)\n\t\t\tthis.picker.find('tfoot th.today')\n\t\t\t\t\t\t.attr('colspan', function(i, val){\n\t\t\t\t\t\t\treturn parseInt(val) + 1;\n\t\t\t\t\t\t});\n\n\t\tthis._allow_update = false;\n\n\t\tthis.setStartDate(this._o.startDate);\n\t\tthis.setEndDate(this._o.endDate);\n\t\tthis.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);\n\n\t\tthis.fillDow();\n\t\tthis.fillMonths();\n\n\t\tthis._allow_update = true;\n\n\t\tthis.update();\n\t\tthis.showMode();\n\n\t\tif (this.isInline){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tDatepicker.prototype = {\n\t\tconstructor: Datepicker,\n\n\t\t_process_options: function(opts){\n\t\t\t// Store raw options for reference\n\t\t\tthis._o = $.extend({}, this._o, opts);\n\t\t\t// Processed options\n\t\t\tvar o = this.o = $.extend({}, this._o);\n\n\t\t\t// Check if \"de-DE\" style date is available, if not language should\n\t\t\t// fallback to 2 letter code eg \"de\"\n\t\t\tvar lang = o.language;\n\t\t\tif (!dates[lang]){\n\t\t\t\tlang = lang.split('-')[0];\n\t\t\t\tif (!dates[lang])\n\t\t\t\t\tlang = defaults.language;\n\t\t\t}\n\t\t\to.language = lang;\n\n\t\t\tswitch (o.startView){\n\t\t\t\tcase 2:\n\t\t\t\tcase 'decade':\n\t\t\t\t\to.startView = 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 'year':\n\t\t\t\t\to.startView = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\to.startView = 0;\n\t\t\t}\n\n\t\t\tswitch (o.minViewMode){\n\t\t\t\tcase 1:\n\t\t\t\tcase 'months':\n\t\t\t\t\to.minViewMode = 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\tcase 'years':\n\t\t\t\t\to.minViewMode = 2;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\to.minViewMode = 0;\n\t\t\t}\n\n\t\t\to.startView = Math.max(o.startView, o.minViewMode);\n\n\t\t\t// true, false, or Number > 0\n\t\t\tif (o.multidate !== true){\n\t\t\t\to.multidate = Number(o.multidate) || false;\n\t\t\t\tif (o.multidate !== false)\n\t\t\t\t\to.multidate = Math.max(0, o.multidate);\n\t\t\t\telse\n\t\t\t\t\to.multidate = 1;\n\t\t\t}\n\t\t\to.multidateSeparator = String(o.multidateSeparator);\n\n\t\t\to.weekStart %= 7;\n\t\t\to.weekEnd = ((o.weekStart + 6) % 7);\n\n\t\t\tvar format = DPGlobal.parseFormat(o.format);\n\t\t\tif (o.startDate !== -Infinity){\n\t\t\t\tif (!!o.startDate){\n\t\t\t\t\tif (o.startDate instanceof Date)\n\t\t\t\t\t\to.startDate = this._local_to_utc(this._zero_time(o.startDate));\n\t\t\t\t\telse\n\t\t\t\t\t\to.startDate = DPGlobal.parseDate(o.startDate, format, o.language);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\to.startDate = -Infinity;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (o.endDate !== Infinity){\n\t\t\t\tif (!!o.endDate){\n\t\t\t\t\tif (o.endDate instanceof Date)\n\t\t\t\t\t\to.endDate = this._local_to_utc(this._zero_time(o.endDate));\n\t\t\t\t\telse\n\t\t\t\t\t\to.endDate = DPGlobal.parseDate(o.endDate, format, o.language);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\to.endDate = Infinity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\to.daysOfWeekDisabled = o.daysOfWeekDisabled||[];\n\t\t\tif (!$.isArray(o.daysOfWeekDisabled))\n\t\t\t\to.daysOfWeekDisabled = o.daysOfWeekDisabled.split(/[,\\s]*/);\n\t\t\to.daysOfWeekDisabled = $.map(o.daysOfWeekDisabled, function(d){\n\t\t\t\treturn parseInt(d, 10);\n\t\t\t});\n\n\t\t\tvar plc = String(o.orientation).toLowerCase().split(/\\s+/g),\n\t\t\t\t_plc = o.orientation.toLowerCase();\n\t\t\tplc = $.grep(plc, function(word){\n\t\t\t\treturn (/^auto|left|right|top|bottom$/).test(word);\n\t\t\t});\n\t\t\to.orientation = {x: 'auto', y: 'auto'};\n\t\t\tif (!_plc || _plc === 'auto')\n\t\t\t\t; // no action\n\t\t\telse if (plc.length === 1){\n\t\t\t\tswitch (plc[0]){\n\t\t\t\t\tcase 'top':\n\t\t\t\t\tcase 'bottom':\n\t\t\t\t\t\to.orientation.y = plc[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\to.orientation.x = plc[0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_plc = $.grep(plc, function(word){\n\t\t\t\t\treturn (/^left|right$/).test(word);\n\t\t\t\t});\n\t\t\t\to.orientation.x = _plc[0] || 'auto';\n\n\t\t\t\t_plc = $.grep(plc, function(word){\n\t\t\t\t\treturn (/^top|bottom$/).test(word);\n\t\t\t\t});\n\t\t\t\to.orientation.y = _plc[0] || 'auto';\n\t\t\t}\n\t\t},\n\t\t_events: [],\n\t\t_secondaryEvents: [],\n\t\t_applyEvents: function(evs){\n\t\t\tfor (var i=0, el, ch, ev; i < evs.length; i++){\n\t\t\t\tel = evs[i][0];\n\t\t\t\tif (evs[i].length === 2){\n\t\t\t\t\tch = undefined;\n\t\t\t\t\tev = evs[i][1];\n\t\t\t\t}\n\t\t\t\telse if (evs[i].length === 3){\n\t\t\t\t\tch = evs[i][1];\n\t\t\t\t\tev = evs[i][2];\n\t\t\t\t}\n\t\t\t\tel.on(ev, ch);\n\t\t\t}\n\t\t},\n\t\t_unapplyEvents: function(evs){\n\t\t\tfor (var i=0, el, ev, ch; i < evs.length; i++){\n\t\t\t\tel = evs[i][0];\n\t\t\t\tif (evs[i].length === 2){\n\t\t\t\t\tch = undefined;\n\t\t\t\t\tev = evs[i][1];\n\t\t\t\t}\n\t\t\t\telse if (evs[i].length === 3){\n\t\t\t\t\tch = evs[i][1];\n\t\t\t\t\tev = evs[i][2];\n\t\t\t\t}\n\t\t\t\tel.off(ev, ch);\n\t\t\t}\n\t\t},\n\t\t_buildEvents: function(){\n\t\t\tif (this.isInput){ // single input\n\t\t\t\tthis._events = [\n\t\t\t\t\t[this.element, {\n\t\t\t\t\t\tfocus: $.proxy(this.show, this),\n\t\t\t\t\t\tkeyup: $.proxy(function(e){\n\t\t\t\t\t\t\tif ($.inArray(e.keyCode, [27,37,39,38,40,32,13,9]) === -1)\n\t\t\t\t\t\t\t\tthis.update();\n\t\t\t\t\t\t}, this),\n\t\t\t\t\t\tkeydown: $.proxy(this.keydown, this)\n\t\t\t\t\t}]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (this.component && this.hasInput){ // component: input + button\n\t\t\t\tthis._events = [\n\t\t\t\t\t// For components that are not readonly, allow keyboard nav\n\t\t\t\t\t[this.element.find('input'), {\n\t\t\t\t\t\tfocus: $.proxy(this.show, this),\n\t\t\t\t\t\tkeyup: $.proxy(function(e){\n\t\t\t\t\t\t\tif ($.inArray(e.keyCode, [27,37,39,38,40,32,13,9]) === -1)\n\t\t\t\t\t\t\t\tthis.update();\n\t\t\t\t\t\t}, this),\n\t\t\t\t\t\tkeydown: $.proxy(this.keydown, this)\n\t\t\t\t\t}],\n\t\t\t\t\t[this.component, {\n\t\t\t\t\t\tclick: $.proxy(this.show, this)\n\t\t\t\t\t}]\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (this.element.is('div')){  // inline datepicker\n\t\t\t\tthis.isInline = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._events = [\n\t\t\t\t\t[this.element, {\n\t\t\t\t\t\tclick: $.proxy(this.show, this)\n\t\t\t\t\t}]\n\t\t\t\t];\n\t\t\t}\n\t\t\tthis._events.push(\n\t\t\t\t// Component: listen for blur on element descendants\n\t\t\t\t[this.element, '*', {\n\t\t\t\t\tblur: $.proxy(function(e){\n\t\t\t\t\t\tthis._focused_from = e.target;\n\t\t\t\t\t}, this)\n\t\t\t\t}],\n\t\t\t\t// Input: listen for blur on element\n\t\t\t\t[this.element, {\n\t\t\t\t\tblur: $.proxy(function(e){\n\t\t\t\t\t\tthis._focused_from = e.target;\n\t\t\t\t\t}, this)\n\t\t\t\t}]\n\t\t\t);\n\n\t\t\tthis._secondaryEvents = [\n\t\t\t\t[this.picker, {\n\t\t\t\t\tclick: $.proxy(this.click, this)\n\t\t\t\t}],\n\t\t\t\t[$(window), {\n\t\t\t\t\tresize: $.proxy(this.place, this)\n\t\t\t\t}],\n\t\t\t\t[$(document), {\n\t\t\t\t\t'mousedown touchstart': $.proxy(function(e){\n\t\t\t\t\t\t// Clicked outside the datepicker, hide it\n\t\t\t\t\t\tif (!(\n\t\t\t\t\t\t\tthis.element.is(e.target) ||\n\t\t\t\t\t\t\tthis.element.find(e.target).length ||\n\t\t\t\t\t\t\tthis.picker.is(e.target) ||\n\t\t\t\t\t\t\tthis.picker.find(e.target).length\n\t\t\t\t\t\t)){\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this)\n\t\t\t\t}]\n\t\t\t];\n\t\t},\n\t\t_attachEvents: function(){\n\t\t\tthis._detachEvents();\n\t\t\tthis._applyEvents(this._events);\n\t\t},\n\t\t_detachEvents: function(){\n\t\t\tthis._unapplyEvents(this._events);\n\t\t},\n\t\t_attachSecondaryEvents: function(){\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis._applyEvents(this._secondaryEvents);\n\t\t},\n\t\t_detachSecondaryEvents: function(){\n\t\t\tthis._unapplyEvents(this._secondaryEvents);\n\t\t},\n\t\t_trigger: function(event, altdate){\n\t\t\tvar date = altdate || this.dates.get(-1),\n\t\t\t\tlocal_date = this._utc_to_local(date);\n\n\t\t\tthis.element.trigger({\n\t\t\t\ttype: event,\n\t\t\t\tdate: local_date,\n\t\t\t\tdates: $.map(this.dates, this._utc_to_local),\n\t\t\t\tformat: $.proxy(function(ix, format){\n\t\t\t\t\tif (arguments.length === 0){\n\t\t\t\t\t\tix = this.dates.length - 1;\n\t\t\t\t\t\tformat = this.o.format;\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof ix === 'string'){\n\t\t\t\t\t\tformat = ix;\n\t\t\t\t\t\tix = this.dates.length - 1;\n\t\t\t\t\t}\n\t\t\t\t\tformat = format || this.o.format;\n\t\t\t\t\tvar date = this.dates.get(ix);\n\t\t\t\t\treturn DPGlobal.formatDate(date, format, this.o.language);\n\t\t\t\t}, this)\n\t\t\t});\n\t\t},\n\n\t\tshow: function(){\n\t\t\tif (!this.isInline)\n\t\t\t\tthis.picker.appendTo('body');\n\t\t\tthis.picker.show();\n\t\t\tthis.place();\n\t\t\tthis._attachSecondaryEvents();\n\t\t\tthis._trigger('show');\n\t\t},\n\n\t\thide: function(){\n\t\t\tif (this.isInline)\n\t\t\t\treturn;\n\t\t\tif (!this.picker.is(':visible'))\n\t\t\t\treturn;\n\t\t\tthis.focusDate = null;\n\t\t\tthis.picker.hide().detach();\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis.viewMode = this.o.startView;\n\t\t\tthis.showMode();\n\n\t\t\tif (\n\t\t\t\tthis.o.forceParse &&\n\t\t\t\t(\n\t\t\t\t\tthis.isInput && this.element.val() ||\n\t\t\t\t\tthis.hasInput && this.element.find('input').val()\n\t\t\t\t)\n\t\t\t)\n\t\t\t\tthis.setValue();\n\t\t\tthis._trigger('hide');\n\t\t},\n\n\t\tremove: function(){\n\t\t\tthis.hide();\n\t\t\tthis._detachEvents();\n\t\t\tthis._detachSecondaryEvents();\n\t\t\tthis.picker.remove();\n\t\t\tdelete this.element.data().datepicker;\n\t\t\tif (!this.isInput){\n\t\t\t\tdelete this.element.data().date;\n\t\t\t}\n\t\t},\n\n\t\t_utc_to_local: function(utc){\n\t\t\treturn utc && new Date(utc.getTime() + (utc.getTimezoneOffset()*60000));\n\t\t},\n\t\t_local_to_utc: function(local){\n\t\t\treturn local && new Date(local.getTime() - (local.getTimezoneOffset()*60000));\n\t\t},\n\t\t_zero_time: function(local){\n\t\t\treturn local && new Date(local.getFullYear(), local.getMonth(), local.getDate());\n\t\t},\n\t\t_zero_utc_time: function(utc){\n\t\t\treturn utc && new Date(Date.UTC(utc.getUTCFullYear(), utc.getUTCMonth(), utc.getUTCDate()));\n\t\t},\n\n\t\tgetDates: function(){\n\t\t\treturn $.map(this.dates, this._utc_to_local);\n\t\t},\n\n\t\tgetUTCDates: function(){\n\t\t\treturn $.map(this.dates, function(d){\n\t\t\t\treturn new Date(d);\n\t\t\t});\n\t\t},\n\n\t\tgetDate: function(){\n\t\t\treturn this._utc_to_local(this.getUTCDate());\n\t\t},\n\n\t\tgetUTCDate: function(){\n\t\t\treturn new Date(this.dates.get(-1));\n\t\t},\n\n\t\tsetDates: function(){\n\t\t\tvar args = $.isArray(arguments[0]) ? arguments[0] : arguments;\n\t\t\tthis.update.apply(this, args);\n\t\t\tthis._trigger('changeDate');\n\t\t\tthis.setValue();\n\t\t},\n\n\t\tsetUTCDates: function(){\n\t\t\tvar args = $.isArray(arguments[0]) ? arguments[0] : arguments;\n\t\t\tthis.update.apply(this, $.map(args, this._utc_to_local));\n\t\t\tthis._trigger('changeDate');\n\t\t\tthis.setValue();\n\t\t},\n\n\t\tsetDate: alias('setDates'),\n\t\tsetUTCDate: alias('setUTCDates'),\n\n\t\tsetValue: function(){\n\t\t\tvar formatted = this.getFormattedDate();\n\t\t\tif (!this.isInput){\n\t\t\t\tif (this.component){\n\t\t\t\t\tthis.element.find('input').val(formatted).change();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.element.val(formatted).change();\n\t\t\t}\n\t\t},\n\n\t\tgetFormattedDate: function(format){\n\t\t\tif (format === undefined)\n\t\t\t\tformat = this.o.format;\n\n\t\t\tvar lang = this.o.language;\n\t\t\treturn $.map(this.dates, function(d){\n\t\t\t\treturn DPGlobal.formatDate(d, format, lang);\n\t\t\t}).join(this.o.multidateSeparator);\n\t\t},\n\n\t\tsetStartDate: function(startDate){\n\t\t\tthis._process_options({startDate: startDate});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t},\n\n\t\tsetEndDate: function(endDate){\n\t\t\tthis._process_options({endDate: endDate});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t},\n\n\t\tsetDaysOfWeekDisabled: function(daysOfWeekDisabled){\n\t\t\tthis._process_options({daysOfWeekDisabled: daysOfWeekDisabled});\n\t\t\tthis.update();\n\t\t\tthis.updateNavArrows();\n\t\t},\n\n\t\tplace: function(){\n\t\t\tif (this.isInline)\n\t\t\t\treturn;\n\t\t\tvar calendarWidth = this.picker.outerWidth(),\n\t\t\t\tcalendarHeight = this.picker.outerHeight(),\n\t\t\t\tvisualPadding = 10,\n\t\t\t\twindowWidth = $window.width(),\n\t\t\t\twindowHeight = $window.height(),\n\t\t\t\tscrollTop = $window.scrollTop();\n\n\t\t\tvar zIndex = parseInt(this.element.parents().filter(function(){\n\t\t\t\t\treturn $(this).css('z-index') !== 'auto';\n\t\t\t\t}).first().css('z-index'))+10;\n\t\t\tvar offset = this.component ? this.component.parent().offset() : this.element.offset();\n\t\t\tvar height = this.component ? this.component.outerHeight(true) : this.element.outerHeight(false);\n\t\t\tvar width = this.component ? this.component.outerWidth(true) : this.element.outerWidth(false);\n\t\t\tvar left = offset.left,\n\t\t\t\ttop = offset.top;\n\n\t\t\tthis.picker.removeClass(\n\t\t\t\t'datepicker-orient-top datepicker-orient-bottom '+\n\t\t\t\t'datepicker-orient-right datepicker-orient-left'\n\t\t\t);\n\n\t\t\tif (this.o.orientation.x !== 'auto'){\n\t\t\t\tthis.picker.addClass('datepicker-orient-' + this.o.orientation.x);\n\t\t\t\tif (this.o.orientation.x === 'right')\n\t\t\t\t\tleft -= calendarWidth - width;\n\t\t\t}\n\t\t\t// auto x orientation is best-placement: if it crosses a window\n\t\t\t// edge, fudge it sideways\n\t\t\telse {\n\t\t\t\t// Default to left\n\t\t\t\tthis.picker.addClass('datepicker-orient-left');\n\t\t\t\tif (offset.left < 0)\n\t\t\t\t\tleft -= offset.left - visualPadding;\n\t\t\t\telse if (offset.left + calendarWidth > windowWidth)\n\t\t\t\t\tleft = windowWidth - calendarWidth - visualPadding;\n\t\t\t}\n\n\t\t\t// auto y orientation is best-situation: top or bottom, no fudging,\n\t\t\t// decision based on which shows more of the calendar\n\t\t\tvar yorient = this.o.orientation.y,\n\t\t\t\ttop_overflow, bottom_overflow;\n\t\t\tif (yorient === 'auto'){\n\t\t\t\ttop_overflow = -scrollTop + offset.top - calendarHeight;\n\t\t\t\tbottom_overflow = scrollTop + windowHeight - (offset.top + height + calendarHeight);\n\t\t\t\tif (Math.max(top_overflow, bottom_overflow) === bottom_overflow)\n\t\t\t\t\tyorient = 'top';\n\t\t\t\telse\n\t\t\t\t\tyorient = 'bottom';\n\t\t\t}\n\t\t\tthis.picker.addClass('datepicker-orient-' + yorient);\n\t\t\tif (yorient === 'top')\n\t\t\t\ttop += height;\n\t\t\telse\n\t\t\t\ttop -= calendarHeight + parseInt(this.picker.css('padding-top'));\n\n\t\t\tthis.picker.css({\n\t\t\t\ttop: top,\n\t\t\t\tleft: left,\n\t\t\t\tzIndex: zIndex\n\t\t\t});\n\t\t},\n\n\t\t_allow_update: true,\n\t\tupdate: function(){\n\t\t\tif (!this._allow_update)\n\t\t\t\treturn;\n\n\t\t\tvar oldDates = this.dates.copy(),\n\t\t\t\tdates = [],\n\t\t\t\tfromArgs = false;\n\t\t\tif (arguments.length){\n\t\t\t\t$.each(arguments, $.proxy(function(i, date){\n\t\t\t\t\tif (date instanceof Date)\n\t\t\t\t\t\tdate = this._local_to_utc(date);\n\t\t\t\t\tdates.push(date);\n\t\t\t\t}, this));\n\t\t\t\tfromArgs = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdates = this.isInput\n\t\t\t\t\t\t? this.element.val()\n\t\t\t\t\t\t: this.element.data('date') || this.element.find('input').val();\n\t\t\t\tif (dates && this.o.multidate)\n\t\t\t\t\tdates = dates.split(this.o.multidateSeparator);\n\t\t\t\telse\n\t\t\t\t\tdates = [dates];\n\t\t\t\tdelete this.element.data().date;\n\t\t\t}\n\n\t\t\tdates = $.map(dates, $.proxy(function(date){\n\t\t\t\treturn DPGlobal.parseDate(date, this.o.format, this.o.language);\n\t\t\t}, this));\n\t\t\tdates = $.grep(dates, $.proxy(function(date){\n\t\t\t\treturn (\n\t\t\t\t\tdate < this.o.startDate ||\n\t\t\t\t\tdate > this.o.endDate ||\n\t\t\t\t\t!date\n\t\t\t\t);\n\t\t\t}, this), true);\n\t\t\tthis.dates.replace(dates);\n\n\t\t\tif (this.dates.length)\n\t\t\t\tthis.viewDate = new Date(this.dates.get(-1));\n\t\t\telse if (this.viewDate < this.o.startDate)\n\t\t\t\tthis.viewDate = new Date(this.o.startDate);\n\t\t\telse if (this.viewDate > this.o.endDate)\n\t\t\t\tthis.viewDate = new Date(this.o.endDate);\n\n\t\t\tif (fromArgs){\n\t\t\t\t// setting date by clicking\n\t\t\t\tthis.setValue();\n\t\t\t}\n\t\t\telse if (dates.length){\n\t\t\t\t// setting date by typing\n\t\t\t\tif (String(oldDates) !== String(this.dates))\n\t\t\t\t\tthis._trigger('changeDate');\n\t\t\t}\n\t\t\tif (!this.dates.length && oldDates.length)\n\t\t\t\tthis._trigger('clearDate');\n\n\t\t\tthis.fill();\n\t\t},\n\n\t\tfillDow: function(){\n\t\t\tvar dowCnt = this.o.weekStart,\n\t\t\t\thtml = '<tr>';\n\t\t\tif (this.o.calendarWeeks){\n\t\t\t\tvar cell = '<th class=\"cw\">&nbsp;</th>';\n\t\t\t\thtml += cell;\n\t\t\t\tthis.picker.find('.datepicker-days thead tr:first-child').prepend(cell);\n\t\t\t}\n\t\t\twhile (dowCnt < this.o.weekStart + 7){\n\t\t\t\thtml += '<th class=\"dow\">'+dates[this.o.language].daysMin[(dowCnt++)%7]+'</th>';\n\t\t\t}\n\t\t\thtml += '</tr>';\n\t\t\tthis.picker.find('.datepicker-days thead').append(html);\n\t\t},\n\n\t\tfillMonths: function(){\n\t\t\tvar html = '',\n\t\t\ti = 0;\n\t\t\twhile (i < 12){\n\t\t\t\thtml += '<span class=\"month\">'+dates[this.o.language].monthsShort[i++]+'</span>';\n\t\t\t}\n\t\t\tthis.picker.find('.datepicker-months td').html(html);\n\t\t},\n\n\t\tsetRange: function(range){\n\t\t\tif (!range || !range.length)\n\t\t\t\tdelete this.range;\n\t\t\telse\n\t\t\t\tthis.range = $.map(range, function(d){\n\t\t\t\t\treturn d.valueOf();\n\t\t\t\t});\n\t\t\tthis.fill();\n\t\t},\n\n\t\tgetClassNames: function(date){\n\t\t\tvar cls = [],\n\t\t\t\tyear = this.viewDate.getUTCFullYear(),\n\t\t\t\tmonth = this.viewDate.getUTCMonth(),\n\t\t\t\ttoday = new Date();\n\t\t\tif (date.getUTCFullYear() < year || (date.getUTCFullYear() === year && date.getUTCMonth() < month)){\n\t\t\t\tcls.push('old');\n\t\t\t}\n\t\t\telse if (date.getUTCFullYear() > year || (date.getUTCFullYear() === year && date.getUTCMonth() > month)){\n\t\t\t\tcls.push('new');\n\t\t\t}\n\t\t\tif (this.focusDate && date.valueOf() === this.focusDate.valueOf())\n\t\t\t\tcls.push('focused');\n\t\t\t// Compare internal UTC date with local today, not UTC today\n\t\t\tif (this.o.todayHighlight &&\n\t\t\t\tdate.getUTCFullYear() === today.getFullYear() &&\n\t\t\t\tdate.getUTCMonth() === today.getMonth() &&\n\t\t\t\tdate.getUTCDate() === today.getDate()){\n\t\t\t\tcls.push('today');\n\t\t\t}\n\t\t\tif (this.dates.contains(date) !== -1)\n\t\t\t\tcls.push('active');\n\t\t\tif (date.valueOf() < this.o.startDate || date.valueOf() > this.o.endDate ||\n\t\t\t\t$.inArray(date.getUTCDay(), this.o.daysOfWeekDisabled) !== -1){\n\t\t\t\tcls.push('disabled');\n\t\t\t}\n\t\t\tif (this.range){\n\t\t\t\tif (date > this.range[0] && date < this.range[this.range.length-1]){\n\t\t\t\t\tcls.push('range');\n\t\t\t\t}\n\t\t\t\tif ($.inArray(date.valueOf(), this.range) !== -1){\n\t\t\t\t\tcls.push('selected');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn cls;\n\t\t},\n\n\t\tfill: function(){\n\t\t\tvar d = new Date(this.viewDate),\n\t\t\t\tyear = d.getUTCFullYear(),\n\t\t\t\tmonth = d.getUTCMonth(),\n\t\t\t\tstartYear = this.o.startDate !== -Infinity ? this.o.startDate.getUTCFullYear() : -Infinity,\n\t\t\t\tstartMonth = this.o.startDate !== -Infinity ? this.o.startDate.getUTCMonth() : -Infinity,\n\t\t\t\tendYear = this.o.endDate !== Infinity ? this.o.endDate.getUTCFullYear() : Infinity,\n\t\t\t\tendMonth = this.o.endDate !== Infinity ? this.o.endDate.getUTCMonth() : Infinity,\n\t\t\t\ttodaytxt = dates[this.o.language].today || dates['en'].today || '',\n\t\t\t\tcleartxt = dates[this.o.language].clear || dates['en'].clear || '',\n\t\t\t\ttooltip;\n\t\t\tthis.picker.find('.datepicker-days thead th.datepicker-switch')\n\t\t\t\t\t\t.text(dates[this.o.language].months[month]+' '+year);\n\t\t\tthis.picker.find('tfoot th.today')\n\t\t\t\t\t\t.text(todaytxt)\n\t\t\t\t\t\t.toggle(this.o.todayBtn !== false);\n\t\t\tthis.picker.find('tfoot th.clear')\n\t\t\t\t\t\t.text(cleartxt)\n\t\t\t\t\t\t.toggle(this.o.clearBtn !== false);\n\t\t\tthis.updateNavArrows();\n\t\t\tthis.fillMonths();\n\t\t\tvar prevMonth = UTCDate(year, month-1, 28),\n\t\t\t\tday = DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(), prevMonth.getUTCMonth());\n\t\t\tprevMonth.setUTCDate(day);\n\t\t\tprevMonth.setUTCDate(day - (prevMonth.getUTCDay() - this.o.weekStart + 7)%7);\n\t\t\tvar nextMonth = new Date(prevMonth);\n\t\t\tnextMonth.setUTCDate(nextMonth.getUTCDate() + 42);\n\t\t\tnextMonth = nextMonth.valueOf();\n\t\t\tvar html = [];\n\t\t\tvar clsName;\n\t\t\twhile (prevMonth.valueOf() < nextMonth){\n\t\t\t\tif (prevMonth.getUTCDay() === this.o.weekStart){\n\t\t\t\t\thtml.push('<tr>');\n\t\t\t\t\tif (this.o.calendarWeeks){\n\t\t\t\t\t\t// ISO 8601: First week contains first thursday.\n\t\t\t\t\t\t// ISO also states week starts on Monday, but we can be more abstract here.\n\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t// Start of current week: based on weekstart/current date\n\t\t\t\t\t\t\tws = new Date(+prevMonth + (this.o.weekStart - prevMonth.getUTCDay() - 7) % 7 * 864e5),\n\t\t\t\t\t\t\t// Thursday of this week\n\t\t\t\t\t\t\tth = new Date(Number(ws) + (7 + 4 - ws.getUTCDay()) % 7 * 864e5),\n\t\t\t\t\t\t\t// First Thursday of year, year from thursday\n\t\t\t\t\t\t\tyth = new Date(Number(yth = UTCDate(th.getUTCFullYear(), 0, 1)) + (7 + 4 - yth.getUTCDay())%7*864e5),\n\t\t\t\t\t\t\t// Calendar week: ms between thursdays, div ms per day, div 7 days\n\t\t\t\t\t\t\tcalWeek =  (th - yth) / 864e5 / 7 + 1;\n\t\t\t\t\t\thtml.push('<td class=\"cw\">'+ calWeek +'</td>');\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclsName = this.getClassNames(prevMonth);\n\t\t\t\tclsName.push('day');\n\n\t\t\t\tif (this.o.beforeShowDay !== $.noop){\n\t\t\t\t\tvar before = this.o.beforeShowDay(this._utc_to_local(prevMonth));\n\t\t\t\t\tif (before === undefined)\n\t\t\t\t\t\tbefore = {};\n\t\t\t\t\telse if (typeof(before) === 'boolean')\n\t\t\t\t\t\tbefore = {enabled: before};\n\t\t\t\t\telse if (typeof(before) === 'string')\n\t\t\t\t\t\tbefore = {classes: before};\n\t\t\t\t\tif (before.enabled === false)\n\t\t\t\t\t\tclsName.push('disabled');\n\t\t\t\t\tif (before.classes)\n\t\t\t\t\t\tclsName = clsName.concat(before.classes.split(/\\s+/));\n\t\t\t\t\tif (before.tooltip)\n\t\t\t\t\t\ttooltip = before.tooltip;\n\t\t\t\t}\n\n\t\t\t\tclsName = $.unique(clsName);\n\t\t\t\thtml.push('<td class=\"'+clsName.join(' ')+'\"' + (tooltip ? ' title=\"'+tooltip+'\"' : '') + '>'+prevMonth.getUTCDate() + '</td>');\n\t\t\t\tif (prevMonth.getUTCDay() === this.o.weekEnd){\n\t\t\t\t\thtml.push('</tr>');\n\t\t\t\t}\n\t\t\t\tprevMonth.setUTCDate(prevMonth.getUTCDate()+1);\n\t\t\t}\n\t\t\tthis.picker.find('.datepicker-days tbody').empty().append(html.join(''));\n\n\t\t\tvar months = this.picker.find('.datepicker-months')\n\t\t\t\t\t\t.find('th:eq(1)')\n\t\t\t\t\t\t\t.text(year)\n\t\t\t\t\t\t\t.end()\n\t\t\t\t\t\t.find('span').removeClass('active');\n\n\t\t\t$.each(this.dates, function(i, d){\n\t\t\t\tif (d.getUTCFullYear() === year)\n\t\t\t\t\tmonths.eq(d.getUTCMonth()).addClass('active');\n\t\t\t});\n\n\t\t\tif (year < startYear || year > endYear){\n\t\t\t\tmonths.addClass('disabled');\n\t\t\t}\n\t\t\tif (year === startYear){\n\t\t\t\tmonths.slice(0, startMonth).addClass('disabled');\n\t\t\t}\n\t\t\tif (year === endYear){\n\t\t\t\tmonths.slice(endMonth+1).addClass('disabled');\n\t\t\t}\n\n\t\t\thtml = '';\n\t\t\tyear = parseInt(year/10, 10) * 10;\n\t\t\tvar yearCont = this.picker.find('.datepicker-years')\n\t\t\t\t\t\t\t\t.find('th:eq(1)')\n\t\t\t\t\t\t\t\t\t.text(year + '-' + (year + 9))\n\t\t\t\t\t\t\t\t\t.end()\n\t\t\t\t\t\t\t\t.find('td');\n\t\t\tyear -= 1;\n\t\t\tvar years = $.map(this.dates, function(d){\n\t\t\t\t\treturn d.getUTCFullYear();\n\t\t\t\t}),\n\t\t\t\tclasses;\n\t\t\tfor (var i = -1; i < 11; i++){\n\t\t\t\tclasses = ['year'];\n\t\t\t\tif (i === -1)\n\t\t\t\t\tclasses.push('old');\n\t\t\t\telse if (i === 10)\n\t\t\t\t\tclasses.push('new');\n\t\t\t\tif ($.inArray(year, years) !== -1)\n\t\t\t\t\tclasses.push('active');\n\t\t\t\tif (year < startYear || year > endYear)\n\t\t\t\t\tclasses.push('disabled');\n\t\t\t\thtml += '<span class=\"' + classes.join(' ') + '\">'+year+'</span>';\n\t\t\t\tyear += 1;\n\t\t\t}\n\t\t\tyearCont.html(html);\n\t\t},\n\n\t\tupdateNavArrows: function(){\n\t\t\tif (!this._allow_update)\n\t\t\t\treturn;\n\n\t\t\tvar d = new Date(this.viewDate),\n\t\t\t\tyear = d.getUTCFullYear(),\n\t\t\t\tmonth = d.getUTCMonth();\n\t\t\tswitch (this.viewMode){\n\t\t\t\tcase 0:\n\t\t\t\t\tif (this.o.startDate !== -Infinity && year <= this.o.startDate.getUTCFullYear() && month <= this.o.startDate.getUTCMonth()){\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tif (this.o.endDate !== Infinity && year >= this.o.endDate.getUTCFullYear() && month >= this.o.endDate.getUTCMonth()){\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\tcase 2:\n\t\t\t\t\tif (this.o.startDate !== -Infinity && year <= this.o.startDate.getUTCFullYear()){\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.prev').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tif (this.o.endDate !== Infinity && year >= this.o.endDate.getUTCFullYear()){\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'hidden'});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.picker.find('.next').css({visibility: 'visible'});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tclick: function(e){\n\t\t\te.preventDefault();\n\t\t\tvar target = $(e.target).closest('span, td, th'),\n\t\t\t\tyear, month, day;\n\t\t\tif (target.length === 1){\n\t\t\t\tswitch (target[0].nodeName.toLowerCase()){\n\t\t\t\t\tcase 'th':\n\t\t\t\t\t\tswitch (target[0].className){\n\t\t\t\t\t\t\tcase 'datepicker-switch':\n\t\t\t\t\t\t\t\tthis.showMode(1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'prev':\n\t\t\t\t\t\t\tcase 'next':\n\t\t\t\t\t\t\t\tvar dir = DPGlobal.modes[this.viewMode].navStep * (target[0].className === 'prev' ? -1 : 1);\n\t\t\t\t\t\t\t\tswitch (this.viewMode){\n\t\t\t\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t\t\t\tthis.viewDate = this.moveMonth(this.viewDate, dir);\n\t\t\t\t\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\t\tthis.viewDate = this.moveYear(this.viewDate, dir);\n\t\t\t\t\t\t\t\t\t\tif (this.viewMode === 1)\n\t\t\t\t\t\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'today':\n\t\t\t\t\t\t\t\tvar date = new Date();\n\t\t\t\t\t\t\t\tdate = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);\n\n\t\t\t\t\t\t\t\tthis.showMode(-2);\n\t\t\t\t\t\t\t\tvar which = this.o.todayBtn === 'linked' ? null : 'view';\n\t\t\t\t\t\t\t\tthis._setDate(date, which);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\t\t\tvar element;\n\t\t\t\t\t\t\t\tif (this.isInput)\n\t\t\t\t\t\t\t\t\telement = this.element;\n\t\t\t\t\t\t\t\telse if (this.component)\n\t\t\t\t\t\t\t\t\telement = this.element.find('input');\n\t\t\t\t\t\t\t\tif (element)\n\t\t\t\t\t\t\t\t\telement.val(\"\").change();\n\t\t\t\t\t\t\t\tthis.update();\n\t\t\t\t\t\t\t\tthis._trigger('changeDate');\n\t\t\t\t\t\t\t\tif (this.o.autoclose)\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'span':\n\t\t\t\t\t\tif (!target.is('.disabled')){\n\t\t\t\t\t\t\tthis.viewDate.setUTCDate(1);\n\t\t\t\t\t\t\tif (target.is('.month')){\n\t\t\t\t\t\t\t\tday = 1;\n\t\t\t\t\t\t\t\tmonth = target.parent().find('span').index(target);\n\t\t\t\t\t\t\t\tyear = this.viewDate.getUTCFullYear();\n\t\t\t\t\t\t\t\tthis.viewDate.setUTCMonth(month);\n\t\t\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t\t\t\tif (this.o.minViewMode === 1){\n\t\t\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tday = 1;\n\t\t\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\t\t\tyear = parseInt(target.text(), 10)||0;\n\t\t\t\t\t\t\t\tthis.viewDate.setUTCFullYear(year);\n\t\t\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t\t\t\tif (this.o.minViewMode === 2){\n\t\t\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.showMode(-1);\n\t\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'td':\n\t\t\t\t\t\tif (target.is('.day') && !target.is('.disabled')){\n\t\t\t\t\t\t\tday = parseInt(target.text(), 10)||1;\n\t\t\t\t\t\t\tyear = this.viewDate.getUTCFullYear();\n\t\t\t\t\t\t\tmonth = this.viewDate.getUTCMonth();\n\t\t\t\t\t\t\tif (target.is('.old')){\n\t\t\t\t\t\t\t\tif (month === 0){\n\t\t\t\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\t\t\t\tyear -= 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tmonth -= 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (target.is('.new')){\n\t\t\t\t\t\t\t\tif (month === 11){\n\t\t\t\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\t\t\t\tyear += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tmonth += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._setDate(UTCDate(year, month, day));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.picker.is(':visible') && this._focused_from){\n\t\t\t\t$(this._focused_from).focus();\n\t\t\t}\n\t\t\tdelete this._focused_from;\n\t\t},\n\n\t\t_toggle_multidate: function(date){\n\t\t\tvar ix = this.dates.contains(date);\n\t\t\tif (!date){\n\t\t\t\tthis.dates.clear();\n\t\t\t}\n\t\t\telse if (ix !== -1){\n\t\t\t\tthis.dates.remove(ix);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.dates.push(date);\n\t\t\t}\n\t\t\tif (typeof this.o.multidate === 'number')\n\t\t\t\twhile (this.dates.length > this.o.multidate)\n\t\t\t\t\tthis.dates.remove(0);\n\t\t},\n\n\t\t_setDate: function(date, which){\n\t\t\tif (!which || which === 'date')\n\t\t\t\tthis._toggle_multidate(date && new Date(date));\n\t\t\tif (!which || which  === 'view')\n\t\t\t\tthis.viewDate = date && new Date(date);\n\n\t\t\tthis.fill();\n\t\t\tthis.setValue();\n\t\t\tthis._trigger('changeDate');\n\t\t\tvar element;\n\t\t\tif (this.isInput){\n\t\t\t\telement = this.element;\n\t\t\t}\n\t\t\telse if (this.component){\n\t\t\t\telement = this.element.find('input');\n\t\t\t}\n\t\t\tif (element){\n\t\t\t\telement.change();\n\t\t\t}\n\t\t\tif (this.o.autoclose && (!which || which === 'date')){\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tmoveMonth: function(date, dir){\n\t\t\tif (!date)\n\t\t\t\treturn undefined;\n\t\t\tif (!dir)\n\t\t\t\treturn date;\n\t\t\tvar new_date = new Date(date.valueOf()),\n\t\t\t\tday = new_date.getUTCDate(),\n\t\t\t\tmonth = new_date.getUTCMonth(),\n\t\t\t\tmag = Math.abs(dir),\n\t\t\t\tnew_month, test;\n\t\t\tdir = dir > 0 ? 1 : -1;\n\t\t\tif (mag === 1){\n\t\t\t\ttest = dir === -1\n\t\t\t\t\t// If going back one month, make sure month is not current month\n\t\t\t\t\t// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)\n\t\t\t\t\t? function(){\n\t\t\t\t\t\treturn new_date.getUTCMonth() === month;\n\t\t\t\t\t}\n\t\t\t\t\t// If going forward one month, make sure month is as expected\n\t\t\t\t\t// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)\n\t\t\t\t\t: function(){\n\t\t\t\t\t\treturn new_date.getUTCMonth() !== new_month;\n\t\t\t\t\t};\n\t\t\t\tnew_month = month + dir;\n\t\t\t\tnew_date.setUTCMonth(new_month);\n\t\t\t\t// Dec -> Jan (12) or Jan -> Dec (-1) -- limit expected date to 0-11\n\t\t\t\tif (new_month < 0 || new_month > 11)\n\t\t\t\t\tnew_month = (new_month + 12) % 12;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// For magnitudes >1, move one month at a time...\n\t\t\t\tfor (var i=0; i < mag; i++)\n\t\t\t\t\t// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...\n\t\t\t\t\tnew_date = this.moveMonth(new_date, dir);\n\t\t\t\t// ...then reset the day, keeping it in the new month\n\t\t\t\tnew_month = new_date.getUTCMonth();\n\t\t\t\tnew_date.setUTCDate(day);\n\t\t\t\ttest = function(){\n\t\t\t\t\treturn new_month !== new_date.getUTCMonth();\n\t\t\t\t};\n\t\t\t}\n\t\t\t// Common date-resetting loop -- if date is beyond end of month, make it\n\t\t\t// end of month\n\t\t\twhile (test()){\n\t\t\t\tnew_date.setUTCDate(--day);\n\t\t\t\tnew_date.setUTCMonth(new_month);\n\t\t\t}\n\t\t\treturn new_date;\n\t\t},\n\n\t\tmoveYear: function(date, dir){\n\t\t\treturn this.moveMonth(date, dir*12);\n\t\t},\n\n\t\tdateWithinRange: function(date){\n\t\t\treturn date >= this.o.startDate && date <= this.o.endDate;\n\t\t},\n\n\t\tkeydown: function(e){\n\t\t\tif (this.picker.is(':not(:visible)')){\n\t\t\t\tif (e.keyCode === 27) // allow escape to hide and re-show picker\n\t\t\t\t\tthis.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar dateChanged = false,\n\t\t\t\tdir, newDate, newViewDate,\n\t\t\t\tfocusDate = this.focusDate || this.viewDate;\n\t\t\tswitch (e.keyCode){\n\t\t\t\tcase 27: // escape\n\t\t\t\t\tif (this.focusDate){\n\t\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 37: // left\n\t\t\t\tcase 39: // right\n\t\t\t\t\tif (!this.o.keyboardNavigation)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdir = e.keyCode === 37 ? -1 : 1;\n\t\t\t\t\tif (e.ctrlKey){\n\t\t\t\t\t\tnewDate = this.moveYear(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveYear(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.shiftKey){\n\t\t\t\t\t\tnewDate = this.moveMonth(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveMonth(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnewDate = new Date(this.dates.get(-1) || UTCToday());\n\t\t\t\t\t\tnewDate.setUTCDate(newDate.getUTCDate() + dir);\n\t\t\t\t\t\tnewViewDate = new Date(focusDate);\n\t\t\t\t\t\tnewViewDate.setUTCDate(focusDate.getUTCDate() + dir);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.dateWithinRange(newDate)){\n\t\t\t\t\t\tthis.focusDate = this.viewDate = newViewDate;\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 38: // up\n\t\t\t\tcase 40: // down\n\t\t\t\t\tif (!this.o.keyboardNavigation)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdir = e.keyCode === 38 ? -1 : 1;\n\t\t\t\t\tif (e.ctrlKey){\n\t\t\t\t\t\tnewDate = this.moveYear(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveYear(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeYear', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.shiftKey){\n\t\t\t\t\t\tnewDate = this.moveMonth(this.dates.get(-1) || UTCToday(), dir);\n\t\t\t\t\t\tnewViewDate = this.moveMonth(focusDate, dir);\n\t\t\t\t\t\tthis._trigger('changeMonth', this.viewDate);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnewDate = new Date(this.dates.get(-1) || UTCToday());\n\t\t\t\t\t\tnewDate.setUTCDate(newDate.getUTCDate() + dir * 7);\n\t\t\t\t\t\tnewViewDate = new Date(focusDate);\n\t\t\t\t\t\tnewViewDate.setUTCDate(focusDate.getUTCDate() + dir * 7);\n\t\t\t\t\t}\n\t\t\t\t\tif (this.dateWithinRange(newDate)){\n\t\t\t\t\t\tthis.focusDate = this.viewDate = newViewDate;\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t\tthis.fill();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 32: // spacebar\n\t\t\t\t\t// Spacebar is used in manually typing dates in some formats.\n\t\t\t\t\t// As such, its behavior should not be hijacked.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 13: // enter\n\t\t\t\t\tfocusDate = this.focusDate || this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tthis._toggle_multidate(focusDate);\n\t\t\t\t\tdateChanged = true;\n\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tthis.setValue();\n\t\t\t\t\tthis.fill();\n\t\t\t\t\tif (this.picker.is(':visible')){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tif (this.o.autoclose)\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 9: // tab\n\t\t\t\t\tthis.focusDate = null;\n\t\t\t\t\tthis.viewDate = this.dates.get(-1) || this.viewDate;\n\t\t\t\t\tthis.fill();\n\t\t\t\t\tthis.hide();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (dateChanged){\n\t\t\t\tif (this.dates.length)\n\t\t\t\t\tthis._trigger('changeDate');\n\t\t\t\telse\n\t\t\t\t\tthis._trigger('clearDate');\n\t\t\t\tvar element;\n\t\t\t\tif (this.isInput){\n\t\t\t\t\telement = this.element;\n\t\t\t\t}\n\t\t\t\telse if (this.component){\n\t\t\t\t\telement = this.element.find('input');\n\t\t\t\t}\n\t\t\t\tif (element){\n\t\t\t\t\telement.change();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tshowMode: function(dir){\n\t\t\tif (dir){\n\t\t\t\tthis.viewMode = Math.max(this.o.minViewMode, Math.min(2, this.viewMode + dir));\n\t\t\t}\n\t\t\tthis.picker\n\t\t\t\t.find('>div')\n\t\t\t\t.hide()\n\t\t\t\t.filter('.datepicker-'+DPGlobal.modes[this.viewMode].clsName)\n\t\t\t\t\t.css('display', 'block');\n\t\t\tthis.updateNavArrows();\n\t\t}\n\t};\n\n\tvar DateRangePicker = function(element, options){\n\t\tthis.element = $(element);\n\t\tthis.inputs = $.map(options.inputs, function(i){\n\t\t\treturn i.jquery ? i[0] : i;\n\t\t});\n\t\tdelete options.inputs;\n\n\t\t$(this.inputs)\n\t\t\t.datepicker(options)\n\t\t\t.bind('changeDate', $.proxy(this.dateUpdated, this));\n\n\t\tthis.pickers = $.map(this.inputs, function(i){\n\t\t\treturn $(i).data('datepicker');\n\t\t});\n\t\tthis.updateDates();\n\t};\n\tDateRangePicker.prototype = {\n\t\tupdateDates: function(){\n\t\t\tthis.dates = $.map(this.pickers, function(i){\n\t\t\t\treturn i.getUTCDate();\n\t\t\t});\n\t\t\tthis.updateRanges();\n\t\t},\n\t\tupdateRanges: function(){\n\t\t\tvar range = $.map(this.dates, function(d){\n\t\t\t\treturn d.valueOf();\n\t\t\t});\n\t\t\t$.each(this.pickers, function(i, p){\n\t\t\t\tp.setRange(range);\n\t\t\t});\n\t\t},\n\t\tdateUpdated: function(e){\n\t\t\t// `this.updating` is a workaround for preventing infinite recursion\n\t\t\t// between `changeDate` triggering and `setUTCDate` calling.  Until\n\t\t\t// there is a better mechanism.\n\t\t\tif (this.updating)\n\t\t\t\treturn;\n\t\t\tthis.updating = true;\n\n\t\t\tvar dp = $(e.target).data('datepicker'),\n\t\t\t\tnew_date = dp.getUTCDate(),\n\t\t\t\ti = $.inArray(e.target, this.inputs),\n\t\t\t\tl = this.inputs.length;\n\t\t\tif (i === -1)\n\t\t\t\treturn;\n\n\t\t\t$.each(this.pickers, function(i, p){\n\t\t\t\tif (!p.getUTCDate())\n\t\t\t\t\tp.setUTCDate(new_date);\n\t\t\t});\n\n\t\t\tif (new_date < this.dates[i]){\n\t\t\t\t// Date being moved earlier/left\n\t\t\t\twhile (i >= 0 && new_date < this.dates[i]){\n\t\t\t\t\tthis.pickers[i--].setUTCDate(new_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (new_date > this.dates[i]){\n\t\t\t\t// Date being moved later/right\n\t\t\t\twhile (i < l && new_date > this.dates[i]){\n\t\t\t\t\tthis.pickers[i++].setUTCDate(new_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateDates();\n\n\t\t\tdelete this.updating;\n\t\t},\n\t\tremove: function(){\n\t\t\t$.map(this.pickers, function(p){ p.remove(); });\n\t\t\tdelete this.element.data().datepicker;\n\t\t}\n\t};\n\n\tfunction opts_from_el(el, prefix){\n\t\t// Derive options from element data-attrs\n\t\tvar data = $(el).data(),\n\t\t\tout = {}, inkey,\n\t\t\treplace = new RegExp('^' + prefix.toLowerCase() + '([A-Z])');\n\t\tprefix = new RegExp('^' + prefix.toLowerCase());\n\t\tfunction re_lower(_,a){\n\t\t\treturn a.toLowerCase();\n\t\t}\n\t\tfor (var key in data)\n\t\t\tif (prefix.test(key)){\n\t\t\t\tinkey = key.replace(replace, re_lower);\n\t\t\t\tout[inkey] = data[key];\n\t\t\t}\n\t\treturn out;\n\t}\n\n\tfunction opts_from_locale(lang){\n\t\t// Derive options from locale plugins\n\t\tvar out = {};\n\t\t// Check if \"de-DE\" style date is available, if not language should\n\t\t// fallback to 2 letter code eg \"de\"\n\t\tif (!dates[lang]){\n\t\t\tlang = lang.split('-')[0];\n\t\t\tif (!dates[lang])\n\t\t\t\treturn;\n\t\t}\n\t\tvar d = dates[lang];\n\t\t$.each(locale_opts, function(i,k){\n\t\t\tif (k in d)\n\t\t\t\tout[k] = d[k];\n\t\t});\n\t\treturn out;\n\t}\n\n\tvar old = $.fn.datepicker;\n\t$.fn.datepicker = function(option){\n\t\tvar args = Array.apply(null, arguments);\n\t\targs.shift();\n\t\tvar internal_return;\n\t\tthis.each(function(){\n\t\t\tvar $this = $(this),\n\t\t\t\tdata = $this.data('datepicker'),\n\t\t\t\toptions = typeof option === 'object' && option;\n\t\t\tif (!data){\n\t\t\t\tvar elopts = opts_from_el(this, 'date'),\n\t\t\t\t\t// Preliminary otions\n\t\t\t\t\txopts = $.extend({}, defaults, elopts, options),\n\t\t\t\t\tlocopts = opts_from_locale(xopts.language),\n\t\t\t\t\t// Options priority: js args, data-attrs, locales, defaults\n\t\t\t\t\topts = $.extend({}, defaults, locopts, elopts, options);\n\t\t\t\tif ($this.is('.input-daterange') || opts.inputs){\n\t\t\t\t\tvar ropts = {\n\t\t\t\t\t\tinputs: opts.inputs || $this.find('input').toArray()\n\t\t\t\t\t};\n\t\t\t\t\t$this.data('datepicker', (data = new DateRangePicker(this, $.extend(opts, ropts))));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$this.data('datepicker', (data = new Datepicker(this, opts)));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof option === 'string' && typeof data[option] === 'function'){\n\t\t\t\tinternal_return = data[option].apply(data, args);\n\t\t\t\tif (internal_return !== undefined)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif (internal_return !== undefined)\n\t\t\treturn internal_return;\n\t\telse\n\t\t\treturn this;\n\t};\n\n\tvar defaults = $.fn.datepicker.defaults = {\n\t\tautoclose: false,\n\t\tbeforeShowDay: $.noop,\n\t\tcalendarWeeks: false,\n\t\tclearBtn: false,\n\t\tdaysOfWeekDisabled: [],\n\t\tendDate: Infinity,\n\t\tforceParse: true,\n\t\tformat: 'mm/dd/yyyy',\n\t\tkeyboardNavigation: true,\n\t\tlanguage: 'en',\n\t\tminViewMode: 0,\n\t\tmultidate: false,\n\t\tmultidateSeparator: ',',\n\t\torientation: \"auto\",\n\t\trtl: false,\n\t\tstartDate: -Infinity,\n\t\tstartView: 0,\n\t\ttodayBtn: false,\n\t\ttodayHighlight: false,\n\t\tweekStart: 0\n\t};\n\tvar locale_opts = $.fn.datepicker.locale_opts = [\n\t\t'format',\n\t\t'rtl',\n\t\t'weekStart'\n\t];\n\t$.fn.datepicker.Constructor = Datepicker;\n\tvar dates = $.fn.datepicker.dates = {\n\t\ten: {\n\t\t\tdays: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"],\n\t\t\tdaysShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"],\n\t\t\tdaysMin: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"],\n\t\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\t\tmonthsShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\t\ttoday: \"Today\",\n\t\t\tclear: \"Clear\"\n\t\t}\n\t};\n\n\tvar DPGlobal = {\n\t\tmodes: [\n\t\t\t{\n\t\t\t\tclsName: 'days',\n\t\t\t\tnavFnc: 'Month',\n\t\t\t\tnavStep: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tclsName: 'months',\n\t\t\t\tnavFnc: 'FullYear',\n\t\t\t\tnavStep: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tclsName: 'years',\n\t\t\t\tnavFnc: 'FullYear',\n\t\t\t\tnavStep: 10\n\t\t}],\n\t\tisLeapYear: function(year){\n\t\t\treturn (((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0));\n\t\t},\n\t\tgetDaysInMonth: function(year, month){\n\t\t\treturn [31, (DPGlobal.isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];\n\t\t},\n\t\tvalidParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g,\n\t\tnonpunctuation: /[^ -\\/:-@\\[\\u3400-\\u9fff-`{-~\\t\\n\\r]+/g,\n\t\tparseFormat: function(format){\n\t\t\t// IE treats \\0 as a string end in inputs (truncating the value),\n\t\t\t// so it's a bad format delimiter, anyway\n\t\t\tvar separators = format.replace(this.validParts, '\\0').split('\\0'),\n\t\t\t\tparts = format.match(this.validParts);\n\t\t\tif (!separators || !separators.length || !parts || parts.length === 0){\n\t\t\t\tthrow new Error(\"Invalid date format.\");\n\t\t\t}\n\t\t\treturn {separators: separators, parts: parts};\n\t\t},\n\t\tparseDate: function(date, format, language){\n\t\t\tif (!date)\n\t\t\t\treturn undefined;\n\t\t\tif (date instanceof Date)\n\t\t\t\treturn date;\n\t\t\tif (typeof format === 'string')\n\t\t\t\tformat = DPGlobal.parseFormat(format);\n\t\t\tvar part_re = /([\\-+]\\d+)([dmwy])/,\n\t\t\t\tparts = date.match(/([\\-+]\\d+)([dmwy])/g),\n\t\t\t\tpart, dir, i;\n\t\t\tif (/^[\\-+]\\d+[dmwy]([\\s,]+[\\-+]\\d+[dmwy])*$/.test(date)){\n\t\t\t\tdate = new Date();\n\t\t\t\tfor (i=0; i < parts.length; i++){\n\t\t\t\t\tpart = part_re.exec(parts[i]);\n\t\t\t\t\tdir = parseInt(part[1]);\n\t\t\t\t\tswitch (part[2]){\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\tdate.setUTCDate(date.getUTCDate() + dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'm':\n\t\t\t\t\t\t\tdate = Datepicker.prototype.moveMonth.call(Datepicker.prototype, date, dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'w':\n\t\t\t\t\t\t\tdate.setUTCDate(date.getUTCDate() + dir * 7);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'y':\n\t\t\t\t\t\t\tdate = Datepicker.prototype.moveYear.call(Datepicker.prototype, date, dir);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn UTCDate(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), 0, 0, 0);\n\t\t\t}\n\t\t\tparts = date && date.match(this.nonpunctuation) || [];\n\t\t\tdate = new Date();\n\t\t\tvar parsed = {},\n\t\t\t\tsetters_order = ['yyyy', 'yy', 'M', 'MM', 'm', 'mm', 'd', 'dd'],\n\t\t\t\tsetters_map = {\n\t\t\t\t\tyyyy: function(d,v){\n\t\t\t\t\t\treturn d.setUTCFullYear(v);\n\t\t\t\t\t},\n\t\t\t\t\tyy: function(d,v){\n\t\t\t\t\t\treturn d.setUTCFullYear(2000+v);\n\t\t\t\t\t},\n\t\t\t\t\tm: function(d,v){\n\t\t\t\t\t\tif (isNaN(d))\n\t\t\t\t\t\t\treturn d;\n\t\t\t\t\t\tv -= 1;\n\t\t\t\t\t\twhile (v < 0) v += 12;\n\t\t\t\t\t\tv %= 12;\n\t\t\t\t\t\td.setUTCMonth(v);\n\t\t\t\t\t\twhile (d.getUTCMonth() !== v)\n\t\t\t\t\t\t\td.setUTCDate(d.getUTCDate()-1);\n\t\t\t\t\t\treturn d;\n\t\t\t\t\t},\n\t\t\t\t\td: function(d,v){\n\t\t\t\t\t\treturn d.setUTCDate(v);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tval, filtered;\n\t\t\tsetters_map['M'] = setters_map['MM'] = setters_map['mm'] = setters_map['m'];\n\t\t\tsetters_map['dd'] = setters_map['d'];\n\t\t\tdate = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);\n\t\t\tvar fparts = format.parts.slice();\n\t\t\t// Remove noop parts\n\t\t\tif (parts.length !== fparts.length){\n\t\t\t\tfparts = $(fparts).filter(function(i,p){\n\t\t\t\t\treturn $.inArray(p, setters_order) !== -1;\n\t\t\t\t}).toArray();\n\t\t\t}\n\t\t\t// Process remainder\n\t\t\tfunction match_part(){\n\t\t\t\tvar m = this.slice(0, parts[i].length),\n\t\t\t\t\tp = parts[i].slice(0, m.length);\n\t\t\t\treturn m === p;\n\t\t\t}\n\t\t\tif (parts.length === fparts.length){\n\t\t\t\tvar cnt;\n\t\t\t\tfor (i=0, cnt = fparts.length; i < cnt; i++){\n\t\t\t\t\tval = parseInt(parts[i], 10);\n\t\t\t\t\tpart = fparts[i];\n\t\t\t\t\tif (isNaN(val)){\n\t\t\t\t\t\tswitch (part){\n\t\t\t\t\t\t\tcase 'MM':\n\t\t\t\t\t\t\t\tfiltered = $(dates[language].months).filter(match_part);\n\t\t\t\t\t\t\t\tval = $.inArray(filtered[0], dates[language].months) + 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'M':\n\t\t\t\t\t\t\t\tfiltered = $(dates[language].monthsShort).filter(match_part);\n\t\t\t\t\t\t\t\tval = $.inArray(filtered[0], dates[language].monthsShort) + 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tparsed[part] = val;\n\t\t\t\t}\n\t\t\t\tvar _date, s;\n\t\t\t\tfor (i=0; i < setters_order.length; i++){\n\t\t\t\t\ts = setters_order[i];\n\t\t\t\t\tif (s in parsed && !isNaN(parsed[s])){\n\t\t\t\t\t\t_date = new Date(date);\n\t\t\t\t\t\tsetters_map[s](_date, parsed[s]);\n\t\t\t\t\t\tif (!isNaN(_date))\n\t\t\t\t\t\t\tdate = _date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t},\n\t\tformatDate: function(date, format, language){\n\t\t\tif (!date)\n\t\t\t\treturn '';\n\t\t\tif (typeof format === 'string')\n\t\t\t\tformat = DPGlobal.parseFormat(format);\n\t\t\tvar val = {\n\t\t\t\td: date.getUTCDate(),\n\t\t\t\tD: dates[language].daysShort[date.getUTCDay()],\n\t\t\t\tDD: dates[language].days[date.getUTCDay()],\n\t\t\t\tm: date.getUTCMonth() + 1,\n\t\t\t\tM: dates[language].monthsShort[date.getUTCMonth()],\n\t\t\t\tMM: dates[language].months[date.getUTCMonth()],\n\t\t\t\tyy: date.getUTCFullYear().toString().substring(2),\n\t\t\t\tyyyy: date.getUTCFullYear()\n\t\t\t};\n\t\t\tval.dd = (val.d < 10 ? '0' : '') + val.d;\n\t\t\tval.mm = (val.m < 10 ? '0' : '') + val.m;\n\t\t\tdate = [];\n\t\t\tvar seps = $.extend([], format.separators);\n\t\t\tfor (var i=0, cnt = format.parts.length; i <= cnt; i++){\n\t\t\t\tif (seps.length)\n\t\t\t\t\tdate.push(seps.shift());\n\t\t\t\tdate.push(val[format.parts[i]]);\n\t\t\t}\n\t\t\treturn date.join('');\n\t\t},\n\t\theadTemplate: '<thead>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th class=\"prev\">&laquo;</th>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"5\" class=\"datepicker-switch\"></th>'+\n\t\t\t\t\t\t\t\t'<th class=\"next\">&raquo;</th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t'</thead>',\n\t\tcontTemplate: '<tbody><tr><td colspan=\"7\"></td></tr></tbody>',\n\t\tfootTemplate: '<tfoot>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"7\" class=\"today\"></th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t\t'<tr>'+\n\t\t\t\t\t\t\t\t'<th colspan=\"7\" class=\"clear\"></th>'+\n\t\t\t\t\t\t\t'</tr>'+\n\t\t\t\t\t\t'</tfoot>'\n\t};\n\tDPGlobal.template = '<div class=\"datepicker\">'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-days\">'+\n\t\t\t\t\t\t\t\t'<table class=\" table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\t'<tbody></tbody>'+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-months\">'+\n\t\t\t\t\t\t\t\t'<table class=\"table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.contTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t\t'<div class=\"datepicker-years\">'+\n\t\t\t\t\t\t\t\t'<table class=\"table-condensed\">'+\n\t\t\t\t\t\t\t\t\tDPGlobal.headTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.contTemplate+\n\t\t\t\t\t\t\t\t\tDPGlobal.footTemplate+\n\t\t\t\t\t\t\t\t'</table>'+\n\t\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t'</div>';\n\n\t$.fn.datepicker.DPGlobal = DPGlobal;\n\n\n\t/* DATEPICKER NO CONFLICT\n\t* =================== */\n\n\t$.fn.datepicker.noConflict = function(){\n\t\t$.fn.datepicker = old;\n\t\treturn this;\n\t};\n\n\n\t/* DATEPICKER DATA-API\n\t* ================== */\n\n\t$(document).on(\n\t\t'focus.datepicker.data-api click.datepicker.data-api',\n\t\t'[data-provide=\"datepicker\"]',\n\t\tfunction(e){\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('datepicker'))\n\t\t\t\treturn;\n\t\t\te.preventDefault();\n\t\t\t// component click requires us to explicitly show it\n\t\t\t$this.datepicker('show');\n\t\t}\n\t);\n\t$(function(){\n\t\t$('[data-provide=\"datepicker-inline\"]').datepicker();\n\t});\n\n}(window.jQuery));\n","!function(a){a.fn.datepicker.dates.es={days:[\"Domingo\",\"Lunes\",\"Martes\",\"Mircoles\",\"Jueves\",\"Viernes\",\"Sbado\"],daysShort:[\"Dom\",\"Lun\",\"Mar\",\"Mi\",\"Jue\",\"Vie\",\"Sb\"],daysMin:[\"Do\",\"Lu\",\"Ma\",\"Mi\",\"Ju\",\"Vi\",\"Sa\"],months:[\"Enero\",\"Febrero\",\"Marzo\",\"Abril\",\"Mayo\",\"Junio\",\"Julio\",\"Agosto\",\"Septiembre\",\"Octubre\",\"Noviembre\",\"Diciembre\"],monthsShort:[\"Ene\",\"Feb\",\"Mar\",\"Abr\",\"May\",\"Jun\",\"Jul\",\"Ago\",\"Sep\",\"Oct\",\"Nov\",\"Dic\"],today:\"Hoy\",monthsTitle:\"Meses\",clear:\"Borrar\",weekStart:1,format:\"dd/mm/yyyy\"}}(jQuery);","/*\n\tRedactor v10.0.9\n\tUpdated: March 16, 2015\n\n\thttp://imperavi.com/redactor/\n\n\tCopyright (c) 2009-2015, Imperavi LLC.\n\tLicense: http://imperavi.com/redactor/license/\n\n\tUsage: $('#content').redactor();\n*/\n\n(function($)\n{\n\t'use strict';\n\n\tif (!Function.prototype.bind)\n\t{\n\t\tFunction.prototype.bind = function(scope)\n\t\t{\n\t\t\tvar fn = this;\n\t\t\treturn function()\n\t\t\t{\n\t\t\t\treturn fn.apply(scope);\n\t\t\t};\n\t\t};\n\t}\n\n\tvar uuid = 0;\n\n\tvar reUrlYoutube = /https?:\\/\\/(?:[0-9A-Z-]+\\.)?(?:youtu\\.be\\/|youtube\\.com\\S*[^\\w\\-\\s])([\\w\\-]{11})(?=[^\\w\\-]|$)(?![?=&+%\\w.\\-]*(?:['\"][^<>]*>|<\\/a>))[?=&+%\\w.-]*/ig;\n\tvar reUrlVimeo = /https?:\\/\\/(www\\.)?vimeo.com\\/(\\d+)($|\\/)/;\n\n\t// Plugin\n\t$.fn.redactor = function(options)\n\t{\n\t\tvar val = [];\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\t\tif (typeof options === 'string')\n\t\t{\n\t\t\tthis.each(function()\n\t\t\t{\n\t\t\t\tvar instance = $.data(this, 'redactor');\n\t\t\t\tvar func;\n\n\t\t\t\tif (options.search(/\\./) != '-1')\n\t\t\t\t{\n\t\t\t\t\tfunc = options.split('.');\n\t\t\t\t\tif (typeof instance[func[0]] != 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tfunc = instance[func[0]][func[1]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfunc = instance[options];\n\t\t\t\t}\n\n\t\t\t\tif (typeof instance !== 'undefined' && $.isFunction(func))\n\t\t\t\t{\n\t\t\t\t\tvar methodVal = func.apply(instance, args);\n\t\t\t\t\tif (methodVal !== undefined && methodVal !== instance)\n\t\t\t\t\t{\n\t\t\t\t\t\tval.push(methodVal);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$.error('No such method \"' + options + '\" for Redactor');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.each(function()\n\t\t\t{\n\t\t\t\t$.data(this, 'redactor', {});\n\t\t\t\t$.data(this, 'redactor', Redactor(this, options));\n\t\t\t});\n\t\t}\n\n\t\tif (val.length === 0) return this;\n\t\telse if (val.length === 1) return val[0];\n\t\telse return val;\n\n\t};\n\n\t// Initialization\n\tfunction Redactor(el, options)\n\t{\n\t\treturn new Redactor.prototype.init(el, options);\n\t}\n\n\t// Functionality\n\t$.Redactor = Redactor;\n\t$.Redactor.VERSION = '10.0.9';\n\t$.Redactor.modules = ['alignment', 'autosave', 'block', 'buffer', 'build', 'button',\n\t\t\t\t\t\t  'caret', 'clean', 'code', 'core', 'dropdown', 'file', 'focus',\n\t\t\t\t\t\t  'image', 'indent', 'inline', 'insert', 'keydown', 'keyup',\n\t\t\t\t\t\t  'lang', 'line', 'link', 'list', 'modal', 'observe', 'paragraphize',\n\t\t\t\t\t\t  'paste', 'placeholder', 'progress', 'selection', 'shortcuts',\n\t\t\t\t\t\t  'tabifier', 'tidy',  'toolbar', 'upload', 'utils'];\n\n\t$.Redactor.opts = {\n\n\t\t// settings\n\t\tlang: 'en',\n\t\tdirection: 'ltr', // ltr or rtl\n\n\t\tplugins: false, // array\n\n\t\tfocus: false,\n\t\tfocusEnd: false,\n\n\t\tplaceholder: false,\n\n\t\tvisual: true,\n\t\ttabindex: false,\n\n\t\tminHeight: false,\n\t\tmaxHeight: false,\n\n\t\tlinebreaks: false,\n\t\treplaceDivs: true,\n\t\tparagraphize: true,\n\t\tcleanStyleOnEnter: false,\n\t\tenterKey: true,\n\n\t\tcleanOnPaste: true,\n\t\tcleanSpaces: true,\n\t\tpastePlainText: false,\n\n\t\tautosave: false, // false or url\n\t\tautosaveName: false,\n\t\tautosaveInterval: 60, // seconds\n\t\tautosaveOnChange: false,\n\t\tautosaveFields: false,\n\n\t\tlinkTooltip: true,\n\t\tlinkProtocol: 'http',\n\t\tlinkNofollow: false,\n\t\tlinkSize: 50,\n\n\t\timageEditable: true,\n\t\timageLink: true,\n\t\timagePosition: true,\n\t\timageFloatMargin: '10px',\n\t\timageResizable: true,\n\n\t\timageUpload: null,\n\t\timageUploadParam: 'file',\n\n\t\tuploadImageField: false,\n\n\t\tdragImageUpload: true,\n\n\t\tfileUpload: null,\n\t\tfileUploadParam: 'file',\n\n\t\tdragFileUpload: true,\n\n\t\ts3: false,\n\n\t\tconvertLinks: true,\n\t\tconvertUrlLinks: true,\n\t\tconvertImageLinks: true,\n\t\tconvertVideoLinks: true,\n\n\t\tpreSpaces: 4, // or false\n\t\ttabAsSpaces: false, // true or number of spaces\n\t\ttabKey: true,\n\n\t\tscrollTarget: false,\n\n\t\ttoolbar: true,\n\t\ttoolbarFixed: true,\n\t\ttoolbarFixedTarget: document,\n\t\ttoolbarFixedTopOffset: 0, // pixels\n\t\ttoolbarExternal: false, // ID selector\n\t\ttoolbarOverflow: false,\n\n\t\tsource: true,\n\t\tbuttons: ['html', 'formatting', 'bold', 'italic', 'deleted', 'unorderedlist', 'orderedlist',\n\t\t\t\t  'outdent', 'indent', 'image', 'file', 'link', 'alignment', 'horizontalrule'], // + 'underline'\n\n\t\tbuttonsHide: [],\n\t\tbuttonsHideOnMobile: [],\n\n\t\tformatting: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n\t\tformattingAdd: false,\n\n\t\ttabifier: true,\n\n\t\tdeniedTags: ['script', 'style'],\n\t\tallowedTags: false, // or array\n\n\t\tremoveComments: false,\n\t\treplaceTags: [\n\t\t\t['strike', 'del']\n\t\t],\n\t\treplaceStyles: [\n            ['font-weight:\\\\s?bold', \"strong\"],\n            ['font-style:\\\\s?italic', \"em\"],\n            ['text-decoration:\\\\s?underline', \"u\"],\n            ['text-decoration:\\\\s?line-through', 'del']\n        ],\n        removeDataAttr: false,\n\n\t\tremoveAttr: false, // or multi array\n\t\tallowedAttr: false, // or multi array\n\n\t\tremoveWithoutAttr: ['span'], // or false\n\t\tremoveEmpty: ['p'], // or false;\n\n\t\tactiveButtons: ['deleted', 'italic', 'bold', 'underline', 'unorderedlist', 'orderedlist',\n\t\t\t\t\t\t'alignleft', 'aligncenter', 'alignright', 'justify'],\n\t\tactiveButtonsStates: {\n\t\t\tb: 'bold',\n\t\t\tstrong: 'bold',\n\t\t\ti: 'italic',\n\t\t\tem: 'italic',\n\t\t\tdel: 'deleted',\n\t\t\tstrike: 'deleted',\n\t\t\tul: 'unorderedlist',\n\t\t\tol: 'orderedlist',\n\t\t\tu: 'underline'\n\t\t},\n\n\t\tshortcuts: {\n\t\t\t'ctrl+shift+m, meta+shift+m': { func: 'inline.removeFormat' },\n\t\t\t'ctrl+b, meta+b': { func: 'inline.format', params: ['bold'] },\n\t\t\t'ctrl+i, meta+i': { func: 'inline.format', params: ['italic'] },\n\t\t\t'ctrl+h, meta+h': { func: 'inline.format', params: ['superscript'] },\n\t\t\t'ctrl+l, meta+l': { func: 'inline.format', params: ['subscript'] },\n\t\t\t'ctrl+k, meta+k': { func: 'link.show' },\n\t\t\t'ctrl+shift+7':   { func: 'list.toggle', params: ['orderedlist'] },\n\t\t\t'ctrl+shift+8':   { func: 'list.toggle', params: ['unorderedlist'] }\n\t\t},\n\t\tshortcutsAdd: false,\n\n\t\t// private\n\t\tbuffer: [],\n\t\trebuffer: [],\n\t\temptyHtml: '<p>&#x200b;</p>',\n\t\tinvisibleSpace: '&#x200b;',\n\t\timageTypes: ['image/png', 'image/jpeg', 'image/gif'],\n\t\tindentValue: 20,\n\t\tverifiedTags: \t\t['a', 'img', 'b', 'strong', 'sub', 'sup', 'i', 'em', 'u', 'small', 'strike', 'del', 'cite', 'ul', 'ol', 'li'], // and for span tag special rule\n\t\tinlineTags: \t\t['strong', 'b', 'u', 'em', 'i', 'code', 'del', 'ins', 'samp', 'kbd', 'sup', 'sub', 'mark', 'var', 'cite', 'small'],\n\t\talignmentTags: \t\t['P', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6',  'DL', 'DT', 'DD', 'DIV', 'TD', 'BLOCKQUOTE', 'OUTPUT', 'FIGCAPTION', 'ADDRESS', 'SECTION', 'HEADER', 'FOOTER', 'ASIDE', 'ARTICLE'],\n\t\tblockLevelElements: ['PRE', 'UL', 'OL', 'LI'],\n\n\n\t\t// lang\n\t\tlangs: {\n\t\t\ten: {\n\t\t\t\thtml: 'HTML',\n\t\t\t\tvideo: 'Insert Video',\n\t\t\t\timage: 'Insert Image',\n\t\t\t\ttable: 'Table',\n\t\t\t\tlink: 'Link',\n\t\t\t\tlink_insert: 'Insert link',\n\t\t\t\tlink_edit: 'Edit link',\n\t\t\t\tunlink: 'Unlink',\n\t\t\t\tformatting: 'Formatting',\n\t\t\t\tparagraph: 'Normal text',\n\t\t\t\tquote: 'Quote',\n\t\t\t\tcode: 'Code',\n\t\t\t\theader1: 'Header 1',\n\t\t\t\theader2: 'Header 2',\n\t\t\t\theader3: 'Header 3',\n\t\t\t\theader4: 'Header 4',\n\t\t\t\theader5: 'Header 5',\n\t\t\t\tbold: 'Bold',\n\t\t\t\titalic: 'Italic',\n\t\t\t\tfontcolor: 'Font Color',\n\t\t\t\tbackcolor: 'Back Color',\n\t\t\t\tunorderedlist: 'Unordered List',\n\t\t\t\torderedlist: 'Ordered List',\n\t\t\t\toutdent: 'Outdent',\n\t\t\t\tindent: 'Indent',\n\t\t\t\tcancel: 'Cancel',\n\t\t\t\tinsert: 'Insert',\n\t\t\t\tsave: 'Save',\n\t\t\t\t_delete: 'Delete',\n\t\t\t\tinsert_table: 'Insert Table',\n\t\t\t\tinsert_row_above: 'Add Row Above',\n\t\t\t\tinsert_row_below: 'Add Row Below',\n\t\t\t\tinsert_column_left: 'Add Column Left',\n\t\t\t\tinsert_column_right: 'Add Column Right',\n\t\t\t\tdelete_column: 'Delete Column',\n\t\t\t\tdelete_row: 'Delete Row',\n\t\t\t\tdelete_table: 'Delete Table',\n\t\t\t\trows: 'Rows',\n\t\t\t\tcolumns: 'Columns',\n\t\t\t\tadd_head: 'Add Head',\n\t\t\t\tdelete_head: 'Delete Head',\n\t\t\t\ttitle: 'Title',\n\t\t\t\timage_position: 'Position',\n\t\t\t\tnone: 'None',\n\t\t\t\tleft: 'Left',\n\t\t\t\tright: 'Right',\n\t\t\t\tcenter: 'Center',\n\t\t\t\timage_web_link: 'Image Web Link',\n\t\t\t\ttext: 'Text',\n\t\t\t\tmailto: 'Email',\n\t\t\t\tweb: 'URL',\n\t\t\t\tvideo_html_code: 'Video Embed Code or Youtube/Vimeo Link',\n\t\t\t\tfile: 'Insert File',\n\t\t\t\tupload: 'Upload',\n\t\t\t\tdownload: 'Download',\n\t\t\t\tchoose: 'Choose',\n\t\t\t\tor_choose: 'Or choose',\n\t\t\t\tdrop_file_here: 'Drop file here',\n\t\t\t\talign_left: 'Align text to the left',\n\t\t\t\talign_center: 'Center text',\n\t\t\t\talign_right: 'Align text to the right',\n\t\t\t\talign_justify: 'Justify text',\n\t\t\t\thorizontalrule: 'Insert Horizontal Rule',\n\t\t\t\tdeleted: 'Deleted',\n\t\t\t\tanchor: 'Anchor',\n\t\t\t\tlink_new_tab: 'Open link in new tab',\n\t\t\t\tunderline: 'Underline',\n\t\t\t\talignment: 'Alignment',\n\t\t\t\tfilename: 'Name (optional)',\n\t\t\t\tedit: 'Edit',\n\t\t\t\tupload_label: 'Drop file here or '\n\n\t\t\t}\n\t\t}\n\t};\n\n\t// Functionality\n\tRedactor.fn = $.Redactor.prototype = {\n\n\t\tkeyCode: {\n\t\t\tBACKSPACE: 8,\n\t\t\tDELETE: 46,\n\t\t\tDOWN: 40,\n\t\t\tENTER: 13,\n\t\t\tSPACE: 32,\n\t\t\tESC: 27,\n\t\t\tTAB: 9,\n\t\t\tCTRL: 17,\n\t\t\tMETA: 91,\n\t\t\tSHIFT: 16,\n\t\t\tALT: 18,\n\t\t\tRIGHT: 39,\n\t\t\tLEFT: 37,\n\t\t\tLEFT_WIN: 91\n\t\t},\n\n\t\t// Initialization\n\t\tinit: function(el, options)\n\t\t{\n\t\t\tthis.$element = $(el);\n\t\t\tthis.uuid = uuid++;\n\n\t\t\t// if paste event detected = true\n\t\t\tthis.rtePaste = false;\n\t\t\tthis.$pasteBox = false;\n\n\t\t\tthis.loadOptions(options);\n\t\t\tthis.loadModules();\n\n\t\t\t// formatting storage\n\t\t\tthis.formatting = {};\n\n\t\t\t// block level tags\n\t\t\t$.merge(this.opts.blockLevelElements, this.opts.alignmentTags);\n\t\t\tthis.reIsBlock = new RegExp('^(' + this.opts.blockLevelElements.join('|' ) + ')$', 'i');\n\n\t\t\t// setup allowed and denied tags\n\t\t\tthis.tidy.setupAllowed();\n\n\t\t\t// setup denied tags\n\t\t\tif (this.opts.deniedTags !== false)\n\t\t\t{\n\t\t\t\tvar tags = ['html', 'head', 'link', 'body', 'meta', 'applet'];\n\t\t\t\tfor (var i = 0; i < tags.length; i++)\n\t\t\t\t{\n\t\t\t\t\tthis.opts.deniedTags.push(tags[i]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// load lang\n\t\t\tthis.lang.load();\n\n\t\t\t// extend shortcuts\n\t\t\t$.extend(this.opts.shortcuts, this.opts.shortcutsAdd);\n\n\t\t\t// start callback\n\t\t\tthis.core.setCallback('start');\n\n\t\t\t// build\n\t\t\tthis.start = true;\n\t\t\tthis.build.run();\n\t\t},\n\n\t\tloadOptions: function(options)\n\t\t{\n\t\t\tthis.opts = $.extend(\n\t\t\t\t{},\n\t\t\t\t$.extend(true, {}, $.Redactor.opts),\n\t\t\t\tthis.$element.data(),\n\t\t\t\toptions\n\t\t\t);\n\t\t},\n\t\tgetModuleMethods: function(object)\n\t\t{\n\t\t\treturn Object.getOwnPropertyNames(object).filter(function(property)\n\t\t\t{\n\t\t\t\treturn typeof object[property] == 'function';\n\t\t\t});\n\t\t},\n\t\tloadModules: function()\n\t\t{\n\t\t\tvar len = $.Redactor.modules.length;\n\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t{\n\t\t\t\tthis.bindModuleMethods($.Redactor.modules[i]);\n\t\t\t}\n\t\t},\n\t\tbindModuleMethods: function(module)\n\t\t{\n\t\t\tif (typeof this[module] == 'undefined') return;\n\n\t\t\t// init module\n\t\t\tthis[module] = this[module]();\n\n\t\t\tvar methods = this.getModuleMethods(this[module]);\n\t\t\tvar len = methods.length;\n\n\t\t\t// bind methods\n\t\t\tfor (var z = 0; z < len; z++)\n\t\t\t{\n\t\t\t\tthis[module][methods[z]] = this[module][methods[z]].bind(this);\n\t\t\t}\n\t\t},\n\n\t\talignment: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tleft: function()\n\t\t\t\t{\n\t\t\t\t\tthis.alignment.set('');\n\t\t\t\t},\n\t\t\t\tright: function()\n\t\t\t\t{\n\t\t\t\t\tthis.alignment.set('right');\n\t\t\t\t},\n\t\t\t\tcenter: function()\n\t\t\t\t{\n\t\t\t\t\tthis.alignment.set('center');\n\t\t\t\t},\n\t\t\t\tjustify: function()\n\t\t\t\t{\n\t\t\t\t\tthis.alignment.set('justify');\n\t\t\t\t},\n\t\t\t\tset: function(type)\n\t\t\t\t{\n\t\t\t\t\t// focus\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\t// get blocks\n\t\t\t\t\tthis.alignment.blocks = this.selection.getBlocks();\n\t\t\t\t\tthis.alignment.type = type;\n\n\t\t\t\t\t// set alignment\n\t\t\t\t\tif (this.alignment.isLinebreaksOrNoBlocks())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.alignment.setText();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.alignment.setBlocks();\n\t\t\t\t\t}\n\n\t\t\t\t\t// sync\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tsetText: function()\n\t\t\t\t{\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\n\t\t\t\t\t$(wrapper).attr('data-tagblock', 'redactor').css('text-align', this.alignment.type);\n\t\t\t\t},\n\t\t\t\tsetBlocks: function()\n\t\t\t\t{\n\t\t\t\t\t$.each(this.alignment.blocks, $.proxy(function(i, el)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(el);\n\t\t\t\t\t\tif (!$el) return;\n\n\t\t\t\t\t\tif (this.alignment.isNeedReplaceElement($el))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.alignment.replaceElement($el);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.alignment.alignElement($el);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tisLinebreaksOrNoBlocks: function()\n\t\t\t\t{\n\t\t\t\t\treturn (this.opts.linebreaks && this.alignment.blocks[0] === false);\n\t\t\t\t},\n\t\t\t\tisNeedReplaceElement: function($el)\n\t\t\t\t{\n\t\t\t\t\treturn (this.alignment.type === '' && typeof($el.data('tagblock')) !== 'undefined');\n\t\t\t\t},\n\t\t\t\treplaceElement: function($el)\n\t\t\t\t{\n\t\t\t\t\t$el.replaceWith($el.html());\n\t\t\t\t},\n\t\t\t\talignElement: function($el)\n\t\t\t\t{\n\t\t\t\t\t$el.css('text-align', this.alignment.type);\n\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tautosave: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tenable: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.autosave) return;\n\n\t\t\t\t\tthis.autosave.html = false;\n\t\t\t\t\tthis.autosave.name = (this.opts.autosaveName) ? this.opts.autosaveName : this.$textarea.attr('name');\n\n\t\t\t\t\tif (this.opts.autosaveOnChange) return;\n\t\t\t\t\tthis.autosaveInterval = setInterval(this.autosave.load, this.opts.autosaveInterval * 1000);\n\t\t\t\t},\n\t\t\t\tonChange: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.autosaveOnChange) return;\n\t\t\t\t\tthis.autosave.load();\n\t\t\t\t},\n\t\t\t\tload: function()\n\t\t\t\t{\n\t\t\t\t\tthis.autosave.source = this.code.get();\n\n\t\t\t\t\tif (this.autosave.html === this.autosave.source) return;\n\t\t\t\t\tif (this.utils.isEmpty(this.autosave.source)) return;\n\n\t\t\t\t\t// data\n\t\t\t\t\tvar data = {};\n\t\t\t\t\tdata['name'] = this.autosave.name;\n\t\t\t\t\tdata[this.autosave.name] = this.autosave.source;\n\t\t\t\t\tdata = this.autosave.getHiddenFields(data);\n\n\t\t\t\t\t// ajax\n\t\t\t\t\tvar jsxhr = $.ajax({\n\t\t\t\t\t\turl: this.opts.autosave,\n\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t});\n\n\t\t\t\t\tjsxhr.done(this.autosave.success);\n\t\t\t\t},\n\t\t\t\tgetHiddenFields: function(data)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.autosaveFields === false || typeof this.opts.autosaveFields !== 'object')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(this.opts.autosaveFields, $.proxy(function(k, v)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\n\t\t\t\t\t\tdata[k] = v;\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn data;\n\n\t\t\t\t},\n\t\t\t\tsuccess: function(data)\n\t\t\t\t{\n\t\t\t\t\tvar json;\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tjson = $.parseJSON(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e)\n\t\t\t\t\t{\n\t\t\t\t\t\t//data has already been parsed\n\t\t\t\t\t\tjson = data;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar callbackName = (typeof json.error == 'undefined') ? 'autosave' :  'autosaveError';\n\n\t\t\t\t\tthis.core.setCallback(callbackName, this.autosave.name, json);\n\t\t\t\t\tthis.autosave.html = this.autosave.source;\n\t\t\t\t},\n\t\t\t\tdisable: function()\n\t\t\t\t{\n\t\t\t\t\tclearInterval(this.autosaveInterval);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tblock: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tformatting: function(name)\n\t\t\t\t{\n\t\t\t\t\tthis.block.clearStyle = false;\n\t\t\t\t\tvar type, value;\n\n\t\t\t\t\tif (typeof this.formatting[name].data != 'undefined') type = 'data';\n\t\t\t\t\telse if (typeof this.formatting[name].attr != 'undefined') type = 'attr';\n\t\t\t\t\telse if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\n\n\t\t\t\t\tif (typeof this.formatting[name].clear != 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.clearStyle = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (type) value = this.formatting[name][type];\n\n\t\t\t\t\tthis.block.format(this.formatting[name].tag, type, value);\n\n\t\t\t\t},\n\t\t\t\tformat: function(tag, type, value)\n\t\t\t\t{\n\t\t\t\t\tif (tag == 'quote') tag = 'blockquote';\n\n\t\t\t\t\tvar formatTags = ['p', 'pre', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\tif ($.inArray(tag, formatTags) == -1) return;\n\n\t\t\t\t\tthis.block.isRemoveInline = (tag == 'pre' || tag.search(/h[1-6]/i) != -1);\n\n\t\t\t\t\t// focus\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\tthis.block.blocks = this.selection.getBlocks();\n\n\t\t\t\t\tthis.block.blocksSize = this.block.blocks.length;\n\t\t\t\t\tthis.block.type = type;\n\t\t\t\t\tthis.block.value = value;\n\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tthis.block.set(tag);\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\tset: function(tag)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tthis.block.containerTag = this.range.commonAncestorContainer.tagName;\n\n\t\t\t\t\tif (this.range.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.setCollapsed(tag);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.setMultiple(tag);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCollapsed: function(tag)\n\t\t\t\t{\n\t\t\t\t\tvar block = this.block.blocks[0];\n\t\t\t\t\tif (block === false) return;\n\n\t\t\t\t\tif (block.tagName == 'LI')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tag != 'blockquote') return;\n\n\t\t\t\t\t\tthis.block.formatListToBlockquote();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\n\t\t\t\t\tif (isContainerTable && !this.opts.linebreaks)\n\t\t\t\t\t{\n\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, '<' + tag + '>');\n\n\t\t\t\t\t\tblock = this.selection.getBlock();\n\t\t\t\t\t\tthis.block.toggle($(block));\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (block.tagName.toLowerCase() != tag)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(block).prepend('<br>').append('<br>');\n\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(block, tag);\n\n\t\t\t\t\t\t\tthis.block.toggle($formatted);\n\n\t\t\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n\n\t\t\t\t\t\t\tthis.block.formatTableWrapping($formatted);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (tag == 'blockquote' && block.tagName.toLowerCase() == tag)\n\t\t\t\t\t{\n\t\t\t\t\t\t// blockquote off\n\t\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(block).prepend('<br>').append('<br>');\n\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'p');\n\t\t\t\t\t\t\tthis.block.toggle($el);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (block.tagName.toLowerCase() == tag)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.toggle($(block));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\t$(block).removeAttr('class').removeAttr('style');\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tsetMultiple: function(tag)\n\t\t\t\t{\n\t\t\t\t\tvar block = this.block.blocks[0];\n\t\t\t\t\tvar isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\n\n\t\t\t\t\tif (block !== false && this.block.blocksSize === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (block.tagName.toLowerCase() == tag &&  tag == 'blockquote')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// blockquote off\n\t\t\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$(block).prepend('<br>').append('<br>');\n\t\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'p');\n\t\t\t\t\t\t\t\tthis.block.toggle($el);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (block.tagName == 'LI')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (tag != 'blockquote') return;\n\n\t\t\t\t\t\t\tthis.block.formatListToBlockquote();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.block.containerTag == 'BLOCKQUOTE')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.block.formatBlockquote(tag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.opts.linebreaks && ((isContainerTable) || (this.range.commonAncestorContainer != block)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.block.formatWrap(tag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$(block).prepend('<br>').append('<br>');\n\t\t\t\t\t\t\t\tthis.utils.replaceWithContents(block);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (block.tagName === 'TD')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.block.formatWrap(tag);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(block, tag);\n\n\t\t\t\t\t\t\t\tthis.block.toggle($formatted);\n\n\t\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n\t\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\n\t\t\t\t\t\tif (this.opts.linebreaks || tag != 'p')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (tag == 'blockquote')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar count = 0;\n\t\t\t\t\t\t\t\tfor (var i = 0; i < this.block.blocksSize; i++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (this.block.blocks[i].tagName == 'BLOCKQUOTE') count++;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// only blockquote selected\n\t\t\t\t\t\t\t\tif (count == this.block.blocksSize)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$.each(this.block.blocks, $.proxy(function(i,s)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tvar $formatted = false;\n\t\t\t\t\t\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t$(s).prepend('<br>').append('<br>');\n\t\t\t\t\t\t\t\t\t\t\t$formatted = this.utils.replaceWithContents(s);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t$formatted = this.utils.replaceToTag(s, 'p');\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ($formatted && typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t$formatted.removeAttr('class').removeAttr('style');\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tthis.block.formatWrap(tag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar classSize = 0;\n\t\t\t\t\t\t\tvar toggleType = false;\n\t\t\t\t\t\t\tif (this.block.type == 'class')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttoggleType = 'toggle';\n\t\t\t\t\t\t\t\tclassSize = $(this.block.blocks).filter('.' + this.block.value).length;\n\n\t\t\t\t\t\t\t\tif (this.block.blocksSize == classSize) toggleType = 'toggle';\n\t\t\t\t\t\t\t\telse if (this.block.blocksSize > classSize) toggleType = 'set';\n\t\t\t\t\t\t\t\telse if (classSize === 0) toggleType = 'set';\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar exceptTags = ['ul', 'ol', 'li', 'td', 'th', 'dl', 'dt', 'dd'];\n\t\t\t\t\t\t\t$.each(this.block.blocks, $.proxy(function(i,s)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), exceptTags) != -1) return;\n\n\t\t\t\t\t\t\t\tvar $formatted = this.utils.replaceToTag(s, tag);\n\n\t\t\t\t\t\t\t\tif (toggleType)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (toggleType == 'toggle') this.block.toggle($formatted);\n\t\t\t\t\t\t\t\t\telse if (toggleType == 'remove') this.block.remove($formatted);\n\t\t\t\t\t\t\t\t\telse if (toggleType == 'set') this.block.setForce($formatted);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse this.block.toggle($formatted);\n\n\t\t\t\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n\t\t\t\t\t\t\t\tif (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n\t\t\t\t\t\t\t\tif (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n\n\t\t\t\t\t\t\t\tif (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$formatted.removeAttr('class').removeAttr('style');\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t}, this));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetForce: function($el)\n\t\t\t\t{\n\t\t\t\t\t// remove style and class if the specified setting\n\t\t\t\t\tif (this.block.clearStyle)\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.removeAttr('class').removeAttr('style');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.block.type == 'class')\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.addClass(this.block.value);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.block.type == 'attr' || this.block.type == 'data')\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.attr(this.block.value.name, this.block.value.value);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggle: function($el)\n\t\t\t\t{\n\t\t\t\t\t// remove style and class if the specified setting\n\t\t\t\t\tif (this.block.clearStyle)\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.removeAttr('class').removeAttr('style');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.block.type == 'class')\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.toggleClass(this.block.value);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.block.type == 'attr' || this.block.type == 'data')\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($el.attr(this.block.value.name) == this.block.value.value)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$el.removeAttr(this.block.value.name);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$el.attr(this.block.value.name, this.block.value.value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.removeAttr('style class');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremove: function($el)\n\t\t\t\t{\n\t\t\t\t\t$el.removeClass(this.block.value);\n\t\t\t\t},\n\t\t\t\tformatListToBlockquote: function()\n\t\t\t\t{\n\t\t\t\t\tvar block = $(this.block.blocks[0]).closest('ul, ol');\n\n\t\t\t\t\t$(block).find('ul, ol').contents().unwrap();\n\t\t\t\t\t$(block).find('li').append($('<br>')).contents().unwrap();\n\n\t\t\t\t\tvar $el = this.utils.replaceToTag(block, 'blockquote');\n\t\t\t\t\tthis.block.toggle($el);\n\t\t\t\t},\n\t\t\t\tformatBlockquote: function(tag)\n\t\t\t\t{\n\t\t\t\t\tdocument.execCommand('outdent');\n\t\t\t\t\tdocument.execCommand('formatblock', false, tag);\n\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t\tthis.$editor.find('p:empty').remove();\n\n\t\t\t\t\tvar formatted = this.selection.getBlock();\n\n\t\t\t\t\tif (tag != 'p')\n\t\t\t\t\t{\n\t\t\t\t\t\t$(formatted).find('img').remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.toggle($(formatted));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n\n\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.replaceWithContents(formatted);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tformatWrap: function(tag)\n\t\t\t\t{\n\t\t\t\t\tif (this.block.containerTag == 'UL' || this.block.containerTag == 'OL')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tag == 'blockquote')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.block.formatListToBlockquote();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar formatted = this.selection.wrap(tag);\n\t\t\t\t\tif (formatted === false) return;\n\n\t\t\t\t\tvar $formatted = $(formatted);\n\n\t\t\t\t\tthis.block.formatTableWrapping($formatted);\n\n\t\t\t\t\tvar $elements = $formatted.find(this.opts.blockLevelElements.join(',') + ', td, table, thead, tbody, tfoot, th, tr');\n\n\t\t\t\t\tif ((this.opts.linebreaks && tag == 'p') || tag == 'pre' || tag == 'blockquote')\n\t\t\t\t\t{\n\t\t\t\t\t\t$elements.append('<br />');\n\t\t\t\t\t}\n\n\t\t\t\t\t$elements.contents().unwrap();\n\n\t\t\t\t\tif (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n\n\t\t\t\t\t$.each(this.block.blocks, $.proxy(this.utils.removeEmpty, this));\n\n\t\t\t\t\t$formatted.append(this.selection.getMarker(2));\n\n\t\t\t\t\tif (!this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.block.toggle($formatted);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n\t\t\t\t\t$formatted.find('blockquote:empty').remove();\n\n\t\t\t\t\tif (this.block.isRemoveInline)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.removeInlineTags($formatted);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.opts.linebreaks && tag == 'p')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.replaceWithContents($formatted);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tformatTableWrapping: function($formatted)\n\t\t\t\t{\n\t\t\t\t\tif ($formatted.closest('table').length === 0) return;\n\n\t\t\t\t\tif ($formatted.closest('tr').length === 0) $formatted.wrap('<tr>');\n\t\t\t\t\tif ($formatted.closest('td').length === 0 && $formatted.closest('th').length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$formatted.wrap('<td>');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveData: function(name, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).removeAttr('data-' + name);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tsetData: function(name, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).attr('data-' + name, value);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\ttoggleData: function(name, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$.each(blocks, function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($(this).attr('data-' + name))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).removeAttr('data-' + name);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).attr('data-' + name, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveAttr: function(attr, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).removeAttr(attr);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tsetAttr: function(attr, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).attr(attr, value);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\ttoggleAttr: function(attr, value)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$.each(blocks, function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($(this).attr(name))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).removeAttr(name);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).attr(name, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).removeClass(className);\n\n\t\t\t\t\tthis.utils.removeEmptyAttr(blocks, 'class');\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tsetClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).addClass(className);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\ttoggleClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n\t\t\t\t\t$(blocks).toggleClass(className);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tbuffer: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tset: function(type)\n\t\t\t\t{\n\t\t\t\t\tif (typeof type == 'undefined' || type == 'undo')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.buffer.setUndo();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.buffer.setRedo();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetUndo: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tthis.opts.buffer.push(this.$editor.html());\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t},\n\t\t\t\tsetRedo: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tthis.opts.rebuffer.push(this.$editor.html());\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t},\n\t\t\t\tgetUndo: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.html(this.opts.buffer.pop());\n\t\t\t\t},\n\t\t\t\tgetRedo: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.html(this.opts.rebuffer.pop());\n\t\t\t\t},\n\t\t\t\tadd: function()\n\t\t\t\t{\n\t\t\t\t\tthis.opts.buffer.push(this.$editor.html());\n\t\t\t\t},\n\t\t\t\tundo: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.buffer.length === 0) return;\n\n\t\t\t\t\tthis.buffer.set('redo');\n\t\t\t\t\tthis.buffer.getUndo();\n\n\t\t\t\t\tthis.selection.restore();\n\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 50);\n\t\t\t\t},\n\t\t\t\tredo: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.rebuffer.length === 0) return;\n\n\t\t\t\t\tthis.buffer.set('undo');\n\t\t\t\t\tthis.buffer.getRedo();\n\n\t\t\t\t\tthis.selection.restore();\n\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 50);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tbuild: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\trun: function()\n\t\t\t\t{\n\t\t\t\t\tthis.build.createContainerBox();\n\t\t\t\t\tthis.build.loadContent();\n\t\t\t\t\tthis.build.loadEditor();\n\t\t\t\t\tthis.build.enableEditor();\n\t\t\t\t\tthis.build.setCodeAndCall();\n\t\t\t\t},\n\t\t\t\tisTextarea: function()\n\t\t\t\t{\n\t\t\t\t\treturn (this.$element[0].tagName === 'TEXTAREA');\n\t\t\t\t},\n\t\t\t\tcreateContainerBox: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$box = $('<div class=\"redactor-box\" />');\n\t\t\t\t},\n\t\t\t\tcreateTextarea: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$textarea = $('<textarea />').attr('name', this.build.getTextareaName());\n\t\t\t\t},\n\t\t\t\tgetTextareaName: function()\n\t\t\t\t{\n\t\t\t\t\treturn ((typeof(name) == 'undefined')) ? 'content-' + this.uuid : this.$element.attr('id');\n\t\t\t\t},\n\t\t\t\tloadContent: function()\n\t\t\t\t{\n\t\t\t\t\tvar func = (this.build.isTextarea()) ? 'val' : 'html';\n\t\t\t\t\tthis.content = $.trim(this.$element[func]());\n\t\t\t\t},\n\t\t\t\tenableEditor: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.attr({ 'contenteditable': true, 'dir': this.opts.direction });\n\t\t\t\t},\n\t\t\t\tloadEditor: function()\n\t\t\t\t{\n\t\t\t\t\tvar func = (this.build.isTextarea()) ? 'fromTextarea' : 'fromElement';\n\t\t\t\t\tthis.build[func]();\n\t\t\t\t},\n\t\t\t\tfromTextarea: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor = $('<div />');\n\t\t\t\t\tthis.$textarea = this.$element;\n\t\t\t\t\tthis.$box.insertAfter(this.$element).append(this.$editor).append(this.$element);\n\t\t\t\t\tthis.$editor.addClass('redactor-editor');\n\n\t\t\t\t\tthis.$element.hide();\n\t\t\t\t},\n\t\t\t\tfromElement: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor = this.$element;\n\t\t\t\t\tthis.build.createTextarea();\n\t\t\t\t\tthis.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea);\n\t\t\t\t\tthis.$editor.addClass('redactor-editor');\n\n\t\t\t\t\tthis.$textarea.hide();\n\t\t\t\t},\n\t\t\t\tsetCodeAndCall: function()\n\t\t\t\t{\n\t\t\t\t\t// set code\n\t\t\t\t\tthis.code.set(this.content);\n\n\t\t\t\t\tthis.build.setOptions();\n\t\t\t\t\tthis.build.callEditor();\n\n\t\t\t\t\t// code mode\n\t\t\t\t\tif (this.opts.visual) return;\n\t\t\t\t\tsetTimeout($.proxy(this.code.showCode, this), 200);\n\t\t\t\t},\n\t\t\t\tcallEditor: function()\n\t\t\t\t{\n\t\t\t\t\tthis.build.disableMozillaEditing();\n\t\t\t\t\tthis.build.setEvents();\n\t\t\t\t\tthis.build.setHelpers();\n\n\t\t\t\t\t// load toolbar\n\t\t\t\t\tif (this.opts.toolbar)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.opts.toolbar = this.toolbar.init();\n\t\t\t\t\t\tthis.toolbar.build();\n\t\t\t\t\t}\n\n\t\t\t\t\t// modal templates init\n\t\t\t\t\tthis.modal.loadTemplates();\n\n\t\t\t\t\t// plugins\n\t\t\t\t\tthis.build.plugins();\n\n\t\t\t\t\t// observers\n\t\t\t\t\tsetTimeout($.proxy(this.observe.load, this), 4);\n\n\t\t\t\t\t// init callback\n\t\t\t\t\tthis.core.setCallback('init');\n\t\t\t\t},\n\t\t\t\tsetOptions: function()\n\t\t\t\t{\n\t\t\t\t\t// textarea direction\n\t\t\t\t\t$(this.$textarea).attr('dir', this.opts.direction);\n\n\t\t\t\t\tif (this.opts.linebreaks) this.$editor.addClass('redactor-linebreaks');\n\n\t\t\t\t\tif (this.opts.tabindex) this.$editor.attr('tabindex', this.opts.tabindex);\n\n\t\t\t\t\tif (this.opts.minHeight) this.$editor.css('minHeight', this.opts.minHeight);\n\t\t\t\t\tif (this.opts.maxHeight) this.$editor.css('maxHeight', this.opts.maxHeight);\n\n\t\t\t\t},\n\t\t\t\tsetEventDropUpload: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (!this.opts.dragImageUpload || !this.opts.dragFileUpload) return;\n\n\t\t\t\t\tvar files = e.dataTransfer.files;\n\t\t\t\t\tthis.upload.directUpload(files[0], e);\n\t\t\t\t},\n\t\t\t\tsetEventDrop: function(e)\n\t\t\t\t{\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t\tsetTimeout(this.clean.clearUnverified, 1);\n\t\t\t\t\tthis.core.setCallback('drop', e);\n\t\t\t\t},\n\t\t\t\tsetEvents: function()\n\t\t\t\t{\n\t\t\t\t\t// drop\n\t\t\t\t\tthis.$editor.on('drop.redactor', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\te = e.originalEvent || e;\n\n\t\t\t\t\t\tif (window.FormData === undefined || !e.dataTransfer) return true;\n\n\t\t\t\t\t\tif (e.dataTransfer.files.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.build.setEventDrop(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.build.setEventDropUpload(e);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsetTimeout(this.clean.clearUnverified, 1);\n\t\t\t\t\t\tthis.core.setCallback('drop', e);\n\n\t\t\t\t\t}, this));\n\n\n\t\t\t\t\t// click\n\t\t\t\t\tthis.$editor.on('click.redactor', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar event = this.core.getEvent();\n\t\t\t\t\t\tvar type = (event == 'click' || event == 'arrow') ? false : 'click';\n\n\t\t\t\t\t\tthis.core.addEvent(type);\n\t\t\t\t\t\tthis.utils.disableSelectAll();\n\t\t\t\t\t\tthis.core.setCallback('click', e);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\t// paste\n\t\t\t\t\tthis.$editor.on('paste.redactor', $.proxy(this.paste.init, this));\n\n\t\t\t\t\t// keydown\n\t\t\t\t\tthis.$editor.on('keydown.redactor', $.proxy(this.keydown.init, this));\n\n\t\t\t\t\t// keyup\n\t\t\t\t\tthis.$editor.on('keyup.redactor', $.proxy(this.keyup.init, this));\n\n\t\t\t\t\t// textarea keydown\n\t\t\t\t\tif ($.isFunction(this.opts.codeKeydownCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$textarea.on('keydown.redactor-textarea', $.proxy(this.opts.codeKeydownCallback, this));\n\t\t\t\t\t}\n\n\t\t\t\t\t// textarea keyup\n\t\t\t\t\tif ($.isFunction(this.opts.codeKeyupCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$textarea.on('keyup.redactor-textarea', $.proxy(this.opts.codeKeyupCallback, this));\n\t\t\t\t\t}\n\n\t\t\t\t\t// focus\n\t\t\t\t\tif ($.isFunction(this.opts.focusCallback))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.on('focus.redactor', $.proxy(this.opts.focusCallback, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar clickedElement;\n\t\t\t\t\t$(document).on('mousedown', function(e) { clickedElement = e.target; });\n\n\t\t\t\t\t// blur\n\t\t\t\t\tthis.$editor.on('blur.redactor', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.rtePaste) return;\n\t\t\t\t\t\tif (!this.build.isBlured(clickedElement)) return;\n\n\t\t\t\t\t\tthis.utils.disableSelectAll();\n\t\t\t\t\t\tif ($.isFunction(this.opts.blurCallback)) this.core.setCallback('blur', e);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tisBlured: function(clickedElement)\n\t\t\t\t{\n\t\t\t\t\tvar $el = $(clickedElement);\n\n\t\t\t\t\treturn (!$el.hasClass('redactor-toolbar, redactor-dropdown') && !$el.is('#redactor-modal') && $el.parents('.redactor-toolbar, .redactor-dropdown, #redactor-modal').length === 0);\n\t\t\t\t},\n\t\t\t\tsetHelpers: function()\n\t\t\t\t{\n\t\t\t\t\t// autosave\n\t\t\t\t\tthis.autosave.enable();\n\n\t\t\t\t\t// placeholder\n\t\t\t\t\tthis.placeholder.enable();\n\n\t\t\t\t\t// focus\n\t\t\t\t\tif (this.opts.focus) setTimeout(this.focus.setStart, 100);\n\t\t\t\t\tif (this.opts.focusEnd) setTimeout(this.focus.setEnd, 100);\n\n\t\t\t\t},\n\t\t\t\tplugins: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.plugins) return;\n\t\t\t\t\tif (!RedactorPlugins) return;\n\n\t\t\t\t\t$.each(this.opts.plugins, $.proxy(function(i, s)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (typeof RedactorPlugins[s] === 'undefined') return;\n\n\t\t\t\t\t\tif ($.inArray(s, $.Redactor.modules) !== -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$.error('Plugin name \"' + s + '\" matches the name of the Redactor\\'s module.');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!$.isFunction(RedactorPlugins[s])) return;\n\n\t\t\t\t\t\tthis[s] = RedactorPlugins[s]();\n\n\t\t\t\t\t\t// get methods\n\t\t\t\t\t\tvar methods = this.getModuleMethods(this[s]);\n\t\t\t\t\t\tvar len = methods.length;\n\n\t\t\t\t\t\t// bind methods\n\t\t\t\t\t\tfor (var z = 0; z < len; z++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis[s][methods[z]] = this[s][methods[z]].bind(this);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ($.isFunction(this[s].init)) this[s].init();\n\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t},\n\t\t\t\tdisableMozillaEditing: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.browser('mozilla')) return;\n\n\t\t\t\t\t// FF fix\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdocument.execCommand('enableObjectResizing', false, false);\n\t\t\t\t\t\tdocument.execCommand('enableInlineTableEditing', false, false);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tbutton: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tbuild: function(btnName, btnObject)\n\t\t\t\t{\n\t\t\t\t\tvar $button = $('<a href=\"#\" class=\"re-icon re-' + btnName + '\" rel=\"' + btnName + '\" />').attr('tabindex', '-1');\n\n\t\t\t\t\t// click\n\t\t\t\t\tif (btnObject.func || btnObject.command || btnObject.dropdown)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.button.setEvent($button, btnName, btnObject);\n\t\t\t\t\t}\n\n\t\t\t\t\t// dropdown\n\t\t\t\t\tif (btnObject.dropdown)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + btnName + '\" style=\"display: none;\">');\n\t\t\t\t\t\t$button.data('dropdown', $dropdown);\n\t\t\t\t\t\tthis.dropdown.build(btnName, $dropdown, btnObject.dropdown);\n\t\t\t\t\t}\n\n\t\t\t\t\t// tooltip\n\t\t\t\t\tif (this.utils.isDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.button.createTooltip($button, btnName, btnObject.title);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn $button;\n\t\t\t\t},\n\t\t\t\tsetEvent: function($button, btnName, btnObject)\n\t\t\t\t{\n\t\t\t\t\t$button.on('touchstart click', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($button.hasClass('redactor-button-disabled')) return false;\n\n\t\t\t\t\t\tvar type = 'func';\n\t\t\t\t\t\tvar callback = btnObject.func;\n\n\t\t\t\t\t\tif (btnObject.command)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype = 'command';\n\t\t\t\t\t\t\tcallback = btnObject.command;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (btnObject.dropdown)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype = 'dropdown';\n\t\t\t\t\t\t\tcallback = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.button.onClick(e, btnName, type, callback);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tcreateTooltip: function($button, name, title)\n\t\t\t\t{\n\t\t\t\t\tvar $tooltip = $('<span>').addClass('redactor-toolbar-tooltip redactor-toolbar-tooltip-' + name).hide().html(title);\n\t\t\t\t\t$tooltip.appendTo('body');\n\n\t\t\t\t\t$button.on('mouseover', function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($(this).hasClass('redactor-button-disabled')) return;\n\n\t\t\t\t\t\tvar pos = $button.offset();\n\n\t\t\t\t\t\t$tooltip.show();\n\t\t\t\t\t\t$tooltip.css({\n\t\t\t\t\t\t\ttop: (pos.top + $button.innerHeight()) + 'px',\n\t\t\t\t\t\t\tleft: (pos.left + $button.innerWidth()/2 - $tooltip.innerWidth()/2) + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t$button.on('mouseout', function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$tooltip.hide();\n\t\t\t\t\t});\n\n\t\t\t\t},\n\t\t\t\tonClick: function(e, btnName, type, callback)\n\t\t\t\t{\n\t\t\t\t\tthis.button.caretOffset = this.caret.getOffset();\n\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (this.utils.browser('msie')) e.returnValue = false;\n\n\t\t\t\t\tif (type == 'command') this.inline.format(callback);\n\t\t\t\t\telse if (type == 'dropdown') this.dropdown.show(e, btnName);\n\t\t\t\t\telse this.button.onClickCallback(e, callback, btnName);\n\t\t\t\t},\n\t\t\t\tonClickCallback: function(e, callback, btnName)\n\t\t\t\t{\n\t\t\t\t\tvar func;\n\n\t\t\t\t\tif ($.isFunction(callback)) callback.call(this, btnName);\n\t\t\t\t\telse if (callback.search(/\\./) != '-1')\n\t\t\t\t\t{\n\t\t\t\t\t\tfunc = callback.split('.');\n\t\t\t\t\t\tif (typeof this[func[0]] == 'undefined') return;\n\n\t\t\t\t\t\tthis[func[0]][func[1]](btnName);\n\t\t\t\t\t}\n\t\t\t\t\telse this[callback](btnName);\n\n\t\t\t\t\tthis.observe.buttons(e, btnName);\n\t\t\t\t},\n\t\t\t\tget: function(key)\n\t\t\t\t{\n\t\t\t\t\treturn this.$toolbar.find('a.re-' + key);\n\t\t\t\t},\n\t\t\t\tsetActive: function(key)\n\t\t\t\t{\n\t\t\t\t\tthis.button.get(key).addClass('redactor-act');\n\t\t\t\t},\n\t\t\t\tsetInactive: function(key)\n\t\t\t\t{\n\t\t\t\t\tthis.button.get(key).removeClass('redactor-act');\n\t\t\t\t},\n\t\t\t\tsetInactiveAll: function(key)\n\t\t\t\t{\n\t\t\t\t\tif (typeof key === 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$toolbar.find('a.re-icon').removeClass('redactor-act');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('.re-' + key).removeClass('redactor-act');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetActiveInVisual: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('a.re-html').removeClass('redactor-button-disabled');\n\t\t\t\t},\n\t\t\t\tsetInactiveInCode: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$toolbar.find('a.re-icon').not('a.re-html').addClass('redactor-button-disabled');\n\t\t\t\t},\n\t\t\t\tchangeIcon: function(key, classname)\n\t\t\t\t{\n\t\t\t\t\tthis.button.get(key).addClass('re-' + classname);\n\t\t\t\t},\n\t\t\t\tremoveIcon: function(key, classname)\n\t\t\t\t{\n\t\t\t\t\tthis.button.get(key).removeClass('re-' + classname);\n\t\t\t\t},\n\t\t\t\tsetAwesome: function(key, name)\n\t\t\t\t{\n\t\t\t\t\tvar $button = this.button.get(key);\n\t\t\t\t\t$button.removeClass('redactor-btn-image').addClass('fa-redactor-btn');\n\t\t\t\t\t$button.html('<i class=\"fa ' + name + '\"></i>');\n\t\t\t\t},\n\t\t\t\taddCallback: function($btn, callback)\n\t\t\t\t{\n\t\t\t\t\tvar type = (callback == 'dropdown') ? 'dropdown' : 'func';\n\t\t\t\t\tvar key = $btn.attr('rel');\n\t\t\t\t\t$btn.on('touchstart click', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($btn.hasClass('redactor-button-disabled')) return false;\n\t\t\t\t\t\tthis.button.onClick(e, key, type, callback);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\taddDropdown: function($btn, dropdown)\n\t\t\t\t{\n\t\t\t\t\tvar key = $btn.attr('rel');\n\t\t\t\t\tthis.button.addCallback($btn, 'dropdown');\n\n\t\t\t\t\tvar $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + key + '\" style=\"display: none;\">');\n\t\t\t\t\t$btn.data('dropdown', $dropdown);\n\n\t\t\t\t\t// build dropdown\n\t\t\t\t\tif (dropdown) this.dropdown.build(key, $dropdown, dropdown);\n\n\t\t\t\t\treturn $dropdown;\n\t\t\t\t},\n\t\t\t\tadd: function(key, title)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.toolbar) return;\n\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\n\n\t\t\t\t\tthis.$toolbar.append($('<li>').append(btn));\n\n\t\t\t\t\treturn btn;\n\t\t\t\t},\n\t\t\t\taddFirst: function(key, title)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.toolbar) return;\n\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\n\t\t\t\t\tthis.$toolbar.prepend($('<li>').append(btn));\n\n\t\t\t\t\treturn btn;\n\t\t\t\t},\n\t\t\t\taddAfter: function(afterkey, key, title)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.toolbar) return;\n\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\n\t\t\t\t\tvar $btn = this.button.get(afterkey);\n\n\t\t\t\t\tif ($btn.length !== 0) $btn.parent().after($('<li>').append(btn));\n\t\t\t\t\telse this.$toolbar.append($('<li>').append(btn));\n\n\t\t\t\t\treturn btn;\n\t\t\t\t},\n\t\t\t\taddBefore: function(beforekey, key, title)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.toolbar) return;\n\n\t\t\t\t\tvar btn = this.button.build(key, { title: title });\n\t\t\t\t\tbtn.addClass('redactor-btn-image');\n\t\t\t\t\tvar $btn = this.button.get(beforekey);\n\n\t\t\t\t\tif ($btn.length !== 0) $btn.parent().before($('<li>').append(btn));\n\t\t\t\t\telse this.$toolbar.append($('<li>').append(btn));\n\n\t\t\t\t\treturn btn;\n\t\t\t\t},\n\t\t\t\tremove: function(key)\n\t\t\t\t{\n\t\t\t\t\tthis.button.get(key).remove();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcaret: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsetStart: function(node)\n\t\t\t\t{\n\t\t\t\t\t// inline tag\n\t\t\t\t\tif (!this.utils.isBlock(node))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\n\n\t\t\t\t\t\t$(node).prepend(space);\n\t\t\t\t\t\tthis.caret.setEnd(space);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.set(node, 0, node, 0);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetEnd: function(node)\n\t\t\t\t{\n\t\t\t\t\tthis.caret.set(node, 1, node, 1);\n\t\t\t\t},\n\t\t\t\tset: function(orgn, orgo, focn, foco)\n\t\t\t\t{\n\t\t\t\t\t// focus\n\t\t\t\t\t// disabled in 10.0.7\n\t\t\t\t\t// if (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\torgn = orgn[0] || orgn;\n\t\t\t\t\tfocn = focn[0] || focn;\n\n\t\t\t\t\tif (this.utils.isBlockTag(orgn.tagName) && orgn.innerHTML === '')\n\t\t\t\t\t{\n\t\t\t\t\t\torgn.innerHTML = this.opts.invisibleSpace;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (orgn.tagName == 'BR' && this.opts.linebreaks === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar parent = $(this.opts.emptyHtml)[0];\n\t\t\t\t\t\t$(orgn).replaceWith(parent);\n\t\t\t\t\t\torgn = parent;\n\t\t\t\t\t\tfocn = orgn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.setStart(orgn, orgo);\n\t\t\t\t\t\tthis.range.setEnd(focn, foco);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\n\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t},\n\t\t\t\tsetAfter: function(node)\n\t\t\t\t{\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tvar tag = $(node)[0].tagName;\n\n\t\t\t\t\t\t// inline tag\n\t\t\t\t\t\tif (tag != 'BR' && !this.utils.isBlock(node))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\n\n\t\t\t\t\t\t\t$(node).after(space);\n\t\t\t\t\t\t\tthis.caret.setEnd(space);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (tag != 'BR' && this.utils.browser('msie'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.caret.setStart($(node).next());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.caret.setAfterOrBefore(node, 'after');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar space = this.utils.createSpaceElement();\n\t\t\t\t\t\t$(node).after(space);\n\t\t\t\t\t\tthis.caret.setEnd(space);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetBefore: function(node)\n\t\t\t\t{\n\t\t\t\t\t// block tag\n\t\t\t\t\tif (this.utils.isBlock(node))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.setEnd($(node).prev());\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.setAfterOrBefore(node, 'before');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetAfterOrBefore: function(node, type)\n\t\t\t\t{\n\t\t\t\t\t// focus\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\tnode = node[0] || node;\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (type == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\ttry {\n\n\t\t\t\t\t\t\tthis.range.setStartAfter(node);\n\t\t\t\t\t\t\tthis.range.setEndAfter(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e) {}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.range.setStartBefore(node);\n\t\t\t\t\t\t\tthis.range.setEndBefore(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e) {}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tthis.range.collapse(false);\n\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t},\n\t\t\t\tgetOffsetOfElement: function(node)\n\t\t\t\t{\n\t\t\t\t\tnode = node[0] || node;\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tvar cloned = this.range.cloneRange();\n\t\t\t\t\tcloned.selectNodeContents(node);\n\t\t\t\t\tcloned.setEnd(this.range.endContainer, this.range.endOffset);\n\n\t\t\t\t\treturn $.trim(cloned.toString()).length;\n\t\t\t\t},\n\t\t\t\tgetOffset: function()\n\t\t\t\t{\n\t\t\t\t\tvar offset = 0;\n\t\t\t\t    var sel = window.getSelection();\n\n\t\t\t\t    if (sel.rangeCount > 0)\n\t\t\t\t    {\n\t\t\t\t        var range = window.getSelection().getRangeAt(0);\n\t\t\t\t        var caretRange = range.cloneRange();\n\t\t\t\t        caretRange.selectNodeContents(this.$editor[0]);\n\t\t\t\t        caretRange.setEnd(range.endContainer, range.endOffset);\n\t\t\t\t        offset = caretRange.toString().length;\n\t\t\t\t    }\n\n\t\t\t\t\treturn offset;\n\t\t\t\t},\n\t\t\t\tsetOffset: function(start, end)\n\t\t\t\t{\n\t\t\t\t\tif (typeof end == 'undefined') end = start;\n\t\t\t\t\tif (!this.focus.isFocused()) this.focus.setStart();\n\n\t\t\t\t\tvar sel = this.selection.get();\n\t\t\t\t\tvar node, offset = 0;\n\t\t\t\t\tvar walker = document.createTreeWalker(this.$editor[0], NodeFilter.SHOW_TEXT, null, null);\n\n\t\t\t\t\twhile (node = walker.nextNode())\n\t\t\t\t\t{\n\t\t\t\t\t\toffset += node.nodeValue.length;\n\t\t\t\t\t\tif (offset > start)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.range.setStart(node, node.nodeValue.length + start - offset);\n\t\t\t\t\t\t\tstart = Infinity;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (offset >= end)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.range.setEnd(node, node.nodeValue.length + end - offset);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.range.collapse(false);\n\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t},\n\t\t\t\t// deprecated\n\t\t\t\tsetToPoint: function(start, end)\n\t\t\t\t{\n\t\t\t\t\tthis.caret.setOffset(start, end);\n\t\t\t\t},\n\t\t\t\tgetCoords: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.caret.getOffset();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tclean: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tonSet: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = this.clean.savePreCode(html);\n\n\t\t\t\t\t// convert script tag\n\t\t\t\t\thtml = html.replace(/<script(.*?[^>]?)>([\\w\\W]*?)<\\/script>/gi, '<pre class=\"redactor-script-tag\" style=\"display: none;\" $1>$2</pre>');\n\n\t\t\t\t\t// replace dollar sign to entity\n\t\t\t\t\thtml = html.replace(/\\$/g, '&#36;');\n\n\t\t\t\t\t// replace special characters in links\n\t\t\t\t\thtml = html.replace(/<a href=\"(.*?[^>]?)(.*?[^>]?)\">/gi, '<a href=\"$1&reg$2\">');\n\n\t\t\t\t\tif (this.opts.replaceDivs) html = this.clean.replaceDivs(html);\n\t\t\t\t\tif (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\n\n\t\t\t\t\t// save form tag\n\t\t\t\t\thtml = this.clean.saveFormTags(html);\n\n\t\t\t\t\t// convert font tag to span\n\t\t\t\t\tvar $div = $('<div>');\n\t\t\t\t\t$div.html(html);\n\t\t\t\t\tvar fonts = $div.find('font[style]');\n\t\t\t\t\tif (fonts.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tfonts.replaceWith(function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\t\tvar $span = $('<span>').attr('style', $el.attr('style'));\n\t\t\t\t\t\t\treturn $span.append($el.contents());\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\thtml = $div.html();\n\t\t\t\t\t}\n\t\t\t\t\t$div.remove();\n\n\t\t\t\t\t// remove font tag\n\t\t\t\t\thtml = html.replace(/<font(.*?[^<])>/gi, '');\n\t\t\t\t\thtml = html.replace(/<\\/font>/gi, '');\n\n\t\t\t\t\t// tidy html\n\t\t\t\t\thtml = this.tidy.load(html);\n\n\t\t\t\t\t// paragraphize\n\t\t\t\t\tif (this.opts.paragraphize) html = this.paragraphize.load(html);\n\n\t\t\t\t\t// verified\n\t\t\t\t\thtml = this.clean.setVerified(html);\n\n\t\t\t\t\t// convert inline tags\n\t\t\t\t\thtml = this.clean.convertInline(html);\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonSync: function(html)\n\t\t\t\t{\n\t\t\t\t\t// remove spaces\n\t\t\t\t\thtml = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\t\t\t\t\thtml = html.replace(/&#x200b;/gi, '');\n\n\t\t\t\t\tif (this.opts.cleanSpaces)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/&nbsp;/gi, ' ');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (html.search(/^<p>(||\\s||<br\\s?\\/?>||&nbsp;)<\\/p>$/i) != -1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\n\t\t\t\t\t// reconvert script tag\n\t\t\t\t\thtml = html.replace(/<pre class=\"redactor-script-tag\" style=\"display: none;\"(.*?[^>]?)>([\\w\\W]*?)<\\/pre>/gi, '<script$1>$2</script>');\n\n\t\t\t\t\t// restore form tag\n\t\t\t\t\thtml = this.clean.restoreFormTags(html);\n\n\t\t\t\t\tvar chars = {\n\t\t\t\t\t\t'\\u2122': '&trade;',\n\t\t\t\t\t\t'\\u00a9': '&copy;',\n\t\t\t\t\t\t'\\u2026': '&hellip;',\n\t\t\t\t\t\t'\\u2014': '&mdash;',\n\t\t\t\t\t\t'\\u2010': '&dash;'\n\t\t\t\t\t};\n\t\t\t\t\t// replace special characters\n\t\t\t\t\t$.each(chars, function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(new RegExp(i, 'g'), s);\n\t\t\t\t\t});\n\n\t\t\t\t\t// remove br in the of li\n\t\t\t\t\thtml = html.replace(new RegExp('<br\\\\s?/?></li>', 'gi'), '</li>');\n\t\t\t\t\thtml = html.replace(new RegExp('</li><br\\\\s?/?>', 'gi'), '</li>');\n\t\t\t\t\t// remove verified\n\t\t\t\t\thtml = html.replace(new RegExp('<div(.*?[^>]) data-tagblock=\"redactor\"(.*?[^>])>', 'gi'), '<div$1$2>');\n\t\t\t\t\thtml = html.replace(new RegExp('<(.*?) data-verified=\"redactor\"(.*?[^>])>', 'gi'), '<$1$2>');\n\t\t\t\t\thtml = html.replace(new RegExp('<span(.*?[^>])\\srel=\"(.*?[^>])\"(.*?[^>])>', 'gi'), '<span$1$3>');\n\t\t\t\t\thtml = html.replace(new RegExp('<img(.*?[^>])\\srel=\"(.*?[^>])\"(.*?[^>])>', 'gi'), '<img$1$3>');\n\t\t\t\t\thtml = html.replace(new RegExp('<img(.*?[^>])\\sstyle=\"\" (.*?[^>])>', 'gi'), '<img$1 $2>');\n\t\t\t\t\thtml = html.replace(new RegExp('<img(.*?[^>])\\sstyle (.*?[^>])>', 'gi'), '<img$1 $2>');\n\t\t\t\t\thtml = html.replace(new RegExp('<span class=\"redactor-invisible-space\">(.*?)</span>', 'gi'), '$1');\n\t\t\t\t\thtml = html.replace(/ data-save-url=\"(.*?[^>])\"/gi, '');\n\n\t\t\t\t\t// remove image resize\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-box\"(.*?[^>])>([\\w\\W]*?)<img(.*?)><\\/span>/gi, '$3<img$4>');\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-resizer\"(.*?[^>])>(.*?)<\\/span>/gi, '');\n\t\t\t\t\thtml = html.replace(/<span(.*?)id=\"redactor-image-editter\"(.*?[^>])>(.*?)<\\/span>/gi, '');\n\n\t\t\t\t\t// remove font tag\n\t\t\t\t\thtml = html.replace(/<font(.*?[^<])>/gi, '');\n\t\t\t\t\thtml = html.replace(/<\\/font>/gi, '');\n\n\t\t\t\t\t// tidy html\n\t\t\t\t\thtml = this.tidy.load(html);\n\n\t\t\t\t\t// link nofollow\n\t\t\t\t\tif (this.opts.linkNofollow)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/<a(.*?)rel=\"nofollow\"(.*?[^>])>/gi, '<a$1$2>');\n\t\t\t\t\t\thtml = html.replace(/<a(.*?[^>])>/gi, '<a$1 rel=\"nofollow\">');\n\t\t\t\t\t}\n\n\t\t\t\t\t// reconvert inline\n\t\t\t\t\thtml = html.replace(/\\sdata-redactor-(tag|class|style)=\"(.*?[^>])\"/gi, '');\n\t\t\t\t\thtml = html.replace(new RegExp('<(.*?) data-verified=\"redactor\"(.*?[^>])>', 'gi'), '<$1$2>');\n\t\t\t\t\thtml = html.replace(new RegExp('<(.*?) data-verified=\"redactor\">', 'gi'), '<$1>');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPaste: function(html, setMode)\n\t\t\t\t{\n\t\t\t\t\thtml = $.trim(html);\n\n\t\t\t\t\thtml = html.replace(/\\$/g, '&#36;');\n\n\t\t\t\t\t// convert dirty spaces\n\t\t\t\t\thtml = html.replace(/<span class=\"s1\">/gi, '<span>');\n\t\t\t\t\thtml = html.replace(/<span class=\"Apple-converted-space\">&nbsp;<\\/span>/gi, ' ');\n\t\t\t\t\thtml = html.replace(/<span class=\"Apple-tab-span\"[^>]*>\\t<\\/span>/gi, '\\t');\n\t\t\t\t\thtml = html.replace(/<span[^>]*>(\\s|&nbsp;)<\\/span>/gi, ' ');\n\n\t\t\t\t\tif (this.opts.pastePlainText)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.clean.getPlainText(html);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.utils.isSelectAll() && typeof setMode == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['FIGCAPTION', 'A']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.clean.getPlainText(html, false);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent('PRE'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = html.replace(//g, '\"');\n\t\t\t\t\t\t\thtml = html.replace(//g, '\"');\n\t\t\t\t\t\t\thtml = html.replace(//g, '\\'');\n\t\t\t\t\t\t\thtml = html.replace(//g, '\\'');\n\n\t\t\t\t\t\t\treturn this.clean.getPreCode(html);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['BLOCKQUOTE', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = this.clean.getOnlyImages(html);\n\n\t\t\t\t\t\t\tif (!this.utils.browser('msie'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar block = this.selection.getBlock();\n\t\t\t\t\t\t\t\tif (block && block.tagName == 'P')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '<p><img$1></p>');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn html;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['TD']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = this.clean.onPasteTidy(html, 'td');\n\n\t\t\t\t\t\t\tif (this.opts.linebreaks) html = this.clean.replaceParagraphsToBr(html);\n\n\t\t\t\t\t\t\thtml = this.clean.replaceDivsToBr(html);\n\n\t\t\t\t\t\t\treturn html;\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif (this.utils.isCurrentOrParent(['LI']))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.clean.onPasteTidy(html, 'li');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\thtml = this.clean.isSingleLine(html, setMode);\n\n\t\t\t\t\tif (!this.clean.singleLine)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\n\t\t\t\t\t\tif (this.opts.replaceDivs) html = this.clean.replaceDivs(html);\n\n\t\t\t\t\t\thtml = this.clean.saveFormTags(html);\n\t\t\t\t\t}\n\n\n\t\t\t\t\thtml = this.clean.onPasteWord(html);\n\t\t\t\t\thtml = this.clean.onPasteExtra(html);\n\n\t\t\t\t\thtml = this.clean.onPasteTidy(html, 'all');\n\n\n\t\t\t\t\t// paragraphize\n\t\t\t\t\tif (!this.clean.singleLine && this.opts.paragraphize)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = this.paragraphize.load(html);\n\t\t\t\t\t}\n\n\t\t\t\t\thtml = this.clean.removeDirtyStyles(html);\n\t\t\t\t\thtml = this.clean.onPasteRemoveSpans(html);\n\t\t\t\t\thtml = this.clean.onPasteRemoveEmpty(html);\n\n\n\t\t\t\t\thtml = this.clean.convertInline(html);\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPasteWord: function(html)\n\t\t\t\t{\n\t\t\t\t\t// comments\n\t\t\t\t\thtml = html.replace(/<!--[\\s\\S]*?-->/gi, '');\n\n\t\t\t\t\t// style\n\t\t\t\t\thtml = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '');\n\n\t\t\t\t\tif (/(class=\\\"?Mso|style=\\\"[^\\\"]*\\bmso\\-|w:WordDocument)/.test(html))\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = this.clean.onPasteIeFixLinks(html);\n\n\t\t\t\t\t\t// shapes\n\t\t\t\t\t\thtml = html.replace(/<img(.*?)v:shapes=(.*?)>/gi, '');\n\t\t\t\t\t\thtml = html.replace(/src=\"file\\:\\/\\/(.*?)\"/, 'src=\"\"');\n\n\t\t\t\t\t\t// list\n\t\t\t\t\t\thtml = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpFirst\"([\\w\\W]*?)<\\/p>/gi, '<ul><li$2</li>');\n\t\t\t\t\t\thtml = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpMiddle\"([\\w\\W]*?)<\\/p>/gi, '<li$2</li>');\n\t\t\t\t\t\thtml = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpLast\"([\\w\\W]*?)<\\/p>/gi, '<li$2</li></ul>');\n\t\t\t\t\t\t// one line\n\t\t\t\t\t\thtml = html.replace(/<p(.*?)class=\"MsoListParagraph\"([\\w\\W]*?)<\\/p>/gi, '<ul><li$2</li></ul>');\n\t\t\t\t\t\t// remove ms word's bullet\n\t\t\t\t\t\thtml = html.replace(//g, '');\n\t\t\t\t\t\thtml = html.replace(/<p class=\"Mso(.*?)\"/gi, '<p');\n\n\t\t\t\t\t\t// classes\n\t\t\t\t\t\thtml = html.replace(/ class=\\\"(mso[^\\\"]*)\\\"/gi,\t\"\");\n\t\t\t\t\t\thtml = html.replace(/ class=(mso\\w+)/gi, \"\");\n\n\t\t\t\t\t\t// remove ms word tags\n\t\t\t\t\t\thtml = html.replace(/<o:p(.*?)>([\\w\\W]*?)<\\/o:p>/gi, '$2');\n\n\t\t\t\t\t\t// ms word break lines\n\t\t\t\t\t\thtml = html.replace(/\\n/g, ' ');\n\n\t\t\t\t\t\t// ms word lists break lines\n\t\t\t\t\t\thtml = html.replace(/<p>\\n?<li>/gi, '<li>');\n\t\t\t\t\t}\n\n\t\t\t\t\t// remove nbsp\n\t\t\t\t\tif (this.opts.cleanSpaces)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/(\\s|&nbsp;)+/g, ' ');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPasteExtra: function(html)\n\t\t\t\t{\n\t\t\t\t\t// remove google docs markers\n\t\t\t\t\thtml = html.replace(/<b\\sid=\"internal-source-marker(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$2\");\n\t\t\t\t\thtml = html.replace(/<b(.*?)id=\"docs-internal-guid(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$3\");\n\n\t\t\t\t\t// google docs styles\n\t\t\t \t\thtml = html.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi, '<span style=\"font-weight: bold;\"><span style=\"font-style: italic;\">');\n\t\t\t \t\thtml = html.replace(/<span[^>]*font-style: italic[^>]*>/gi, '<span style=\"font-style: italic;\">');\n\t\t\t\t\thtml = html.replace(/<span[^>]*font-weight: bold[^>]*>/gi, '<span style=\"font-weight: bold;\">');\n\t\t\t\t\thtml = html.replace(/<span[^>]*text-decoration: underline[^>]*>/gi, '<span style=\"text-decoration: underline;\">');\n\n\t\t\t\t\thtml = html.replace(/<img>/gi, '');\n\t\t\t\t\thtml = html.replace(/\\n{3,}/gi, '\\n');\n\t\t\t\t\thtml = html.replace(/<font(.*?)>([\\w\\W]*?)<\\/font>/gi, '$2');\n\n\t\t\t\t\t// remove dirty p\n\t\t\t\t\thtml = html.replace(/<p><p>/gi, '<p>');\n\t\t\t\t\thtml = html.replace(/<\\/p><\\/p>/gi, '</p>');\n\t\t\t\t\thtml = html.replace(/<li>(\\s*|\\t*|\\n*)<p>/gi, '<li>');\n\t\t\t\t\thtml = html.replace(/<\\/p>(\\s*|\\t*|\\n*)<\\/li>/gi, '</li>');\n\n\t\t\t\t\t// remove space between paragraphs\n\t\t\t\t\thtml = html.replace(/<\\/p>\\s<p/gi, '<\\/p><p');\n\n\t\t\t\t\t// remove safari local images\n\t\t\t\t\thtml = html.replace(/<img src=\"webkit-fake-url\\:\\/\\/(.*?)\"(.*?)>/gi, '');\n\n\t\t\t\t\t// bullets\n\t\t\t\t\thtml = html.replace(/<p>([\\w\\W]*?)<\\/p>/gi, '<li>$1</li>');\n\n\t\t\t\t\t// FF fix\n\t\t\t\t\tif (this.utils.browser('mozilla'))\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>$/gi, '');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPasteTidy: function(html, type)\n\t\t\t\t{\n\t\t\t\t\t// remove all tags except these\n\t\t\t\t\tvar tags = ['span', 'a', 'pre', 'blockquote', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'address', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\n\t\t\t\t\t\t\t\t'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'p', 'br', 'video', 'audio', 'iframe', 'embed', 'param', 'object', 'img', 'table',\n\t\t\t\t\t\t\t\t'td', 'th', 'tr', 'tbody', 'tfoot', 'thead', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\tvar tagsEmpty = false;\n\t\t\t\t\tvar attrAllowed =  [\n\t\t\t\t\t\t\t['a', '*'],\n\t\t\t\t\t\t\t['img', ['src', 'alt']],\n\t\t\t\t\t\t\t['span', ['class', 'rel', 'data-verified']],\n\t\t\t\t\t\t\t['iframe', '*'],\n\t\t\t\t\t\t\t['video', '*'],\n\t\t\t\t\t\t\t['audio', '*'],\n\t\t\t\t\t\t\t['embed', '*'],\n\t\t\t\t\t\t\t['object', '*'],\n\t\t\t\t\t\t\t['param', '*'],\n\t\t\t\t\t\t\t['source', '*']\n\t\t\t\t\t\t];\n\n\t\t\t\t\tif (type == 'all')\n\t\t\t\t\t{\n\t\t\t\t\t\ttagsEmpty = ['p', 'span', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\t\tattrAllowed =  [\n\t\t\t\t\t\t\t['table', 'class'],\n\t\t\t\t\t\t\t['td', ['colspan', 'rowspan']],\n\t\t\t\t\t\t\t['a', '*'],\n\t\t\t\t\t\t\t['img', ['src', 'alt', 'data-redactor-inserted-image']],\n\t\t\t\t\t\t\t['span', ['class', 'rel', 'data-verified']],\n\t\t\t\t\t\t\t['iframe', '*'],\n\t\t\t\t\t\t\t['video', '*'],\n\t\t\t\t\t\t\t['audio', '*'],\n\t\t\t\t\t\t\t['embed', '*'],\n\t\t\t\t\t\t\t['object', '*'],\n\t\t\t\t\t\t\t['param', '*'],\n\t\t\t\t\t\t\t['source', '*']\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t\telse if (type == 'td')\n\t\t\t\t\t{\n\t\t\t\t\t\t// remove all tags except these and remove all table tags: tr, td etc\n\t\t\t\t\t\ttags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\n\t\t\t\t\t\t\t\t'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'br', 'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\n\t\t\t\t\t}\n\t\t\t\t\telse if (type == 'li')\n\t\t\t\t\t{\n\t\t\t\t\t\t// only inline tags and ul, ol, li\n\t\t\t\t\t\ttags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del', 'br',\n\t\t\t\t\t\t\t\t'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img'];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar options = {\n\t\t\t\t\t\tdeniedTags: false,\n\t\t\t\t\t\tallowedTags: tags,\n\t\t\t\t\t\tremoveComments: true,\n\t\t\t\t\t\tremovePhp: true,\n\t\t\t\t\t\tremoveAttr: false,\n\t\t\t\t\t\tallowedAttr: attrAllowed,\n\t\t\t\t\t\tremoveEmpty: tagsEmpty\n\t\t\t\t\t};\n\n\t\t\t\t\t// denied tags\n\t\t\t\t\tif (this.opts.deniedTags)\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.deniedTags = this.opts.deniedTags;\n\t\t\t\t\t}\n\n\t\t\t\t\t// allowed tags\n\t\t\t\t\tif (this.opts.allowedTags)\n\t\t\t\t\t{\n\t\t\t\t\t\toptions.allowedTags = this.opts.allowedTags;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.tidy.load(html, options);\n\n\t\t\t\t},\n\t\t\t\tonPasteRemoveEmpty: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<(p|h[1-6])>(|\\s|\\n|\\t|<br\\s?\\/?>)<\\/(p|h[1-6])>/gi, '');\n\n\t\t\t\t\t// remove br in the end\n\t\t\t\t\tif (!this.opts.linebreaks) html = html.replace(/<br>$/i, '');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPasteRemoveSpans: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<span>(.*?)<\\/span>/gi, '$1');\n\t\t\t\t\thtml = html.replace(/<span[^>]*>\\s|&nbsp;<\\/span>/gi, ' ');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tonPasteIeFixLinks: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.browser('msie')) return html;\n\n\t\t\t\t\tvar tmp = $.trim(html);\n\t\t\t\t\tif (tmp.search(/^<a(.*?)>(.*?)<\\/a>$/i) === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/^<a(.*?)>(.*?)<\\/a>$/i, \"$2\");\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tisSingleLine: function(html, setMode)\n\t\t\t\t{\n\t\t\t\t\tthis.clean.singleLine = false;\n\n\t\t\t\t\tif (!this.utils.isSelectAll() && typeof setMode == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar blocks = this.opts.blockLevelElements.join('|').replace('P|', '').replace('DIV|', '');\n\n\t\t\t\t\t\tvar matchBlocks = html.match(new RegExp('</(' + blocks + ')>', 'gi'));\n\t\t\t\t\t\tvar matchContainers = html.match(/<\\/(p|div)>/gi);\n\n\t\t\t\t\t\tif (!matchBlocks && (matchContainers === null || (matchContainers && matchContainers.length <= 1)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar matchBR = html.match(/<br\\s?\\/?>/gi);\n\t\t\t\t\t\t\tvar matchIMG = html.match(/<img(.*?[^>])>/gi);\n\t\t\t\t\t\t\tif (!matchBR && !matchIMG)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.clean.singleLine = true;\n\t\t\t\t\t\t\t\thtml = html.replace(/<\\/?(p|div)(.*?)>/gi, '');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tstripTags: function(input, allowed)\n\t\t\t\t{\n\t\t\t\t    allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n\t\t\t\t    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n\n\t\t\t\t    return input.replace(tags, function ($0, $1) {\n\t\t\t\t        return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\n\t\t\t\t    });\n\t\t\t\t},\n\t\t\t\tsavePreCode: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = this.clean.savePreFormatting(html);\n\t\t\t\t\thtml = this.clean.saveCodeFormatting(html);\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tsavePreFormatting: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar pre = html.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/gi);\n\t\t\t\t\tif (pre !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(pre, $.proxy(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar arr = s.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/i);\n\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/<br\\s?\\/?>/g, '\\n');\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/&nbsp;/g, ' ');\n\n\t\t\t\t\t\t\tif (this.opts.preSpaces)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tarr[2] = this.clean.encodeEntities(arr[2]);\n\n\t\t\t\t\t\t\t// $ fix\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\$/g, '&#36;');\n\n\t\t\t\t\t\t\thtml = html.replace(s, '<pre' + arr[1] + '>' + arr[2] + '</pre>');\n\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tsaveCodeFormatting: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar code = html.match(/<code(.*?[^>])>(.*?)<\\/code>/gi);\n\t\t\t\t\tif (code !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(code, $.proxy(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar arr = s.match(/<code(.*?[^>])>(.*?)<\\/code>/i);\n\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/&nbsp;/g, ' ');\n\t\t\t\t\t\t\tarr[2] = this.clean.encodeEntities(arr[2]);\n\n\t\t\t\t\t\t\t// $ fix\n\t\t\t\t\t\t\tarr[2] = arr[2].replace(/\\$/g, '&#36;');\n\n\t\t\t\t\t\t\thtml = html.replace(s, '<code' + arr[1] + '>' + arr[2] + '</code>');\n\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tgetTextFromHtml: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>|<\\/H[1-6]>|<\\/p>|<\\/div>|<\\/li>|<\\/td>/gi, '\\n');\n\n\t\t\t\t\tvar tmp = document.createElement('div');\n\t\t\t\t\ttmp.innerHTML = html;\n\t\t\t\t\thtml = tmp.textContent || tmp.innerText;\n\n\t\t\t\t\treturn $.trim(html);\n\t\t\t\t},\n\t\t\t\tgetPlainText: function(html, paragraphize)\n\t\t\t\t{\n\t\t\t\t\thtml = this.clean.getTextFromHtml(html);\n\t\t\t\t\thtml = html.replace(/\\n/g, '<br />');\n\n\t\t\t\t\tif (this.opts.paragraphize && typeof paragraphize == 'undefined' && !this.utils.browser('mozilla'))\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = this.paragraphize.load(html);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tgetPreCode: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<img(.*?) style=\"(.*?)\"(.*?[^>])>/gi, '<img$1$3>');\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '&lt;img$1&gt;');\n\t\t\t\t\thtml = this.clean.getTextFromHtml(html);\n\n\t\t\t\t\tif (this.opts.preSpaces)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\n\t\t\t\t\t}\n\n\t\t\t\t\thtml = this.clean.encodeEntities(html);\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tgetOnlyImages: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '[img$1]');\n\n\t\t\t\t\t// remove all tags\n\t\t\t\t\thtml = html.replace(/<([Ss]*?)>/gi, '');\n\n\t\t\t\t\thtml = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tgetOnlyLinksAndImages: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<a(.*?)href=\"(.*?)\"(.*?)>([\\w\\W]*?)<\\/a>/gi, '[a href=\"$2\"]$4[/a]');\n\t\t\t\t\thtml = html.replace(/<img(.*?)>/gi, '[img$1]');\n\n\t\t\t\t\t// remove all tags\n\t\t\t\t\thtml = html.replace(/<(.*?)>/gi, '');\n\n\t\t\t\t\thtml = html.replace(/\\[a href=\"(.*?)\"\\]([\\w\\W]*?)\\[\\/a\\]/gi, '<a href=\"$1\">$2</a>');\n\t\t\t\t\thtml = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tencodeEntities: function(str)\n\t\t\t\t{\n\t\t\t\t\tstr = String(str).replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"');\n\t\t\t\t\treturn str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n\t\t\t\t},\n\t\t\t\tremoveDirtyStyles: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.browser('msie')) return html;\n\n\t\t\t\t\tvar div = document.createElement('div');\n\t\t\t\t\tdiv.innerHTML = html;\n\n\t\t\t\t\tthis.clean.clearUnverifiedRemove($(div));\n\n\t\t\t\t\thtml = div.innerHTML;\n\t\t\t\t\t$(div).remove();\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tclearUnverified: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.browser('msie')) return;\n\n\t\t\t\t\tthis.clean.clearUnverifiedRemove(this.$editor);\n\n\t\t\t\t\tvar headers = this.$editor.find('h1, h2, h3, h4, h5, h6');\n\t\t\t\t\theaders.find('span').removeAttr('style');\n\t\t\t\t\theaders.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tclearUnverifiedRemove: function($editor)\n\t\t\t\t{\n\t\t\t\t\t$editor.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\n\t\t\t\t\t$editor.find('span').not('[data-verified=\"redactor\"]').removeAttr('style');\n\n\t\t\t\t\t$editor.find('span[data-verified=\"redactor\"], img[data-verified=\"redactor\"]').each(function(i, s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(s);\n\t\t\t\t\t\t$s.attr('style', $s.attr('rel'));\n\t\t\t\t\t});\n\n\t\t\t\t},\n\t\t\t\tsetVerified: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.browser('msie')) return html;\n\n\t\t\t\t\thtml = html.replace(new RegExp('<img(.*?[^>])>', 'gi'), '<img$1 data-verified=\"redactor\">');\n\t\t\t\t\thtml = html.replace(new RegExp('<span(.*?[^>])>', 'gi'), '<span$1 data-verified=\"redactor\">');\n\n\t\t\t\t\tvar matches = html.match(new RegExp('<(span|img)(.*?)style=\"(.*?)\"(.*?[^>])>', 'gi'));\n\n\t\t\t\t\tif (matches)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar len = matches.length;\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttry {\n\n\t\t\t\t\t\t\t\tvar newTag = matches[i].replace(/style=\"(.*?)\"/i, 'style=\"$1\" rel=\"$1\"');\n\t\t\t\t\t\t\t\thtml = html.replace(matches[i], newTag);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tconvertInline: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar $div = $('<div />').html(html);\n\n\t\t\t\t\tvar tags = this.opts.inlineTags;\n\t\t\t\t\ttags.push('span');\n\n\t\t\t\t\t$div.find(tags.join(',')).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\tvar tag = this.tagName.toLowerCase();\n\t\t\t\t\t\t$el.attr('data-redactor-tag', tag);\n\n\t\t\t\t\t\tif (tag == 'span')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif ($el.attr('style')) $el.attr('data-redactor-style', $el.attr('style'));\n\t\t\t\t\t\t\telse if ($el.attr('class')) $el.attr('data-redactor-class', $el.attr('class'));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t\thtml = $div.html();\n\t\t\t\t\t$div.remove();\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tnormalizeLists: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.find('li').each(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $next = $(s).next();\n\t\t\t\t\t\tif ($next.length !== 0 && ($next[0].tagName == 'UL' || $next[0].tagName == 'OL'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(s).append($next);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveSpaces: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/\\n/g, '');\n\t\t\t\t\thtml = html.replace(/[\\t]*/g, '');\n\t\t\t\t\thtml = html.replace(/\\n\\s*\\n/g, \"\\n\");\n\t\t\t\t\thtml = html.replace(/^[\\s\\n]*/g, ' ');\n\t\t\t\t\thtml = html.replace(/[\\s\\n]*$/g, ' ');\n\t\t\t\t\thtml = html.replace( />\\s{2,}</g, '> <'); // between inline tags can be only one space\n\t\t\t\t\thtml = html.replace(/\\n\\n/g, \"\\n\");\n\t\t\t\t\thtml = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceDivs: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br />');\n\t\t\t\t\t\thtml = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '$2<br />');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '<p$1>$2</p>');\n\t\t\t\t\t}\n\n\t\t\t\t\thtml = html.replace(/<div(.*?[^>])>/gi, '');\n\t\t\t\t\thtml = html.replace(/<\\/div>/gi, '');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceDivsToBr: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<div\\s(.*?)>/gi, '<p>');\n\t\t\t\t\thtml = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br /><br />');\n\t\t\t\t\thtml = html.replace(/<div>([\\w\\W]*?)<\\/div>/gi, '$1<br /><br />');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceParagraphsToBr: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<p\\s(.*?)>/gi, '<p>');\n\t\t\t\t\thtml = html.replace(/<p><br\\s?\\/?><\\/p>/gi, '<br />');\n\t\t\t\t\thtml = html.replace(/<p>([\\w\\W]*?)<\\/p>/gi, '$1<br /><br />');\n\t\t\t\t\thtml = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tsaveFormTags: function(html)\n\t\t\t\t{\n\t\t\t\t\treturn html.replace(/<form(.*?)>([\\w\\W]*?)<\\/form>/gi, '<section$1 rel=\"redactor-form-tag\">$2</section>');\n\t\t\t\t},\n\t\t\t\trestoreFormTags: function(html)\n\t\t\t\t{\n\t\t\t\t\treturn html.replace(/<section(.*?) rel=\"redactor-form-tag\"(.*?)>([\\w\\W]*?)<\\/section>/gi, '<form$1$2>$3</form>');\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcode: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tset: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = $.trim(html.toString());\n\n\t\t\t\t\t// clean\n\t\t\t\t\thtml = this.clean.onSet(html);\n\n\t\t\t\t\tthis.$editor.html(html);\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\tif (html !== '') this.placeholder.remove();\n\n\t\t\t\t\tsetTimeout($.proxy(this.buffer.add, this), 15);\n\t\t\t\t\tif (this.start === false) this.observe.load();\n\n\t\t\t\t},\n\t\t\t\tget: function()\n\t\t\t\t{\n\t\t\t\t\tvar code = this.$textarea.val();\n\n\t\t\t\t\t// indent code\n\t\t\t\t\tcode = this.tabifier.get(code);\n\n\t\t\t\t\treturn code;\n\t\t\t\t},\n\t\t\t\tsync: function()\n\t\t\t\t{\n\t\t\t\t\tsetTimeout($.proxy(this.code.startSync, this), 10);\n\t\t\t\t},\n\t\t\t\tstartSync: function()\n\t\t\t\t{\n\t\t\t\t\tvar html = this.$editor.html();\n\n\t\t\t\t\t// is there a need to synchronize\n\t\t\t\t\tif (this.code.syncCode && this.code.syncCode == html)\n\t\t\t\t\t{\n\t\t\t\t\t\t// do not sync\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// save code\n\t\t\t\t\tthis.code.syncCode = html;\n\n\t\t\t\t\t// before clean callback\n\t\t\t\t\thtml = this.core.setCallback('syncBefore', html);\n\n\t\t\t\t\t// clean\n\t\t\t\t\thtml = this.clean.onSync(html);\n\n\t\t\t\t\t// set code\n\t\t\t\t\tthis.$textarea.val(html);\n\n\t\t\t\t\t// after sync callback\n\t\t\t\t\tthis.core.setCallback('sync', html);\n\n\t\t\t\t\tif (this.start === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.core.setCallback('change', html);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.start = false;\n\n\t\t\t\t\t// autosave on change\n\t\t\t\t\tthis.autosave.onChange();\n\t\t\t\t},\n\t\t\t\ttoggle: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.visual)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.code.showCode();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.code.showVisual();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tshowCode: function()\n\t\t\t\t{\n\t\t\t\t\tthis.code.offset = this.caret.getOffset();\n\t\t\t\t\tvar scroll = $(window).scrollTop();\n\n\t\t\t\t\tvar height = this.$editor.innerHeight();\n\n\t\t\t\t\tthis.$editor.hide();\n\n\t\t\t\t\tvar html = this.$textarea.val();\n\t\t\t\t\tthis.modified = this.clean.removeSpaces(html);\n\n\t\t\t\t\t// indent code\n\t\t\t\t\thtml = this.tabifier.get(html);\n\n\t\t\t\t\tthis.$textarea.val(html).height(height).show().focus();\n\t\t\t\t\tthis.$textarea.on('keydown.redactor-textarea-indenting', this.code.textareaIndenting);\n\n\t\t\t\t\t$(window).scrollTop(scroll);\n\n\t\t\t\t\tif (this.$textarea[0].setSelectionRange)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$textarea[0].setSelectionRange(0, 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$textarea[0].scrollTop = 0;\n\n\t\t\t\t\tthis.opts.visual = false;\n\n\t\t\t\t\tthis.button.setInactiveInCode();\n\t\t\t\t\tthis.button.setActive('html');\n\t\t\t\t\tthis.core.setCallback('source', html);\n\t\t\t\t},\n\t\t\t\tshowVisual: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.visual) return;\n\n\t\t\t\t\tvar html = this.$textarea.hide().val();\n\n\t\t\t\t\tif (this.modified !== this.clean.removeSpaces(html))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.code.set(html);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.show();\n\n\t\t\t\t\tif (!this.utils.isEmpty(html))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.placeholder.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.caret.setOffset(this.code.offset);\n\n\t\t\t\t\tthis.$textarea.off('keydown.redactor-textarea-indenting');\n\n\t\t\t\t\tthis.button.setActiveInVisual();\n\t\t\t\t\tthis.button.setInactive('html');\n\n\t\t\t\t\tthis.observe.load();\n\t\t\t\t\tthis.opts.visual = true;\n\t\t\t\t\tthis.core.setCallback('visual', html);\n\t\t\t\t},\n\t\t\t\ttextareaIndenting: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (e.keyCode !== 9) return true;\n\n\t\t\t\t\tvar $el = this.$textarea;\n\t\t\t\t\tvar start = $el.get(0).selectionStart;\n\t\t\t\t\t$el.val($el.val().substring(0, start) + \"\\t\" + $el.val().substring($el.get(0).selectionEnd));\n\t\t\t\t\t$el.get(0).selectionStart = $el.get(0).selectionEnd = start + 1;\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tcore: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tgetObject: function()\n\t\t\t\t{\n\t\t\t\t\treturn $.extend({}, this);\n\t\t\t\t},\n\t\t\t\tgetEditor: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.$editor;\n\t\t\t\t},\n\t\t\t\tgetBox: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.$box;\n\t\t\t\t},\n\t\t\t\tgetElement: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.$element;\n\t\t\t\t},\n\t\t\t\tgetTextarea: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.$textarea;\n\t\t\t\t},\n\t\t\t\tgetToolbar: function()\n\t\t\t\t{\n\t\t\t\t\treturn (this.$toolbar) ? this.$toolbar : false;\n\t\t\t\t},\n\t\t\t\taddEvent: function(name)\n\t\t\t\t{\n\t\t\t\t\tthis.core.event = name;\n\t\t\t\t},\n\t\t\t\tgetEvent: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.core.event;\n\t\t\t\t},\n\t\t\t\tsetCallback: function(type, e, data)\n\t\t\t\t{\n\t\t\t\t\tvar callback = this.opts[type + 'Callback'];\n\t\t\t\t\tif ($.isFunction(callback))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn (typeof data == 'undefined') ? callback.call(this, e) : callback.call(this, e, data);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn (typeof data == 'undefined') ? e : data;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdestroy: function()\n\t\t\t\t{\n\t\t\t\t\tthis.core.setCallback('destroy');\n\n\t\t\t\t\t// off events and remove data\n\t\t\t\t\tthis.$element.off('.redactor').removeData('redactor');\n\t\t\t\t\tthis.$editor.off('.redactor');\n\n\t\t\t\t\t$(document).off('click.redactor-image-delete.' + this.uuid);\n\t\t\t\t\t$(document).off('click.redactor-image-resize-hide.' + this.uuid);\n\t\t\t\t\t$(document).off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid);\n\t\t\t\t\t$(\"body\").off('scroll.redactor.' + this.uuid);\n\t\t\t\t\t$(this.opts.toolbarFixedTarget).off('scroll.redactor.' + this.uuid);\n\n\t\t\t\t\t// common\n\t\t\t\t\tthis.$editor.removeClass('redactor-editor redactor-linebreaks redactor-placeholder');\n\t\t\t\t\tthis.$editor.removeAttr('contenteditable');\n\n\t\t\t\t\tvar html = this.code.get();\n\n\t\t\t\t\t// dropdowns off\n\t\t\t\t\tthis.$toolbar.find('a').each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\tif ($el.data('dropdown'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$el.data('dropdown').remove();\n\t\t\t\t\t\t\t$el.data('dropdown', {});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\tif (this.build.isTextarea())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$box.after(this.$element);\n\t\t\t\t\t\tthis.$box.remove();\n\t\t\t\t\t\tthis.$element.val(html).show();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$box.after(this.$editor);\n\t\t\t\t\t\tthis.$box.remove();\n\t\t\t\t\t\tthis.$element.html(html).show();\n\t\t\t\t\t}\n\n\t\t\t\t\t// paste box\n\t\t\t\t\tif (this.$pasteBox) this.$pasteBox.remove();\n\n\t\t\t\t\t// modal\n\t\t\t\t\tif (this.$modalBox) this.$modalBox.remove();\n\t\t\t\t\tif (this.$modalOverlay) this.$modalOverlay.remove();\n\n\t\t\t\t\t// buttons tooltip\n\t\t\t\t\t$('.redactor-toolbar-tooltip').remove();\n\n\t\t\t\t\t// autosave\n\t\t\t\t\tclearInterval(this.autosaveInterval);\n\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tdropdown: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tbuild: function(name, $dropdown, dropdownObject)\n\t\t\t\t{\n\t\t\t\t\tif (name == 'formatting' && this.opts.formattingAdd)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(this.opts.formattingAdd, $.proxy(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar name = s.tag;\n\t\t\t\t\t\t\tif (typeof s['class'] != 'undefined')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname = name + '-' + s['class'];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\ts.type = (this.utils.isBlockTag(s.tag)) ? 'block' : 'inline';\n\t\t\t\t\t\t\tvar func = (s.type == 'inline') ? 'inline.formatting' : 'block.formatting';\n\n\t\t\t\t\t\t\tif (this.opts.linebreaks && s.type == 'block' && s.tag == 'p') return;\n\n\t\t\t\t\t\t\tthis.formatting[name] = {\n\t\t\t\t\t\t\t\ttag: s.tag,\n\t\t\t\t\t\t\t\tstyle: s.style,\n\t\t\t\t\t\t\t\t'class': s['class'],\n\t\t\t\t\t\t\t\tattr: s.attr,\n\t\t\t\t\t\t\t\tdata: s.data,\n\t\t\t\t\t\t\t\tclear: s.clear\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tdropdownObject[name] = {\n\t\t\t\t\t\t\t\tfunc: func,\n\t\t\t\t\t\t\t\ttitle: s.title\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(dropdownObject, $.proxy(function(btnName, btnObject)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $item = $('<a href=\"#\" class=\"redactor-dropdown-' + btnName + '\">' + btnObject.title + '</a>');\n\t\t\t\t\t\tif (name == 'formatting') $item.addClass('redactor-formatting-' + btnName);\n\n\t\t\t\t\t\t$item.on('click', $.proxy(function(e)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tvar type = 'func';\n\t\t\t\t\t\t\tvar callback = btnObject.func;\n\t\t\t\t\t\t\tif (btnObject.command)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype = 'command';\n\t\t\t\t\t\t\t\tcallback = btnObject.command;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (btnObject.dropdown)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype = 'dropdown';\n\t\t\t\t\t\t\t\tcallback = btnObject.dropdown;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.button.onClick(e, btnName, type, callback);\n\t\t\t\t\t\t\tthis.dropdown.hideAll();\n\n\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t\t$dropdown.append($item);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tshow: function(e, key)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.visual)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $button = this.button.get(key);\n\n\t\t\t\t\t// Always re-append it to the end of <body> so it always has the highest sub-z-index.\n\t\t\t\t\tvar $dropdown = $button.data('dropdown').appendTo(document.body);\n\n\t\t\t\t\t// ios keyboard hide\n\t\t\t\t\tif (this.utils.isMobile() && !this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($button.hasClass('dropact'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dropdown.hideAll();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dropdown.hideAll();\n\t\t\t\t\t\tthis.core.setCallback('dropdownShow', { dropdown: $dropdown, key: key, button: $button });\n\n\t\t\t\t\t\tthis.button.setActive(key);\n\n\t\t\t\t\t\t$button.addClass('dropact');\n\n\t\t\t\t\t\tvar keyPosition = $button.offset();\n\n\t\t\t\t\t\t// fix right placement\n\t\t\t\t\t\tvar dropdownWidth = $dropdown.width();\n\t\t\t\t\t\tif ((keyPosition.left + dropdownWidth) > $(document).width())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkeyPosition.left = Math.max(0, keyPosition.left - dropdownWidth);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar left = keyPosition.left + 'px';\n\t\t\t\t\t\tif (this.$toolbar.hasClass('toolbar-fixed-box'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\n\t\t\t\t\t\t\tvar position = 'fixed';\n\t\t\t\t\t\t\tif (this.opts.toolbarFixedTarget !== document)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttop = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\n\t\t\t\t\t\t\t\tposition = 'absolute';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$dropdown.css({ position: position, left: left, top: top + 'px' }).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar top = ($button.innerHeight() + keyPosition.top) + 'px';\n\n\t\t\t\t\t\t\t$dropdown.css({ position: 'absolute', left: left, top: top }).show();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.core.setCallback('dropdownShown', { dropdown: $dropdown, key: key, button: $button });\n\t\t\t\t\t}\n\n\t\t\t\t\t$(document).one('click', $.proxy(this.dropdown.hide, this));\n\t\t\t\t\tthis.$editor.one('click', $.proxy(this.dropdown.hide, this));\n\n\t\t\t\t\t// disable scroll whan dropdown scroll\n\t\t\t\t\tvar $body = $(document.body);\n\t\t\t\t\tvar width = $body.width();\n\n\t\t\t\t\t$dropdown.on('mouseover', function() {\n\n\t\t\t\t\t\t$body.addClass('body-redactor-hidden');\n\t\t\t\t\t\t$body.css('margin-right', ($body.width() - width) + 'px');\n\n\t\t\t\t\t });\n\n\t\t\t\t\t$dropdown.on('mouseout', function() {\n\n\t\t\t\t\t\t$body.removeClass('body-redactor-hidden').css('margin-right', 0);\n\n\t\t\t\t\t});\n\n\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t},\n\t\t\t\thideAll: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$toolbar.find('a.dropact').removeClass('redactor-act').removeClass('dropact');\n\n\t\t\t\t\t$(document.body).removeClass('body-redactor-hidden').css('margin-right', 0);\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).hide();\n\t\t\t\t\tthis.core.setCallback('dropdownHide');\n\t\t\t\t},\n\t\t\t\thide: function (e)\n\t\t\t\t{\n\t\t\t\t\tvar $dropdown = $(e.target);\n\t\t\t\t\tif (!$dropdown.hasClass('dropact'))\n\t\t\t\t\t{\n\t\t\t\t\t\t$dropdown.removeClass('dropact');\n\t\t\t\t\t\tthis.dropdown.hideAll();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tfile: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tshow: function()\n\t\t\t\t{\n\t\t\t\t\tthis.modal.load('file', this.lang.get('file'), 700);\n\t\t\t\t\tthis.upload.init('#redactor-modal-file-upload', this.opts.fileUpload, this.file.insert);\n\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tvar text = this.sel.toString();\n\n\t\t\t\t\t$('#redactor-filename').val(text);\n\n\t\t\t\t\tthis.modal.show();\n\t\t\t\t},\n\t\t\t\tinsert: function(json, direct, e)\n\t\t\t\t{\n\t\t\t\t\t// error callback\n\t\t\t\t\tif (typeof json.error != 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.close();\n\t\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\t\tthis.core.setCallback('fileUploadError', json);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar link;\n\t\t\t\t\tif (typeof json == 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\tlink = json;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar text = $('#redactor-filename').val();\n\t\t\t\t\t\tif (typeof text == 'undefined' || text === '') text = json.filename;\n\n\t\t\t\t\t\tlink = '<a href=\"' + json.filelink + '\" id=\"filelink-marker\">' + text + '</a>';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (direct)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.removeMarkers();\n\t\t\t\t\t\tvar marker = this.selection.getMarker();\n\t\t\t\t\t\tthis.insert.nodeToCaretPositionFromPoint(e, marker);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.close();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tthis.insert.htmlWithoutClean(link);\n\n\t\t\t\t\tif (typeof json == 'string') return;\n\n\t\t\t\t\tvar linkmarker = $(this.$editor.find('a#filelink-marker'));\n\t\t\t\t\tif (linkmarker.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tlinkmarker.removeAttr('id').removeAttr('style');\n\t\t\t\t\t}\n\t\t\t\t\telse linkmarker = false;\n\n\t\t\t\t\tthis.core.setCallback('fileUpload', linkmarker, json);\n\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tfocus: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsetStart: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.focus();\n\n\t\t\t\t\tvar first = this.$editor.children().first();\n\n\t\t\t\t\tif (first.length === 0) return;\n\t\t\t\t\tif (first[0].length === 0 || first[0].tagName == 'BR' || first[0].nodeType == 3)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (first[0].tagName == 'UL' || first[0].tagName == 'OL')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar child = first.find('li').first();\n\t\t\t\t\t\tif (!this.utils.isBlock(child) && child.text() === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// empty inline tag in li\n\t\t\t\t\t\t\tthis.caret.setStart(child);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.opts.linebreaks && !this.utils.isBlockTag(first[0].tagName))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.get();\n\t\t\t\t\t\tthis.range.setStart(this.$editor[0], 0);\n\t\t\t\t\t\tthis.range.setEnd(this.$editor[0], 0);\n\t\t\t\t\t\tthis.selection.addRange();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// if node is tag\n\t\t\t\t\tthis.caret.setStart(first);\n\t\t\t\t},\n\t\t\t\tsetEnd: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.browser('mozilla') || this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar last = this.$editor.children().last();\n\n\t\t\t\t\t\tthis.$editor.focus();\n\t\t\t\t\t\tthis.caret.setEnd(last);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.range.selectNodeContents(this.$editor[0]);\n\t\t\t\t\t\t\tthis.range.collapse(false);\n\n\t\t\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tisFocused: function()\n\t\t\t\t{\n\t\t\t\t\tvar focusNode = document.getSelection().focusNode;\n\t\t\t\t\tif (focusNode === null) return false;\n\n\t\t\t\t\tif (this.opts.linebreaks && $(focusNode.parentNode).hasClass('redactor-linebreaks')) return true;\n\t\t\t\t\telse if (!this.utils.isRedactorParent(focusNode.parentNode)) return false;\n\n\t\t\t\t\treturn this.$editor.is(':focus');\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\timage: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tshow: function()\n\t\t\t\t{\n\t\t\t\t\tthis.modal.load('image', this.lang.get('image'), 700);\n\t\t\t\t\tthis.upload.init('#redactor-modal-image-droparea', this.opts.imageUpload, this.image.insert);\n\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tthis.modal.show();\n\n\t\t\t\t},\n\t\t\t\tshowEdit: function($image)\n\t\t\t\t{\n\t\t\t\t\tvar $link = $image.closest('a');\n\n\t\t\t\t\tthis.modal.load('imageEdit', this.lang.get('edit'), 705);\n\n\t\t\t\t\tthis.modal.createCancelButton();\n\t\t\t\t\tthis.image.buttonDelete = this.modal.createDeleteButton(this.lang.get('_delete'));\n\t\t\t\t\tthis.image.buttonSave = this.modal.createActionButton(this.lang.get('save'));\n\n\t\t\t\t\tthis.image.buttonDelete.on('click', $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.image.remove($image);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tthis.image.buttonSave.on('click', $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.image.update($image);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\t$('#redactor-image-title').val($image.attr('alt'));\n\n\t\t\t\t\tif (!this.opts.imageLink) $('.redactor-image-link-option').hide();\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $redactorImageLink = $('#redactor-image-link');\n\n\t\t\t\t\t\t$redactorImageLink.attr('href', $image.attr('src'));\n\t\t\t\t\t\tif ($link.length !== 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$redactorImageLink.val($link.attr('href'));\n\t\t\t\t\t\t\tif ($link.attr('target') == '_blank') $('#redactor-image-link-blank').prop('checked', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.opts.imagePosition) $('.redactor-image-position-option').hide();\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar floatValue = ($image.css('display') == 'block' && $image.css('float') == 'none') ? 'center' : $image.css('float');\n\t\t\t\t\t\t$('#redactor-image-align').val(floatValue);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.modal.show();\n\n\t\t\t\t},\n\t\t\t\tsetFloating: function($image)\n\t\t\t\t{\n\t\t\t\t\tvar floating = $('#redactor-image-align').val();\n\n\t\t\t\t\tvar imageFloat = '';\n\t\t\t\t\tvar imageDisplay = '';\n\t\t\t\t\tvar imageMargin = '';\n\n\t\t\t\t\tswitch (floating)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\timageFloat = 'left';\n\t\t\t\t\t\t\timageMargin = '0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin + ' 0';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\timageFloat = 'right';\n\t\t\t\t\t\t\timageMargin = '0 0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\timageDisplay = 'block';\n\t\t\t\t\t\t\timageMargin = 'auto';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t$image.css({ 'float': imageFloat, display: imageDisplay, margin: imageMargin });\n\t\t\t\t\t$image.attr('rel', $image.attr('style'));\n\t\t\t\t},\n\t\t\t\tupdate: function($image)\n\t\t\t\t{\n\t\t\t\t\tthis.image.hideResize();\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tvar $link = $image.closest('a');\n\n\t\t\t\t\t$image.attr('alt', $('#redactor-image-title').val());\n\n\t\t\t\t\tthis.image.setFloating($image);\n\n\t\t\t\t\t// as link\n\t\t\t\t\tvar link = $.trim($('#redactor-image-link').val());\n\t\t\t\t\tif (link !== '')\n\t\t\t\t\t{\n\t\t\t\t\t\t// test url (add protocol)\n\t\t\t\t\t\tvar pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\n\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\n\t\t\t\t\t\tvar re2 = new RegExp('^' + pattern, 'i');\n\n\t\t\t\t\t\tif (link.search(re) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlink = this.opts.linkProtocol + '://' + link;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar target = ($('#redactor-image-link-blank').prop('checked')) ? true : false;\n\n\t\t\t\t\t\tif ($link.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar a = $('<a href=\"' + link + '\">' + this.utils.getOuterHtml($image) + '</a>');\n\t\t\t\t\t\t\tif (target) a.attr('target', '_blank');\n\n\t\t\t\t\t\t\t$image.replaceWith(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$link.attr('href', link);\n\t\t\t\t\t\t\tif (target)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$link.attr('target', '_blank');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$link.removeAttr('target');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if ($link.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$link.replaceWith(this.utils.getOuterHtml($image));\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.modal.close();\n\t\t\t\t\tthis.observe.images();\n\t\t\t\t\tthis.code.sync();\n\n\n\t\t\t\t},\n\t\t\t\tsetEditable: function($image)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.imageEditable)\n\t\t\t\t\t{\n\t\t\t\t\t\t$image.on('dragstart', $.proxy(this.image.onDrag, this));\n\t\t\t\t\t}\n\n\t\t\t\t\t$image.on('mousedown', $.proxy(this.image.hideResize, this));\n\t\t\t\t\t$image.on('click.redactor touchstart', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.observe.image = $image;\n\n\t\t\t\t\t\tif (this.$editor.find('#redactor-image-box').length !== 0) return false;\n\n\t\t\t\t\t\tthis.image.resizer = this.image.loadEditableControls($image);\n\n\t\t\t\t\t\t$(document).on('click.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));\n\t\t\t\t\t\tthis.$editor.on('click.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));\n\n\t\t\t\t\t\t// resize\n\t\t\t\t\t\tif (!this.opts.imageResizable) return;\n\n\t\t\t\t\t\tthis.image.resizer.on('mousedown.redactor touchstart.redactor', $.proxy(function(e)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.image.setResizable(e, $image);\n\t\t\t\t\t\t}, this));\n\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tsetResizable: function(e, $image)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t    this.image.resizeHandle = {\n\t\t\t\t        x : e.pageX,\n\t\t\t\t        y : e.pageY,\n\t\t\t\t        el : $image,\n\t\t\t\t        ratio: $image.width() / $image.height(),\n\t\t\t\t        h: $image.height()\n\t\t\t\t    };\n\n\t\t\t\t    e = e.originalEvent || e;\n\n\t\t\t\t    if (e.targetTouches)\n\t\t\t\t    {\n\t\t\t\t         this.image.resizeHandle.x = e.targetTouches[0].pageX;\n\t\t\t\t         this.image.resizeHandle.y = e.targetTouches[0].pageY;\n\t\t\t\t    }\n\n\t\t\t\t\tthis.image.startResize();\n\n\n\t\t\t\t},\n\t\t\t\tstartResize: function()\n\t\t\t\t{\n\t\t\t\t\t$(document).on('mousemove.redactor-image-resize touchmove.redactor-image-resize', $.proxy(this.image.moveResize, this));\n\t\t\t\t\t$(document).on('mouseup.redactor-image-resize touchend.redactor-image-resize', $.proxy(this.image.stopResize, this));\n\t\t\t\t},\n\t\t\t\tmoveResize: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\te = e.originalEvent || e;\n\n\t\t\t\t\tvar height = this.image.resizeHandle.h;\n\n\t\t            if (e.targetTouches) height += (e.targetTouches[0].pageY -  this.image.resizeHandle.y);\n\t\t            else height += (e.pageY -  this.image.resizeHandle.y);\n\n\t\t\t\t\tvar width = Math.round(height * this.image.resizeHandle.ratio);\n\n\t\t\t\t\tif (height < 50 || width < 100) return;\n\n\t\t            this.image.resizeHandle.el.width(width);\n\t\t            this.image.resizeHandle.el.height(this.image.resizeHandle.el.width()/this.image.resizeHandle.ratio);\n\n\t\t            this.code.sync();\n\t\t\t\t},\n\t\t\t\tstopResize: function()\n\t\t\t\t{\n\t\t\t\t\tthis.handle = false;\n\t\t\t\t\t$(document).off('.redactor-image-resize');\n\n\t\t\t\t\tthis.image.hideResize();\n\t\t\t\t},\n\t\t\t\tonDrag: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (this.$editor.find('#redactor-image-box').length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.on('drop.redactor-image-inside-drop', $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout($.proxy(this.image.onDrop, this), 1);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tonDrop: function()\n\t\t\t\t{\n\t\t\t\t\tthis.image.fixImageSourceAfterDrop();\n\t\t\t\t\tthis.observe.images();\n\t\t\t\t\tthis.$editor.off('drop.redactor-image-inside-drop');\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tfixImageSourceAfterDrop: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.find('img[data-save-url]').each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\t$el.attr('src', $el.attr('data-save-url'));\n\t\t\t\t\t\t$el.removeAttr('data-save-url');\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\thideResize: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (e && $(e.target).closest('#redactor-image-box').length !== 0) return;\n\t\t\t\t\tif (e && e.target.tagName == 'IMG')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $image = $(e.target);\n\t\t\t\t\t\t$image.attr('data-save-url', $image.attr('src'));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar imageBox = this.$editor.find('#redactor-image-box');\n\t\t\t\t\tif (imageBox.length === 0) return;\n\n\t\t\t\t\tif (this.opts.imageEditable)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.image.editter.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\t$(this.image.resizer).remove();\n\n\t\t\t\t\timageBox.find('img').css({\n\t\t\t\t\t\tmarginTop: imageBox[0].style.marginTop,\n\t\t\t\t\t\tmarginBottom: imageBox[0].style.marginBottom,\n\t\t\t\t\t\tmarginLeft: imageBox[0].style.marginLeft,\n\t\t\t\t\t\tmarginRight: imageBox[0].style.marginRight\n\t\t\t\t\t});\n\n\t\t\t\t\timageBox.css('margin', '');\n\t\t\t\t\timageBox.find('img').css('opacity', '');\n\t\t\t\t\timageBox.replaceWith(function()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn $(this).contents();\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).off('click.redactor-image-resize-hide.' + this.uuid);\n\t\t\t\t\tthis.$editor.off('click.redactor-image-resize-hide.' + this.uuid);\n\n\t\t\t\t\tif (typeof this.image.resizeHandle !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.image.resizeHandle.el.attr('rel', this.image.resizeHandle.el.attr('style'));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\tloadResizableControls: function($image, imageBox)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.imageResizable && !this.utils.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tvar imageResizer = $('<span id=\"redactor-image-resizer\" data-redactor=\"verified\"></span>');\n\n\t\t\t\t\t\tif (!this.utils.isDesktop())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\timageResizer.css({ width: '15px', height: '15px' });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\timageResizer.attr('contenteditable', false);\n\t\t\t\t\t\timageBox.append(imageResizer);\n\t\t\t\t\t\timageBox.append($image);\n\n\t\t\t\t\t\treturn imageResizer;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\timageBox.append($image);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tloadEditableControls: function($image)\n\t\t\t\t{\n\t\t\t\t\tvar imageBox = $('<span id=\"redactor-image-box\" data-redactor=\"verified\">');\n\t\t\t\t\timageBox.css('float', $image.css('float')).attr('contenteditable', false);\n\n\t\t\t\t\tif ($image[0].style.margin != 'auto')\n\t\t\t\t\t{\n\t\t\t\t\t\timageBox.css({\n\t\t\t\t\t\t\tmarginTop: $image[0].style.marginTop,\n\t\t\t\t\t\t\tmarginBottom: $image[0].style.marginBottom,\n\t\t\t\t\t\t\tmarginLeft: $image[0].style.marginLeft,\n\t\t\t\t\t\t\tmarginRight: $image[0].style.marginRight\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$image.css('margin', '');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\timageBox.css({ 'display': 'block', 'margin': 'auto' });\n\t\t\t\t\t}\n\n\t\t\t\t\t$image.css('opacity', '.5').after(imageBox);\n\n\n\t\t\t\t\tif (this.opts.imageEditable)\n\t\t\t\t\t{\n\t\t\t\t\t\t// editter\n\t\t\t\t\t\tthis.image.editter = $('<span id=\"redactor-image-editter\" data-redactor=\"verified\">' + this.lang.get('edit') + '</span>');\n\t\t\t\t\t\tthis.image.editter.attr('contenteditable', false);\n\t\t\t\t\t\tthis.image.editter.on('click', $.proxy(function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.image.showEdit($image);\n\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t\timageBox.append(this.image.editter);\n\n\t\t\t\t\t\t// position correction\n\t\t\t\t\t\tvar editerWidth = this.image.editter.innerWidth();\n\t\t\t\t\t\tthis.image.editter.css('margin-left', '-' + editerWidth/2 + 'px');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.image.loadResizableControls($image, imageBox);\n\n\t\t\t\t},\n\t\t\t\tremove: function(image)\n\t\t\t\t{\n\t\t\t\t\tvar $image = $(image);\n\t\t\t\t\tvar $link = $image.closest('a');\n\t\t\t\t\tvar $figure = $image.closest('figure');\n\t\t\t\t\tvar $parent = $image.parent();\n\t\t\t\t\tif ($('#redactor-image-box').length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$parent = $('#redactor-image-box').parent();\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $next;\n\t\t\t\t\tif ($figure.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$next = $figure.next();\n\t\t\t\t\t\t$figure.remove();\n\t\t\t\t\t}\n\t\t\t\t\telse if ($link.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$parent = $link.parent();\n\t\t\t\t\t\t$link.remove();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$image.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\t$('#redactor-image-box').remove();\n\n\t\t\t\t\tif ($figure.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.setStart($next);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.setStart($parent);\n\t\t\t\t\t}\n\n\t\t\t\t\t// delete callback\n\t\t\t\t\tthis.core.setCallback('imageDelete', $image[0].src, $image);\n\n\t\t\t\t\tthis.modal.close();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tinsert: function(json, direct, e)\n\t\t\t\t{\n\t\t\t\t\t// error callback\n\t\t\t\t\tif (typeof json.error != 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.close();\n\t\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\t\tthis.core.setCallback('imageUploadError', json);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $img;\n\t\t\t\t\tif (typeof json == 'string')\n\t\t\t\t\t{\n\t\t\t\t\t\t$img = $(json).attr('data-redactor-inserted-image', 'true');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$img = $('<img>');\n\t\t\t\t\t\t$img.attr('src', json.filelink).attr('data-redactor-inserted-image', 'true');\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar node = $img;\n\t\t\t\t\tvar isP = this.utils.isCurrentOrParent('P');\n\t\t\t\t\tif (isP)\n\t\t\t\t\t{\n\t\t\t\t\t\t// will replace\n\t\t\t\t\t\tnode = $('<blockquote />').append($img);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (direct)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.removeMarkers();\n\t\t\t\t\t\tvar marker = this.selection.getMarker();\n\t\t\t\t\t\tthis.insert.nodeToCaretPositionFromPoint(e, marker);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.close();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tthis.insert.html(this.utils.getOuterHtml(node), false);\n\n\t\t\t\t\tvar $image = this.$editor.find('img[data-redactor-inserted-image=true]').removeAttr('data-redactor-inserted-image');\n\n\t\t\t\t\tif (isP)\n\t\t\t\t\t{\n\t\t\t\t\t\t$image.parent().contents().unwrap().wrap('<p />');\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\t$image.before('<br>').after('<br>');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof json == 'string') return;\n\n\t\t\t\t\tthis.core.setCallback('imageUpload', $image, json);\n\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tindent: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tincrease: function()\n\t\t\t\t{\n\t\t\t\t\t// focus\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tvar block = this.selection.getBlock();\n\n\t\t\t\t\tif (block && block.tagName == 'LI')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.indent.increaseLists();\n\t\t\t\t\t}\n\t\t\t\t\telse if (block === false && this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.indent.increaseText();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.indent.increaseBlocks();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tincreaseLists: function()\n\t\t\t\t{\n\t\t\t\t\tdocument.execCommand('indent');\n\n\t\t\t\t\tthis.indent.fixEmptyIndent();\n\t\t\t\t\tthis.clean.normalizeLists();\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t},\n\t\t\t\tincreaseBlocks: function()\n\t\t\t\t{\n\t\t\t\t\t$.each(this.selection.getBlocks(), $.proxy(function(i, elem)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (elem.tagName === 'TD' || elem.tagName === 'TH') return;\n\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(elem);\n\n\t\t\t\t\t\tvar left = this.utils.normalize($el.css('margin-left')) + this.opts.indentValue;\n\t\t\t\t\t\t$el.css('margin-left', left + 'px');\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tincreaseText: function()\n\t\t\t\t{\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\n\t\t\t\t\t$(wrapper).attr('data-tagblock', 'redactor');\n\t\t\t\t\t$(wrapper).css('margin-left', this.opts.indentValue + 'px');\n\t\t\t\t},\n\t\t\t\tdecrease: function()\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tvar block = this.selection.getBlock();\n\t\t\t\t\tif (block && block.tagName == 'LI')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.indent.decreaseLists();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.indent.decreaseBlocks();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tdecreaseLists: function ()\n\t\t\t\t{\n\t\t\t\t\tdocument.execCommand('outdent');\n\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\n\t\t\t\t\tvar $item = $(current).closest('li');\n\t\t\t\t\tvar $parent = $item.parent();\n\t\t\t\t\tif ($item.length !== 0 && $parent.length !== 0 && $parent[0].tagName == 'LI')\n\t\t\t\t\t{\n\t\t\t\t\t\t$parent.after($item);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.indent.fixEmptyIndent();\n\n\t\t\t\t\tif (!this.opts.linebreaks && $item.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, 'p');\n\t\t\t\t\t\tthis.$editor.find('ul, ol, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t},\n\t\t\t\tdecreaseBlocks: function()\n\t\t\t\t{\n\t\t\t\t\t$.each(this.selection.getBlocks(), $.proxy(function(i, elem)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = this.utils.getAlignmentElement(elem);\n\t\t\t\t\t\tvar left = this.utils.normalize($el.css('margin-left')) - this.opts.indentValue;\n\n\t\t\t\t\t\tif (left <= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.opts.linebreaks && typeof($el.data('tagblock')) !== 'undefined')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$el.replaceWith($el.html() + '<br />');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$el.css('margin-left', '');\n\t\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$el.css('margin-left', left + 'px');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tfixEmptyIndent: function()\n\t\t\t\t{\n\t\t\t\t\tvar block = this.selection.getBlock();\n\n\t\t\t\t\tif (this.range.collapsed && block && block.tagName == 'LI' && this.utils.isEmpty($(block).text()))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $block = $(block);\n\t\t\t\t\t\t$block.find('span').not('.redactor-selection-marker').contents().unwrap();\n\t\t\t\t\t\t$block.append('<br>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tinline: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tformatting: function(name)\n\t\t\t\t{\n\t\t\t\t\tvar type, value;\n\n\t\t\t\t\tif (typeof this.formatting[name].style != 'undefined') type = 'style';\n\t\t\t\t\telse if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\n\n\t\t\t\t\tif (type) value = this.formatting[name][type];\n\n\t\t\t\t\tthis.inline.format(this.formatting[name].tag, type, value);\n\n\t\t\t\t},\n\t\t\t\tformat: function(tag, type, value)\n\t\t\t\t{\n\t\t\t\t\t// Stop formatting pre and headers\n\t\t\t\t\tif (this.utils.isCurrentOrParent('PRE') || this.utils.isCurrentOrParentHeader()) return;\n\n\t\t\t\t\tvar tags = ['b', 'bold', 'i', 'italic', 'underline', 'strikethrough', 'deleted', 'superscript', 'subscript'];\n\t\t\t\t\tvar replaced = ['strong', 'strong', 'em', 'em', 'u', 'del', 'del', 'sup', 'sub'];\n\n\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tag == tags[i]) tag = replaced[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.inline.type = type || false;\n\t\t\t\t\tthis.inline.value = value || false;\n\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tif (!this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.range.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inline.formatCollapsed(tag);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.inline.formatMultiple(tag);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tformatCollapsed: function(tag)\n\t\t\t\t{\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\t\t\t\t\tvar $parent = $(current).closest(tag + '[data-redactor-tag=' + tag + ']');\n\n\t\t\t\t\t// inline there is\n\t\t\t\t\tif ($parent.length !== 0 && (this.inline.type != 'style' && $parent[0].tagName != 'SPAN'))\n\t\t\t\t\t{\n\t\t\t\t\t\t// remove empty\n\t\t\t\t\t\tif (this.utils.isEmpty($parent.text()))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.caret.setAfter($parent[0]);\n\n\t\t\t\t\t\t\t$parent.remove();\n\t\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.utils.isEndOfElement($parent))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.caret.setAfter($parent[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// create empty inline\n\t\t\t\t\tvar node = $('<' + tag + '>').attr('data-verified', 'redactor').attr('data-redactor-tag', tag);\n\t\t\t\t\tnode.html(this.opts.invisibleSpace);\n\n\t\t\t\t\tnode = this.inline.setFormat(node);\n\n\t\t\t\t\tvar node = this.insert.node(node);\n\t\t\t\t\tthis.caret.setEnd(node);\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tformatMultiple: function(tag)\n\t\t\t\t{\n\t\t\t\t\tthis.inline.formatConvert(tag);\n\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tdocument.execCommand('strikethrough');\n\n\t\t\t\t\tthis.$editor.find('strike').each($.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(s);\n\n\t\t\t\t\t\tthis.inline.formatRemoveSameChildren($el, tag);\n\n\t\t\t\t\t\tvar $span;\n\t\t\t\t\t\tif (this.inline.type)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$span = $('<span>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\n\t\t\t\t\t\t\t$span = this.inline.setFormat($span);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$span = $('<' + tag + '>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$el.replaceWith($span.html($el.contents()));\n\n\t\t\t\t\t\tif (tag == 'span')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $parent = $span.parent();\n\t\t\t\t\t\t\tif ($parent && $parent[0].tagName == 'SPAN' && this.inline.type == 'style')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar arr = this.inline.value.split(';');\n\n\t\t\t\t\t\t\t\tfor (var z = 0; z < arr.length; z++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (arr[z] === '') return;\n\t\t\t\t\t\t\t\t\tvar style = arr[z].split(':');\n\t\t\t\t\t\t\t\t\t$parent.css(style[0], '');\n\n\t\t\t\t\t\t\t\t\tif (this.utils.removeEmptyAttr($parent, 'style'))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t$parent.replaceWith($parent.contents());\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\t// clear text decoration\n\t\t\t\t\tif (tag != 'span')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.find(this.opts.inlineTags.join(', ')).each($.proxy(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $el = $(s);\n\t\t\t\t\t\t\tvar property = $el.css('text-decoration');\n\t\t\t\t\t\t\tif (property == 'line-through')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$el.css('text-decoration', '');\n\t\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($el, 'style');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tag != 'del')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar _this = this;\n\t\t\t\t\t\tthis.$editor.find('inline').each(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t_this.utils.replaceToTag(s, 'del');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\tformatRemoveSameChildren: function($el, tag)\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\t$el.children(tag).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $child = $(this);\n\n\t\t\t\t\t\tif (!$child.hasClass('redactor-selection-marker'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (self.inline.type == 'style')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar arr = self.inline.value.split(';');\n\n\t\t\t\t\t\t\t\tfor (var z = 0; z < arr.length; z++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (arr[z] === '') return;\n\n\t\t\t\t\t\t\t\t\tvar style = arr[z].split(':');\n\t\t\t\t\t\t\t\t\t$child.css(style[0], '');\n\n\t\t\t\t\t\t\t\t\tif (self.utils.removeEmptyAttr($child , 'style'))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t$child.replaceWith($child.contents());\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$child.contents().unwrap();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tformatConvert: function(tag)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tvar find = '';\n\t\t\t\t\tif (this.inline.type == 'class') find = '[data-redactor-class=' + this.inline.value + ']';\n\t\t\t\t\telse if (this.inline.type == 'style')\n\t\t\t\t\t{\n\t\t\t\t\t\tfind = '[data-redactor-style=\"' + this.inline.value + '\"]';\n\t\t\t\t\t}\n\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tif (tag != 'del')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.find('del').each(function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tself.utils.replaceToTag(s, 'inline');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tag != 'span')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.find(tag).each(function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\t\t$el.replaceWith($('<strike />').html($el.contents()));\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.find('[data-redactor-tag=\"' + tag + '\"]' + find).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find === '' && tag == 'span' && this.tagName.toLowerCase() == tag) return;\n\n\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\t$el.replaceWith($('<strike />').html($el.contents()));\n\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t},\n\t\t\t\tsetFormat: function(node)\n\t\t\t\t{\n\t\t\t\t\tswitch (this.inline.type)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase 'class':\n\n\t\t\t\t\t\t\tif (node.hasClass(this.inline.value))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnode.removeClass(this.inline.value);\n\t\t\t\t\t\t\t\tnode.removeAttr('data-redactor-class');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnode.addClass(this.inline.value);\n\t\t\t\t\t\t\t\tnode.attr('data-redactor-class', this.inline.value);\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'style':\n\n\t\t\t\t\t\t\tnode[0].style.cssText = this.inline.value;\n\t\t\t\t\t\t\tnode.attr('data-redactor-style', this.inline.value);\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\t\t\t\t},\n\t\t\t\tremoveStyle: function()\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\t\t\t\t\tvar nodes = this.selection.getInlines();\n\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tif (current && current.tagName === 'SPAN')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(current);\n\n\t\t\t\t\t\t$s.removeAttr('style');\n\t\t\t\t\t\tif ($s[0].attributes.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(s);\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$s.removeAttr('style');\n\t\t\t\t\t\t\tif ($s[0].attributes.length === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$s.replaceWith($s.contents());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\tremoveStyleRule: function(name)\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tvar parent = this.selection.getParent();\n\t\t\t\t\tvar nodes = this.selection.getInlines();\n\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tif (parent && parent.tagName === 'SPAN')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(parent);\n\n\t\t\t\t\t\t$s.css(name, '');\n\t\t\t\t\t\tthis.utils.removeEmptyAttr($s, 'style');\n\t\t\t\t\t\tif ($s[0].attributes.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(s);\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$s.css(name, '');\n\t\t\t\t\t\t\tthis.utils.removeEmptyAttr($s, 'style');\n\t\t\t\t\t\t\tif ($s[0].attributes.length === 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$s.replaceWith($s.contents());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tremoveFormat: function()\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tdocument.execCommand('removeFormat');\n\n\t\t\t\t\tif (current && current.tagName === 'SPAN')\n\t\t\t\t\t{\n\t\t\t\t\t\t$(current).replaceWith($(current).contents());\n\t\t\t\t\t}\n\n\n\t\t\t\t\t$.each(this.selection.getNodes(), $.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $s = $(s);\n\t\t\t\t\t\tif ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$s.replaceWith($s.contents());\n\t\t\t\t\t\t}\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\ttoggleClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tthis.inline.format('span', 'class', className);\n\t\t\t\t},\n\t\t\t\ttoggleStyle: function(value)\n\t\t\t\t{\n\t\t\t\t\tthis.inline.format('span', 'style', value);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tinsert: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tset: function(html, clean)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholder.remove();\n\n\t\t\t\t\thtml = this.clean.setVerified(html);\n\n\t\t\t\t\tif (typeof clean == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = this.clean.onPaste(html, false);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$editor.html(html);\n\t\t\t\t\tthis.selection.remove();\n\t\t\t\t\tthis.focus.setEnd();\n\t\t\t\t\tthis.clean.normalizeLists();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t\tthis.observe.load();\n\n\t\t\t\t\tif (typeof clean == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout($.proxy(this.clean.clearUnverified, this), 10);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttext: function(text)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholder.remove();\n\n\t\t\t\t\ttext = text.toString();\n\t\t\t\t\ttext = $.trim(text);\n\t\t\t\t\ttext = this.clean.getPlainText(text, false);\n\n\t\t\t\t\tthis.$editor.focus();\n\n\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insert.htmlIe(text);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\t\tel.innerHTML = text;\n\t\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\n\t\t\t\t\t\twhile ((node = el.firstChild))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.range.insertNode(frag);\n\n\t\t\t\t\t\tif (lastNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar range = this.range.cloneRange();\n\t\t\t\t\t\t\trange.setStartAfter(lastNode);\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\tthis.sel.removeAllRanges();\n\t\t\t\t\t\t\tthis.sel.addRange(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t},\n\t\t\t\thtmlWithoutClean: function(html)\n\t\t\t\t{\n\t\t\t\t\tthis.insert.html(html, false);\n\t\t\t\t},\n\t\t\t\thtml: function(html, clean)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholder.remove();\n\n\t\t\t\t\tif (typeof clean == 'undefined') clean = true;\n\n\t\t\t\t\tthis.$editor.focus();\n\n\t\t\t\t\thtml = this.clean.setVerified(html);\n\n\t\t\t\t\tif (clean)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = this.clean.onPaste(html);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insert.htmlIe(html);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.clean.singleLine) this.insert.execHtml(html);\n\t\t\t\t\t\telse document.execCommand('insertHTML', false, html);\n\n\t\t\t\t\t\tthis.insert.htmlFixMozilla();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.clean.normalizeLists();\n\n\t\t\t\t\t// remove empty paragraphs finaly\n\t\t\t\t\tif (!this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.find('p').each($.proxy(this.utils.removeEmpty, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t\tthis.observe.load();\n\n\t\t\t\t\tif (clean)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\thtmlFixMozilla: function()\n\t\t\t\t{\n\t\t\t\t\t// FF inserts empty p when content was selected dblclick\n\t\t\t\t\tif (!this.utils.browser('mozilla')) return;\n\n\t\t\t\t\tvar $next = $(this.selection.getBlock()).next();\n\t\t\t\t\tif ($next.length > 0 && $next[0].tagName == 'P' && $next.html() === '')\n\t\t\t\t\t{\n\t\t\t\t\t\t$next.remove();\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\thtmlIe: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.isIe11())\n\t\t\t\t\t{\n\t\t\t\t\t\tvar parent = this.utils.isCurrentOrParent('P');\n\t\t\t\t\t\tvar $html = $('<div>').append(html);\n\t\t\t\t\t\tvar blocksMatch = $html.contents().is('p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article');\n\n\t\t\t\t\t\tif (parent && blocksMatch) this.insert.ie11FixInserting(parent, html);\n\t\t\t\t\t\telse this.insert.ie11PasteFrag(html);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdocument.selection.createRange().pasteHTML(html);\n\n\t\t\t\t},\n\t\t\t\texecHtml: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = this.clean.setVerified(html);\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tthis.range.deleteContents();\n\n\t\t\t\t\tvar el = document.createElement('div');\n\t\t\t\t\tel.innerHTML = html;\n\n\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\n\t\t\t\t\twhile ((node = el.firstChild))\n\t\t\t\t\t{\n\t\t\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.range.insertNode(frag);\n\n\t\t\t\t\tthis.range.collapse(true);\n\t\t\t\t\tthis.caret.setAfter(lastNode);\n\n\t\t\t\t},\n\t\t\t\tnode: function(node, deleteContents)\n\t\t\t\t{\n\t\t\t\t\tnode = node[0] || node;\n\n\t\t\t\t\tvar html = this.utils.getOuterHtml(node);\n\t\t\t\t\thtml = this.clean.setVerified(html);\n\n\t\t\t\t\tif (html.match(/</g) !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode = $(html)[0];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (deleteContents !== false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.range.insertNode(node);\n\t\t\t\t\tthis.range.collapse(false);\n\t\t\t\t\tthis.selection.addRange();\n\n\t\t\t\t\treturn node;\n\t\t\t\t},\n\t\t\t\tnodeToPoint: function(node, x, y)\n\t\t\t\t{\n\t\t\t\t\tnode = node[0] || node;\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tvar range;\n\t\t\t\t\tif (document.caretPositionFromPoint)\n\t\t\t\t\t{\n\t\t\t\t\t    var pos = document.caretPositionFromPoint(x, y);\n\n\t\t\t\t\t    this.range.setStart(pos.offsetNode, pos.offset);\n\t\t\t\t\t    this.range.collapse(true);\n\t\t\t\t\t    this.range.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\telse if (document.caretRangeFromPoint)\n\t\t\t\t\t{\n\t\t\t\t\t    range = document.caretRangeFromPoint(x, y);\n\t\t\t\t\t    range.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof document.body.createTextRange != \"undefined\")\n\t\t\t\t\t{\n\t\t\t\t        range = document.body.createTextRange();\n\t\t\t\t        range.moveToPoint(x, y);\n\t\t\t\t        var endRange = range.duplicate();\n\t\t\t\t        endRange.moveToPoint(x, y);\n\t\t\t\t        range.setEndPoint(\"EndToEnd\", endRange);\n\t\t\t\t        range.select();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnodeToCaretPositionFromPoint: function(e, node)\n\t\t\t\t{\n\t\t\t\t\tnode = node[0] || node;\n\n\t\t\t\t\tvar range;\n\t\t\t\t\tvar x = e.clientX, y = e.clientY;\n\t\t\t\t\tif (document.caretPositionFromPoint)\n\t\t\t\t\t{\n\t\t\t\t\t    var pos = document.caretPositionFromPoint(x, y);\n\t\t\t\t\t    var sel = document.getSelection();\n\t\t\t\t\t    range = sel.getRangeAt(0);\n\t\t\t\t\t    range.setStart(pos.offsetNode, pos.offset);\n\t\t\t\t\t    range.collapse(true);\n\t\t\t\t\t    range.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\telse if (document.caretRangeFromPoint)\n\t\t\t\t\t{\n\t\t\t\t\t    range = document.caretRangeFromPoint(x, y);\n\t\t\t\t\t    range.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof document.body.createTextRange != \"undefined\")\n\t\t\t\t\t{\n\t\t\t\t        range = document.body.createTextRange();\n\t\t\t\t        range.moveToPoint(x, y);\n\t\t\t\t        var endRange = range.duplicate();\n\t\t\t\t        endRange.moveToPoint(x, y);\n\t\t\t\t        range.setEndPoint(\"EndToEnd\", endRange);\n\t\t\t\t        range.select();\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tie11FixInserting: function(parent, html)\n\t\t\t\t{\n\t\t\t\t\tvar node = document.createElement('span');\n\t\t\t\t\tnode.className = 'redactor-ie-paste';\n\t\t\t\t\tthis.insert.node(node);\n\n\t\t\t\t\tvar parHtml = $(parent).html();\n\n\t\t\t\t\tparHtml = '<p>' + parHtml.replace(/<span class=\"redactor-ie-paste\"><\\/span>/gi, '</p>' + html + '<p>') + '</p>';\n\t\t\t\t\t$(parent).replaceWith(parHtml);\n\t\t\t\t},\n\t\t\t\tie11PasteFrag: function(html)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tthis.range.deleteContents();\n\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.innerHTML = html;\n\n\t\t\t\t\tvar frag = document.createDocumentFragment(), node, lastNode;\n\t\t\t\t\twhile ((node = el.firstChild))\n\t\t\t\t\t{\n\t\t\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.range.insertNode(frag);\n\t\t\t\t\tthis.range.collapse(false);\n\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tkeydown: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (this.rtePaste) return;\n\n\t\t\t\t\tvar key = e.which;\n\t\t\t\t\tvar arrow = (key >= 37 && key <= 40);\n\n\t\t\t\t\tthis.keydown.ctrl = e.ctrlKey || e.metaKey;\n\t\t\t\t\tthis.keydown.current = this.selection.getCurrent();\n\t\t\t\t\tthis.keydown.parent = this.selection.getParent();\n\t\t\t\t\tthis.keydown.block = this.selection.getBlock();\n\n\t\t\t        // detect tags\n\t\t\t\t\tthis.keydown.pre = this.utils.isTag(this.keydown.current, 'pre');\n\t\t\t\t\tthis.keydown.blockquote = this.utils.isTag(this.keydown.current, 'blockquote');\n\t\t\t\t\tthis.keydown.figcaption = this.utils.isTag(this.keydown.current, 'figcaption');\n\n\t\t\t\t\t// shortcuts setup\n\t\t\t\t\tthis.shortcuts.init(e, key);\n\n\t\t\t\t\tthis.keydown.checkEvents(arrow, key);\n\t\t\t\t\tthis.keydown.setupBuffer(e, key);\n\t\t\t\t\tthis.keydown.addArrowsEvent(arrow);\n\t\t\t\t\tthis.keydown.setupSelectAll(e, key);\n\n\t\t\t\t\t// callback\n\t\t\t\t\tvar keydownStop = this.core.setCallback('keydown', e);\n\t\t\t\t\tif (keydownStop === false)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// ie and ff exit from table\n\t\t\t\t\tif (this.opts.enterKey && (this.utils.browser('msie') || this.utils.browser('mozilla')) && (key === this.keyCode.DOWN || key === this.keyCode.RIGHT))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar isEndOfTable = false;\n\t\t\t\t\t\tvar $table = false;\n\t\t\t\t\t\tif (this.keydown.block && this.keydown.block.tagName === 'TD')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$table = $(this.keydown.block).closest('table');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ($table && $table.find('td').last()[0] === this.keydown.block)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisEndOfTable = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.utils.isEndOfElement() && isEndOfTable)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\n\t\t\t\t\t\t\t$table.after(node);\n\t\t\t\t\t\t\tthis.caret.setStart(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// down\n\t\t\t\t\tif (this.opts.enterKey && key === this.keyCode.DOWN)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.keydown.onArrowDown();\n\t\t\t\t\t}\n\n\t\t\t\t\t// turn off enter key\n\t\t\t\t\tif (!this.opts.enterKey && key === this.keyCode.ENTER)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t// remove selected\n\t\t\t\t\t\tif (!this.range.collapsed) this.range.deleteContents();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// on enter\n\t\t\t\t\tif (key == this.keyCode.ENTER && !e.shiftKey && !e.ctrlKey && !e.metaKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar stop = this.core.setCallback('enter', e);\n\t\t\t\t\t\tif (stop === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.keydown.blockquote && this.keydown.exitFromBlockquote(e) === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar current, $next;\n\t\t\t\t\t\tif (this.keydown.pre)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.keydown.insertNewLine(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.keydown.blockquote || this.keydown.figcaption)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\n\t\t\t\t\t\t\t$next = $(current).next();\n\n\t\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName == 'BR')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (this.utils.isEndOfElement() && (current && current != 'SPAN'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.opts.linebreaks && !this.keydown.block)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\n\t\t\t\t\t\t\t$next = $(this.keydown.current).next();\n\n\n\n\t\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName == 'BR')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (current !== false && $(current).hasClass('redactor-invisible-space'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.caret.setAfter(current);\n\t\t\t\t\t\t\t\t$(current).contents().unwrap();\n\n\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (this.utils.isEndOfEditor())\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if ($next.length === 0 && current === false && typeof $next.context != 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.opts.linebreaks && this.keydown.block)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsetTimeout($.proxy(this.keydown.replaceDivToBreakLine, this), 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// paragraphs\n\t\t\t\t\t\telse if (!this.opts.linebreaks && this.keydown.block)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.keydown.block.tagName !== 'LI')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tsetTimeout($.proxy(this.keydown.replaceDivToParagraph, this), 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcurrent = this.selection.getCurrent();\n\t\t\t\t\t\t\t\tvar $parent = $(current).closest('li');\n\t\t\t\t\t\t\t\tvar $list = $parent.closest('ul,ol');\n\n\t\t\t\t\t\t\t\tif ($parent.length !== 0 && this.utils.isEmpty($parent.html()) && $list.next().length === 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\n\t\t\t\t\t\t\t\t\t$list.after(node);\n\t\t\t\t\t\t\t\t\tthis.caret.setStart(node);\n\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (!this.opts.linebreaks && !this.keydown.block)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn this.keydown.insertParagraph(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Shift+Enter or Ctrl+Enter\n\t\t\t\t\tif (key === this.keyCode.ENTER && (e.ctrlKey || e.shiftKey))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.keydown.onShiftEnter(e);\n\t\t\t\t\t}\n\n\n\t\t\t\t\t// tab or cmd + [\n\t\t\t\t\tif (key === this.keyCode.TAB || e.metaKey && key === 221 || e.metaKey && key === 219)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.keydown.onTab(e, key);\n\t\t\t\t\t}\n\n\t\t\t\t\t// image delete and backspace\n\t\t\t\t\tif (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.utils.browser('mozilla') && this.keydown.current && this.keydown.current.tagName === 'TD')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar nodes = this.selection.getNodes();\n\t\t\t\t\t\tif (nodes)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar len = nodes.length;\n\t\t\t\t\t\t\tvar last;\n\t\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar children = $(nodes[i]).children('img');\n\t\t\t\t\t\t\t\tif (children.length !== 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar self = this;\n\t\t\t\t\t\t\t\t\t$.each(children, function(z,s)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tvar $s = $(s);\n\t\t\t\t\t\t\t\t\t\tif ($s.css('float') != 'none') return;\n\n\t\t\t\t\t\t\t\t\t\t// image delete callback\n\t\t\t\t\t\t\t\t\t\tself.core.setCallback('imageDelete', s.src, $s);\n\t\t\t\t\t\t\t\t\t\tlast = s;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (nodes[i].tagName == 'IMG')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tif (last != nodes[i])\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t// image delete callback\n\t\t\t\t\t\t\t\t\t\tthis.core.setCallback('imageDelete', nodes[i].src, $(nodes[i]));\n\t\t\t\t\t\t\t\t\t\tlast = nodes[i];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// backspace\n\t\t\t\t\tif (key === this.keyCode.BACKSPACE)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.keydown.removeInvisibleSpace();\n\t\t\t\t\t\tthis.keydown.removeEmptyListInTable(e);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tcheckEvents: function(arrow, key)\n\t\t\t\t{\n\t\t\t\t\tif (!arrow && (this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.core.addEvent(false);\n\n\t\t\t\t\t\tif (this.keydown.checkKeyEvents(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcheckKeyEvents: function(key)\n\t\t\t\t{\n\t\t\t\t\tvar k = this.keyCode;\n\t\t\t\t\tvar keys = [k.BACKSPACE, k.DELETE, k.ENTER, k.SPACE, k.ESC, k.TAB, k.CTRL, k.META, k.ALT, k.SHIFT];\n\n\t\t\t\t\treturn ($.inArray(key, keys) == -1) ? true : false;\n\n\t\t\t\t},\n\t\t\t\taddArrowsEvent: function(arrow)\n\t\t\t\t{\n\t\t\t\t\tif (!arrow) return;\n\n\t\t\t\t\tif ((this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.core.addEvent(false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t    this.core.addEvent('arrow');\n\t\t\t\t},\n\t\t\t\tsetupBuffer: function(e, key)\n\t\t\t\t{\n\t\t\t\t\tif (this.keydown.ctrl && key === 90 && !e.shiftKey && !e.altKey && this.opts.buffer.length) // z key\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.buffer.undo();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// undo\n\t\t\t\t\telse if (this.keydown.ctrl && key === 90 && e.shiftKey && !e.altKey && this.opts.rebuffer.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.buffer.redo();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (!this.keydown.ctrl)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (key == this.keyCode.BACKSPACE || key == this.keyCode.DELETE || (key == this.keyCode.ENTER && !e.ctrlKey && !e.shiftKey) || key == this.keyCode.SPACE)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetupSelectAll: function(e, key)\n\t\t\t\t{\n\t\t\t\t\tif (this.keydown.ctrl && key === 65)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.enableSelectAll();\n\t\t\t\t\t}\n\t\t\t\t\telse if (key != this.keyCode.LEFT_WIN && !this.keydown.ctrl)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.disableSelectAll();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonArrowDown: function()\n\t\t\t\t{\n\t\t\t\t\tvar tags = [this.keydown.blockquote, this.keydown.pre, this.keydown.figcaption];\n\n\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tags[i])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.keydown.insertAfterLastElement(tags[i]);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonShiftEnter: function(e)\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tif (this.utils.isEndOfElement())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.keydown.insertDblBreakLine(e);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.keydown.insertBreakLine(e);\n\t\t\t\t},\n\t\t\t\tonTab: function(e, key)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.tabKey) return true;\n\t\t\t\t\tif (this.utils.isEmpty(this.code.get()) && this.opts.tabAsSpaces === false) return true;\n\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tvar node;\n\t\t\t\t\tif (this.keydown.pre && !e.shiftKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode = (this.opts.preSpaces) ? document.createTextNode(Array(this.opts.preSpaces + 1).join('\\u00a0')) : document.createTextNode('\\t');\n\t\t\t\t\t\tthis.insert.node(node);\n\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.opts.tabAsSpaces !== false)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode = document.createTextNode(Array(this.opts.tabAsSpaces + 1).join('\\u00a0'));\n\t\t\t\t\t\tthis.insert.node(node);\n\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (e.metaKey && key === 219) this.indent.decrease();\n\t\t\t\t\t\telse if (e.metaKey && key === 221) this.indent.increase();\n\t\t\t\t\t\telse if (!e.shiftKey) this.indent.increase();\n\t\t\t\t\t\telse this.indent.decrease();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\treplaceDivToBreakLine: function()\n\t\t\t\t{\n\t\t\t\t\tvar blockElem = this.selection.getBlock();\n\t\t\t\t\tvar blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\n\t\t\t\t\tif ((blockElem.tagName === 'DIV' || blockElem.tagName === 'P') && blockHtml === '' && !$(blockElem).hasClass('redactor-editor'))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar br = document.createElement('br');\n\n\t\t\t\t\t\t$(blockElem).replaceWith(br);\n\t\t\t\t\t\tthis.caret.setBefore(br);\n\n\t\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\treplaceDivToParagraph: function()\n\t\t\t\t{\n\t\t\t\t\tvar blockElem = this.selection.getBlock();\n\t\t\t\t\tvar blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\n\t\t\t\t\tif (blockElem.tagName === 'DIV' && blockHtml === '' && !$(blockElem).hasClass('redactor-editor'))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar p = document.createElement('p');\n\t\t\t\t\t\tp.innerHTML = this.opts.invisibleSpace;\n\n\t\t\t\t\t\t$(blockElem).replaceWith(p);\n\t\t\t\t\t\tthis.caret.setStart(p);\n\n\t\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.opts.cleanStyleOnEnter && blockElem.tagName == 'P')\n\t\t\t\t\t{\n\t\t\t\t\t\t$(blockElem).removeAttr('class').removeAttr('style');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinsertParagraph: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tvar p = document.createElement('p');\n\t\t\t\t\tp.innerHTML = this.opts.invisibleSpace;\n\n\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\tthis.range.insertNode(p);\n\n\t\t\t\t\tthis.caret.setStart(p);\n\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\texitFromBlockquote: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.isEndOfElement()) return;\n\n\t\t\t\t\tvar tmp = $.trim($(this.keydown.block).html());\n\t\t\t\t\tif (tmp.search(/(<br\\s?\\/?>){2}$/i) != -1)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar br = document.createElement('br');\n\t\t\t\t\t\t\t$(this.keydown.blockquote).after(br);\n\n\t\t\t\t\t\t\tthis.caret.setBefore(br);\n\t\t\t\t\t\t\t$(this.keydown.block).html(tmp.replace(/<br\\s?\\/?>$/i, ''));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\n\t\t\t\t\t\t\t$(this.keydown.blockquote).after(node);\n\t\t\t\t\t\t\tthis.caret.setStart(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\n\t\t\t\t},\n\t\t\t\tinsertAfterLastElement: function(element)\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.isEndOfElement()) return;\n\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar contents = $('<div>').append($.trim(this.$editor.html())).contents();\n\t\t\t\t\t\tvar last = contents.last()[0];\n\t\t\t\t\t\tif (last.tagName == 'SPAN' && last.innerHTML === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlast = contents.prev()[0];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.utils.getOuterHtml(last) != this.utils.getOuterHtml(element)) return;\n\n\t\t\t\t\t\tvar br = document.createElement('br');\n\t\t\t\t\t\t$(element).after(br);\n\t\t\t\t\t\tthis.caret.setAfter(br);\n\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.$editor.contents().last()[0] !== element) return;\n\n\t\t\t\t\t\tvar node = $(this.opts.emptyHtml);\n\t\t\t\t\t\t$(element).after(node);\n\t\t\t\t\t\tthis.caret.setStart(node);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinsertNewLine: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tvar node = document.createTextNode('\\n');\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\tthis.range.insertNode(node);\n\n\t\t\t\t\tthis.caret.setAfter(node);\n\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tinsertBreakLine: function(e)\n\t\t\t\t{\n\t\t\t\t\treturn this.keydown.insertBreakLineProcessing(e);\n\t\t\t\t},\n\t\t\t\tinsertDblBreakLine: function(e)\n\t\t\t\t{\n\t\t\t\t\treturn this.keydown.insertBreakLineProcessing(e, true);\n\t\t\t\t},\n\t\t\t\tinsertBreakLineProcessing: function(e, dbl)\n\t\t\t\t{\n\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tvar br1 = document.createElement('br');\n\n\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.collapse(false);\n\t\t\t\t\t\tthis.range.setEnd(this.range.endContainer, this.range.endOffset);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.range.insertNode(br1);\n\n\t\t\t\t\tif (dbl === true)\n\t\t\t\t\t{\n\n\t\t\t\t\t\tvar $next = $(br1).next();\n\t\t\t\t\t\tif ($next.length !== 0 && $next[0].tagName === 'BR' && this.utils.isEndOfEditor())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.caret.setAfter(br1);\n\t\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar br2 = document.createElement('br');\n\t\t\t\t\t\tthis.range.insertNode(br2);\n\t\t\t\t\t\tthis.caret.setAfter(br2);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.keydown.insertBreakLineProcessingAfter(br1);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tinsertBreakLineProcessingAfter: function(node)\n\t\t\t\t{\n\t\t\t\t\tvar space = this.utils.createSpaceElement();\n\t\t\t\t\t$(node).after(space);\n\t\t\t\t\tthis.selection.selectElement(space);\n\n\t\t\t\t\t$(space).replaceWith(function()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn $(this).contents();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveInvisibleSpace: function()\n\t\t\t\t{\n\t\t\t\t\tvar $current = $(this.keydown.current);\n\t\t\t\t\tif ($current.text().search(/^\\u200B$/g) === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$current.remove();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveEmptyListInTable: function(e)\n\t\t\t\t{\n\t\t\t\t\tvar $current = $(this.keydown.current);\n\t\t\t\t\tvar $parent = $(this.keydown.parent);\n\t\t\t\t\tvar td = $current.closest('td');\n\n\t\t\t\t\tif (td.length !== 0 && $current.closest('li') && $parent.children('li').length === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!this.utils.isEmpty($current.text())) return;\n\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$current.remove();\n\t\t\t\t\t\t$parent.remove();\n\n\t\t\t\t\t\tthis.caret.setStart(td);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tkeyup: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (this.rtePaste) return;\n\n\t\t\t\t\tvar key = e.which;\n\n\t\t\t\t\tthis.keyup.current = this.selection.getCurrent();\n\t\t\t\t\tthis.keyup.parent = this.selection.getParent();\n\t\t\t\t\tvar $parent = this.utils.isRedactorParent($(this.keyup.parent).parent());\n\n\t\t\t\t\t// callback\n\t\t\t\t\tvar keyupStop = this.core.setCallback('keyup', e);\n\t\t\t\t\tif (keyupStop === false)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// replace to p before / after the table or body\n\t\t\t\t\tif (!this.opts.linebreaks && this.keyup.current.nodeType == 3 && this.keyup.current.length <= 1 && (this.keyup.parent === false || this.keyup.parent.tagName == 'BODY'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.keyup.replaceToParagraph();\n\t\t\t\t\t}\n\n\t\t\t\t\t// replace div after lists\n\t\t\t\t\tif (!this.opts.linebreaks && this.utils.isRedactorParent(this.keyup.current) && this.keyup.current.tagName === 'DIV')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.keyup.replaceToParagraph(false);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif (!this.opts.linebreaks && $(this.keyup.parent).hasClass('redactor-invisible-space') && ($parent === false || $parent[0].tagName == 'BODY'))\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this.keyup.parent).contents().unwrap();\n\t\t\t\t\t\tthis.keyup.replaceToParagraph();\n\t\t\t\t\t}\n\n\t\t\t\t\t// linkify\n\t\t\t\t\tif (this.keyup.isLinkify(key))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.formatLinkify(this.opts.linkProtocol, this.opts.convertLinks, this.opts.convertUrlLinks, this.opts.convertImageLinks, this.opts.convertVideoLinks, this.opts.linkSize);\n\n\t\t\t\t\t\tthis.observe.load();\n\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === this.keyCode.DELETE || key === this.keyCode.BACKSPACE)\n\t\t\t\t\t{\n\t\t\t\t\t\t// clear unverified\n\t\t\t\t\t\tthis.clean.clearUnverified();\n\n\t\t\t\t\t\tif (this.observe.image)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tthis.image.hideResize();\n\n\t\t\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\t\t\tthis.image.remove(this.observe.image);\n\t\t\t\t\t\t\tthis.observe.image = false;\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// remove empty paragraphs\n\t\t\t\t\t\tthis.$editor.find('p').each($.proxy(this.utils.removeEmpty, this));\n\n\t\t\t\t\t\t// remove invisible space\n\t\t\t\t\t\tif (this.opts.linebreaks && this.keyup.current && this.keyup.current.tagName == 'DIV' && this.utils.isEmpty(this.keyup.current.innerHTML))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this.keyup.current).after(this.selection.getMarkerAsHtml());\n\t\t\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\t\t\t$(this.keyup.current).remove();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// if empty\n\t\t\t\t\t\treturn this.keyup.formatEmpty(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisLinkify: function(key)\n\t\t\t\t{\n\t\t\t\t\treturn this.opts.convertLinks && (this.opts.convertUrlLinks || this.opts.convertImageLinks || this.opts.convertVideoLinks) && key === this.keyCode.ENTER && !this.utils.isCurrentOrParent('PRE');\n\t\t\t\t},\n\t\t\t\treplaceToParagraph: function(clone)\n\t\t\t\t{\n\t\t\t\t\tvar $current = $(this.keyup.current);\n\n\t\t\t\t\tvar node;\n\t\t\t\t\tif (clone === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode = $('<p>').append($current.html());\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnode = $('<p>').append($current.clone());\n\t\t\t\t\t}\n\n\t\t\t\t\t$current.replaceWith(node);\n\t\t\t\t\tvar next = $(node).next();\n\t\t\t\t\tif (typeof(next[0]) !== 'undefined' && next[0].tagName == 'BR')\n\t\t\t\t\t{\n\t\t\t\t\t\tnext.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.caret.setEnd(node);\n\t\t\t\t},\n\t\t\t\tformatEmpty: function(e)\n\t\t\t\t{\n\t\t\t\t\tvar html = $.trim(this.$editor.html());\n\n\t\t\t\t\tif (!this.utils.isEmpty(html)) return;\n\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.html(this.selection.getMarkerAsHtml());\n\t\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = '<p><br /></p>';\n\n\t\t\t\t\t\tthis.$editor.html(html);\n\t\t\t\t\t\tthis.focus.setStart();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tlang: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tload: function()\n\t\t\t\t{\n\t\t\t\t\tthis.opts.curLang = this.opts.langs[this.opts.lang];\n\t\t\t\t},\n\t\t\t\tget: function(name)\n\t\t\t\t{\n\t\t\t\t\treturn (typeof this.opts.curLang[name] != 'undefined') ? this.opts.curLang[name] : '';\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tline: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinsert: function()\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tvar blocks = this.selection.getBlocks();\n \t\t\t\t\tif (blocks[0] !== false && this.line.isExceptLastOrFirst(blocks))\n\t \t\t\t\t{\n\t \t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\t \t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.line.insertInIe();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.line.insertInOthersBrowsers();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisExceptLastOrFirst: function(blocks)\n\t\t\t\t{\n\t\t\t\t\tvar exceptTags = ['li', 'td', 'th', 'blockquote', 'figcaption', 'pre', 'dl', 'dt', 'dd'];\n\n\t\t\t\t\tvar first = blocks[0].tagName.toLowerCase();\n\t\t\t\t\tvar last = this.selection.getLastBlock();\n\n\t\t\t\t\tlast = (typeof last == 'undefined') ? first : last.tagName.toLowerCase();\n\n\t\t\t\t\tvar firstFound = $.inArray(first, exceptTags) != -1;\n\t\t\t\t\tvar lastFound = $.inArray(last, exceptTags) != -1;\n\n\t\t\t\t\tif ((firstFound && lastFound) || firstFound)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinsertInIe: function()\n\t\t\t\t{\n\t\t\t\t\tthis.utils.saveScroll();\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tthis.insert.node(document.createElement('hr'));\n\n\t\t\t\t\tthis.utils.restoreScroll();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tinsertInOthersBrowsers: function()\n\t\t\t\t{\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tvar extra = '<p id=\"redactor-insert-line\"><br /></p>';\n\t\t\t\t\tif (this.opts.linebreaks) extra = '<br id=\"redactor-insert-line\">';\n\n\t\t\t\t\tdocument.execCommand('insertHTML', false, '<hr>' + extra);\n\n\t\t\t\t\tthis.line.setFocus();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tsetFocus: function()\n\t\t\t\t{\n\t\t\t\t\tvar node = this.$editor.find('#redactor-insert-line');\n\t\t\t\t\tvar next = $(node).next()[0];\n\n\t\t\t\t\tif (next)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.setAfter(node);\n\t\t\t\t\t\tnode.remove();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.removeAttr('id');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tlink: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tshow: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (typeof e != 'undefined' && e.preventDefault) e.preventDefault();\n\n\t\t\t\t\tthis.modal.load('link', this.lang.get('link_insert'), 600);\n\n\t\t\t\t\tthis.modal.createCancelButton();\n\t\t\t\t\tthis.link.buttonInsert = this.modal.createActionButton(this.lang.get('insert'));\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tthis.link.getData();\n\t\t\t\t\tthis.link.cleanUrl();\n\n\t\t\t\t\tif (this.link.target == '_blank') $('#redactor-link-blank').prop('checked', true);\n\n\t\t\t\t\tthis.link.$inputUrl = $('#redactor-link-url');\n\t\t\t\t\tthis.link.$inputText = $('#redactor-link-url-text');\n\n\t\t\t\t\tthis.link.$inputText.val(this.link.text);\n\t\t\t\t\tthis.link.$inputUrl.val(this.link.url);\n\n\t\t\t\t\tthis.link.buttonInsert.on('click', $.proxy(this.link.insert, this));\n\n\t\t\t\t\t// hide link's tooltip\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\n\n\t\t\t\t\t// show modal\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tthis.modal.show();\n\t\t\t\t\tthis.link.$inputUrl.focus();\n\t\t\t\t},\n\t\t\t\tcleanUrl: function()\n\t\t\t\t{\n\t\t\t\t\tvar thref = self.location.href.replace(/\\/$/i, '');\n\t\t\t\t\tthis.link.url = this.link.url.replace(thref, '');\n\t\t\t\t\tthis.link.url = this.link.url.replace(/^\\/#/, '#');\n\t\t\t\t\tthis.link.url = this.link.url.replace('mailto:', '');\n\n\t\t\t\t\t// remove host from href\n\t\t\t\t\tif (!this.opts.linkProtocol)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + self.location.host, 'i');\n\t\t\t\t\t\tthis.link.url = this.link.url.replace(re, '');\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tgetData: function()\n\t\t\t\t{\n\t\t\t\t\tthis.link.$node = false;\n\n\t\t\t\t\tvar $el = $(this.selection.getCurrent()).closest('a');\n\t\t\t\t\tif ($el.length !== 0 && $el[0].tagName === 'A')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.link.$node = $el;\n\n\t\t\t\t\t\tthis.link.url = $el.attr('href');\n\t\t\t\t\t\tthis.link.text = $el.text();\n\t\t\t\t\t\tthis.link.target = $el.attr('target');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.link.text = this.sel.toString();\n\t\t\t\t\t\tthis.link.url = '';\n\t\t\t\t\t\tthis.link.target = '';\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tinsert: function()\n\t\t\t\t{\n\t\t\t\t\tvar target = '';\n\t\t\t\t\tvar link = this.link.$inputUrl.val();\n\t\t\t\t\tvar text = this.link.$inputText.val();\n\n\t\t\t\t\tif ($.trim(link) === '')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.link.$inputUrl.addClass('redactor-input-error').on('keyup', function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).removeClass('redactor-input-error');\n\t\t\t\t\t\t\t$(this).off('keyup');\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// mailto\n\t\t\t\t\tif (link.search('@') != -1 && /(http|ftp|https):\\/\\//i.test(link) === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tlink = 'mailto:' + link;\n\t\t\t\t\t}\n\t\t\t\t\t// url, not anchor\n\t\t\t\t\telse if (link.search('#') !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($('#redactor-link-blank').prop('checked'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget = '_blank';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// test url (add protocol)\n\t\t\t\t\t\tvar pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\n\t\t\t\t\t\tvar re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\n\t\t\t\t\t\tvar re2 = new RegExp('^' + pattern, 'i');\n\t\t\t\t\t\tvar re3 = new RegExp('\\.(html|php)$', 'i');\n\t\t\t\t\t\tif (link.search(re) == -1 && link.search(re3) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlink = this.opts.linkProtocol + '://' + link;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.link.set(text, link, target);\n\t\t\t\t\tthis.modal.close();\n\t\t\t\t},\n\t\t\t\tset: function(text, link, target)\n\t\t\t\t{\n\t\t\t\t\ttext = $.trim(text.replace(/<|>/g, ''));\n\n\t\t\t\t\tthis.selection.restore();\n\n\t\t\t\t\tif (text === '' && link === '') return;\n\t\t\t\t\tif (text === '' && link !== '') text = link;\n\n\t\t\t\t\tif (this.link.$node)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\t\tthis.link.$node.text(text).attr('href', link);\n\t\t\t\t\t\tif (target !== '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.link.$node.attr('target', target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.link.$node.removeAttr('target');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.utils.browser('mozilla') && this.link.text === '')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $a = $('<a />').attr('href', link).text(text);\n\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\n\n\t\t\t\t\t\t\tthis.insert.node($a);\n\t\t\t\t\t\t\tthis.selection.selectElement($a);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $a;\n\t\t\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$a = $('<a href=\"' + link + '\">').text(text);\n\t\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\n\n\t\t\t\t\t\t\t\t$a = $(this.insert.node($a));\n\t\t\t\t\t\t\t\tthis.selection.selectElement($a);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.execCommand('createLink', false, link);\n\n\t\t\t\t\t\t\t\t$a = $(this.selection.getCurrent()).closest('a');\n\t\t\t\t\t\t\t\tif (this.utils.browser('mozilla'))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t$a = $('a[_moz_dirty=\"\"]');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (target !== '') $a.attr('target', target);\n\t\t\t\t\t\t\t\t$a.removeAttr('style').removeAttr('_moz_dirty');\n\n\t\t\t\t\t\t\t\tif (this.link.text !== '' || this.link.text != text)\n\t\t\t\t\t\t\t\t{\n\n\t\t\t\t\t\t\t\t\t$a.text(text);\n\t\t\t\t\t\t\t\t\tthis.selection.selectElement($a);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.code.sync();\n\t\t\t\t\t\tthis.core.setCallback('insertedLink', $a);\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// link tooltip\n\t\t\t\t\tsetTimeout($.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.observe.links();\n\n\t\t\t\t\t}, this), 5);\n\t\t\t\t},\n\t\t\t\tunlink: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (typeof e != 'undefined' && e.preventDefault)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tvar nodes = this.selection.getNodes();\n\t\t\t\t\tif (!nodes) return;\n\n\t\t\t\t\tthis.buffer.set();\n\n\t\t\t\t\tvar len = nodes.length;\n\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $node = $(nodes[i]).closest('a');\n\t\t\t\t\t\t$node.replaceWith($node.contents());\n\t\t\t\t\t}\n\n\t\t\t\t\t// hide link's tooltip\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\n\n\t\t\t\t\tthis.code.sync();\n\n\t\t\t\t},\n\t\t\t\ttoggleClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tthis.link.setClass(className, 'toggleClass');\n\t\t\t\t},\n\t\t\t\taddClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tthis.link.setClass(className, 'addClass');\n\t\t\t\t},\n\t\t\t\tremoveClass: function(className)\n\t\t\t\t{\n\t\t\t\t\tthis.link.setClass(className, 'removeClass');\n\t\t\t\t},\n\t\t\t\tsetClass: function(className, func)\n\t\t\t\t{\n\t\t\t\t\tvar links = this.selection.getInlinesTags(['a']);\n\t\t\t\t\tif (links === false) return;\n\n\t\t\t\t\t$.each(links, function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this)[func](className);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tlist: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttoggle: function(cmd)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholder.remove();\n\t\t\t\t\tif (!this.utils.browser('msie')) this.$editor.focus();\n\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\n\t\t\t\t\tvar parent = this.selection.getParent();\n\t\t\t\t\tvar $list = $(parent).closest('ol, ul');\n\n\t\t\t\t\tif (!this.utils.isRedactorParent($list) && $list.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$list = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isUnorderedCmdOrdered, isOrderedCmdUnordered;\n\t\t\t\t\tvar remove = false;\n\t\t\t\t\tif ($list && $list.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tremove = true;\n\t\t\t\t\t\tvar listTag = $list[0].tagName;\n\n\t\t\t\t\t\tisUnorderedCmdOrdered = (cmd === 'orderedlist' && listTag === 'UL');\n\t\t\t\t\t\tisOrderedCmdUnordered = (cmd === 'unorderedlist' && listTag === 'OL');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (isUnorderedCmdOrdered)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.replaceToTag($list, 'ol');\n\t\t\t\t\t}\n\t\t\t\t\telse if (isOrderedCmdUnordered)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.utils.replaceToTag($list, 'ul');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (remove)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.list.remove(cmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.list.insert(cmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t},\n\t\t\t\tinsert: function(cmd)\n\t\t\t\t{\n\t\t\t\t\tvar parent = this.selection.getParent();\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\t\t\t\t\tvar $td = $(current).closest('td, th');\n\n\t\t\t\t\tif (this.utils.browser('msie') && this.opts.linebreaks)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.list.insertInIe(cmd);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.execCommand('insert' + cmd);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $list = $(this.selection.getParent()).closest('ol, ul');\n\n\t\t\t\t\tif ($td.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar prev = $td.prev();\n\t\t\t\t\t\tvar html = $td.html();\n\t\t\t\t\t\t$td.html('');\n\t\t\t\t\t\tif (prev && prev.length === 1 && (prev[0].tagName === 'TD' || prev[0].tagName === 'TH'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(prev).after($td);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(parent).prepend($td);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$td.html(html);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.utils.isEmpty($list.find('li').text()))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $children = $list.children('li');\n\t\t\t\t\t\t$children.find('br').remove();\n\t\t\t\t\t\t$children.append(this.selection.getMarkerAsHtml());\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($list.length)\n\t\t\t\t\t{\n\t\t\t\t\t\t// remove block-element list wrapper\n\t\t\t\t\t\tvar $listParent = $list.parent();\n\t\t\t\t\t\tif (this.utils.isRedactorParent($listParent) && $listParent[0].tagName != 'LI' && this.utils.isBlock($listParent[0]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$listParent.replaceWith($listParent.contents());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.clean.clearUnverified();\n\t\t\t\t},\n\t\t\t\tinsertInIe: function(cmd)\n\t\t\t\t{\n\t\t\t\t\tvar wrapper = this.selection.wrap('div');\n\t\t\t\t\tvar wrapperHtml = $(wrapper).html();\n\n\t\t\t\t\tvar tmpList = (cmd == 'orderedlist') ? $('<ol>') : $('<ul>');\n\t\t\t\t\tvar tmpLi = $('<li>');\n\n\t\t\t\t\tif ($.trim(wrapperHtml) === '')\n\t\t\t\t\t{\n\t\t\t\t\t\ttmpLi.append(this.selection.getMarkerAsHtml());\n\t\t\t\t\t\ttmpList.append(tmpLi);\n\t\t\t\t\t\tthis.$editor.find('#selection-marker-1').replaceWith(tmpList);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tvar items = wrapperHtml.split(/<br\\s?\\/?>/gi);\n\t\t\t\t\t\tif (items)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor (var i = 0; i < items.length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif ($.trim(items[i]) !== '')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttmpList.append($('<li>').html(items[i]));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttmpLi.append(wrapperHtml);\n\t\t\t\t\t\t\ttmpList.append(tmpLi);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$(wrapper).replaceWith(tmpList);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremove: function(cmd)\n\t\t\t\t{\n\t\t\t\t\tdocument.execCommand('insert' + cmd);\n\n\t\t\t\t\tvar $current = $(this.selection.getCurrent());\n\n\t\t\t\t\tthis.indent.fixEmptyIndent();\n\n\t\t\t\t\tif (!this.opts.linebreaks && $current.closest('li, th, td').length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.execCommand('formatblock', false, 'p');\n\t\t\t\t\t\tthis.$editor.find('ul, ol, blockquote').each($.proxy(this.utils.removeEmpty, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tvar $table = $(this.selection.getCurrent()).closest('table');\n\t\t\t\t\tvar $prev = $table.prev();\n\t\t\t\t\tif (!this.opts.linebreaks && $table.length !== 0 && $prev.length !== 0 && $prev[0].tagName == 'BR')\n\t\t\t\t\t{\n\t\t\t\t\t\t$prev.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.clean.clearUnverified();\n\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tmodal: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcallbacks: {},\n\t\t\t\tloadTemplates: function()\n\t\t\t\t{\n\t\t\t\t\tthis.opts.modal = {\n\t\t\t\t\t\timageEdit: String()\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-image-edit\">'\n\t\t\t\t\t\t\t+ '<label>' + this.lang.get('title') + '</label>'\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-image-title\" />'\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-link-option\">' + this.lang.get('link') + '</label>'\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-image-link\" class=\"redactor-image-link-option\" />'\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-link-option\"><input type=\"checkbox\" id=\"redactor-image-link-blank\"> ' + this.lang.get('link_new_tab') + '</label>'\n\t\t\t\t\t\t\t+ '<label class=\"redactor-image-position-option\">' + this.lang.get('image_position') + '</label>'\n\t\t\t\t\t\t\t+ '<select class=\"redactor-image-position-option\" id=\"redactor-image-align\">'\n\t\t\t\t\t\t\t\t+ '<option value=\"none\">' + this.lang.get('none') + '</option>'\n\t\t\t\t\t\t\t\t+ '<option value=\"left\">' + this.lang.get('left') + '</option>'\n\t\t\t\t\t\t\t\t+ '<option value=\"center\">' + this.lang.get('center') + '</option>'\n\t\t\t\t\t\t\t\t+ '<option value=\"right\">' + this.lang.get('right') + '</option>'\n\t\t\t\t\t\t\t+ '</select>'\n\t\t\t\t\t\t+ '</section>',\n\n\t\t\t\t\t\timage: String()\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-image-insert\">'\n\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-image-droparea\"></div>'\n \t\t\t\t\t\t+ '</section>',\n\n\t\t\t\t\t\tfile: String()\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-file-insert\">'\n\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-file-upload-box\">'\n\t\t\t\t\t\t\t\t+ '<label>' + this.lang.get('filename') + '</label>'\n\t\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-filename\" /><br><br>'\n\t\t\t\t\t\t\t\t+ '<div id=\"redactor-modal-file-upload\"></div>'\n\t\t\t\t\t\t\t+ '</div>'\n\t\t\t\t\t\t+ '</section>',\n\n\t\t\t\t\t\tlink: String()\n\t\t\t\t\t\t+ '<section id=\"redactor-modal-link-insert\">'\n\t\t\t\t\t\t\t+ '<label>URL</label>'\n\t\t\t\t\t\t\t+ '<input type=\"url\" id=\"redactor-link-url\" />'\n\t\t\t\t\t\t\t+ '<label>' + this.lang.get('text') + '</label>'\n\t\t\t\t\t\t\t+ '<input type=\"text\" id=\"redactor-link-url-text\" />'\n\t\t\t\t\t\t\t+ '<label><input type=\"checkbox\" id=\"redactor-link-blank\"> ' + this.lang.get('link_new_tab') + '</label>'\n\t\t\t\t\t\t+ '</section>'\n\t\t\t\t\t};\n\n\n\t\t\t\t\t$.extend(this.opts, this.opts.modal);\n\n\t\t\t\t},\n\t\t\t\taddCallback: function(name, callback)\n\t\t\t\t{\n\t\t\t\t\tthis.modal.callbacks[name] = callback;\n\t\t\t\t},\n\t\t\t\tcreateTabber: function($modal)\n\t\t\t\t{\n\t\t\t\t\tthis.modal.$tabber = $('<div>').attr('id', 'redactor-modal-tabber');\n\n\t\t\t\t\t$modal.prepend(this.modal.$tabber);\n\t\t\t\t},\n\t\t\t\taddTab: function(id, name, active)\n\t\t\t\t{\n\t\t\t\t\tvar $tab = $('<a href=\"#\" rel=\"tab' + id + '\">').text(name);\n\t\t\t\t\tif (active)\n\t\t\t\t\t{\n\t\t\t\t\t\t$tab.addClass('active');\n\t\t\t\t\t}\n\n\t\t\t\t\tvar self = this;\n\t\t\t\t\t$tab.on('click', function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t$('.redactor-tab').hide();\n\t\t\t\t\t\t$('.redactor-' + $(this).attr('rel')).show();\n\n\t\t\t\t\t\tself.modal.$tabber.find('a').removeClass('active');\n\t\t\t\t\t\t$(this).addClass('active');\n\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.modal.$tabber.append($tab);\n\t\t\t\t},\n\t\t\t\taddTemplate: function(name, template)\n\t\t\t\t{\n\t\t\t\t\tthis.opts.modal[name] = template;\n\t\t\t\t},\n\t\t\t\tgetTemplate: function(name)\n\t\t\t\t{\n\t\t\t\t\treturn this.opts.modal[name];\n\t\t\t\t},\n\t\t\t\tgetModal: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.$modalBody.find('section');\n\t\t\t\t},\n\t\t\t\tload: function(templateName, title, width)\n\t\t\t\t{\n\t\t\t\t\tthis.modal.templateName = templateName;\n\t\t\t\t\tthis.modal.width = width;\n\n\t\t\t\t\tthis.modal.build();\n\t\t\t\t\tthis.modal.enableEvents();\n\t\t\t\t\tthis.modal.setTitle(title);\n\t\t\t\t\tthis.modal.setDraggable();\n\t\t\t\t\tthis.modal.setContent();\n\n\t\t\t\t\t// callbacks\n\t\t\t\t\tif (typeof this.modal.callbacks[templateName] != 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.callbacks[templateName].call(this);\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tshow: function()\n\t\t\t\t{\n\t\t\t\t\t// ios keyboard hide\n\t\t\t\t\tif (this.utils.isMobile() && !this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t\t}\n\n\t\t\t\t\t$(document.body).removeClass('body-redactor-hidden');\n\t\t\t\t\tthis.modal.bodyOveflow = $(document.body).css('overflow');\n\t\t\t\t\t$(document.body).css('overflow', 'hidden');\n\n\t\t\t\t\tif (this.utils.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.showOnMobile();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.showOnDesktop();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$modalOverlay.show();\n\t\t\t\t\tthis.$modalBox.show();\n\n\t\t\t\t\tthis.modal.setButtonsWidth();\n\n\t\t\t\t\tthis.utils.saveScroll();\n\n\t\t\t\t\t// resize\n\t\t\t\t\tif (!this.utils.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout($.proxy(this.modal.showOnDesktop, this), 0);\n\t\t\t\t\t\t$(window).on('resize.redactor-modal', $.proxy(this.modal.resize, this));\n\t\t\t\t\t}\n\n\t\t\t\t\t// modal shown callback\n\t\t\t\t\tthis.core.setCallback('modalOpened', this.modal.templateName, this.$modal);\n\n\t\t\t\t\t// fix bootstrap modal focus\n\t\t\t\t\t$(document).off('focusin.modal');\n\n\t\t\t\t\t// enter\n\t\t\t\t\tthis.$modal.find('input[type=text],input[type=url],input[type=email]').on('keydown.redactor-modal', $.proxy(this.modal.setEnter, this));\n\t\t\t\t},\n\t\t\t\tshowOnDesktop: function()\n\t\t\t\t{\n\t\t\t\t\tvar height = this.$modal.outerHeight();\n\t\t\t\t\tvar windowHeight = $(window).height();\n\t\t\t\t\tvar windowWidth = $(window).width();\n\n\t\t\t\t\tif (this.modal.width > windowWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$modal.css({\n\t\t\t\t\t\t\twidth: '96%',\n\t\t\t\t\t\t\tmarginTop: (windowHeight/2 - height/2) + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (height > windowHeight)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$modal.css({\n\t\t\t\t\t\t\twidth: this.modal.width + 'px',\n\t\t\t\t\t\t\tmarginTop: '20px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$modal.css({\n\t\t\t\t\t\t\twidth: this.modal.width + 'px',\n\t\t\t\t\t\t\tmarginTop: (windowHeight/2 - height/2) + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tshowOnMobile: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$modal.css({\n\t\t\t\t\t\twidth: '96%',\n\t\t\t\t\t\tmarginTop: '2%'\n\t\t\t\t\t});\n\n\t\t\t\t},\n\t\t\t\tresize: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.showOnMobile();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.modal.showOnDesktop();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetTitle: function(title)\n\t\t\t\t{\n\t\t\t\t\tthis.$modalHeader.html(title);\n\t\t\t\t},\n\t\t\t\tsetContent: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$modalBody.html(this.modal.getTemplate(this.modal.templateName));\n\t\t\t\t},\n\t\t\t\tsetDraggable: function()\n\t\t\t\t{\n\t\t\t\t\tif (typeof $.fn.draggable === 'undefined') return;\n\n\t\t\t\t\tthis.$modal.draggable({ handle: this.$modalHeader });\n\t\t\t\t\tthis.$modalHeader.css('cursor', 'move');\n\t\t\t\t},\n\t\t\t\tsetEnter: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (e.which != 13) return;\n\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.$modal.find('button.redactor-modal-action-btn').click();\n\t\t\t\t},\n\t\t\t\tcreateCancelButton: function()\n\t\t\t\t{\n\t\t\t\t\tvar button = $('<button>').addClass('redactor-modal-btn redactor-modal-close-btn').html(this.lang.get('cancel'));\n\t\t\t\t\tbutton.on('click', $.proxy(this.modal.close, this));\n\n\t\t\t\t\tthis.$modalFooter.append(button);\n\t\t\t\t},\n\t\t\t\tcreateDeleteButton: function(label)\n\t\t\t\t{\n\t\t\t\t\treturn this.modal.createButton(label, 'delete');\n\t\t\t\t},\n\t\t\t\tcreateActionButton: function(label)\n\t\t\t\t{\n\t\t\t\t\treturn this.modal.createButton(label, 'action');\n\t\t\t\t},\n\t\t\t\tcreateButton: function(label, className)\n\t\t\t\t{\n\t\t\t\t\tvar button = $('<button>').addClass('redactor-modal-btn').addClass('redactor-modal-' + className + '-btn').html(label);\n\t\t\t\t\tthis.$modalFooter.append(button);\n\n\t\t\t\t\treturn button;\n\t\t\t\t},\n\t\t\t\tsetButtonsWidth: function()\n\t\t\t\t{\n\t\t\t\t\tvar buttons = this.$modalFooter.find('button');\n\t\t\t\t\tvar buttonsSize = buttons.length;\n\t\t\t\t\tif (buttonsSize === 0) return;\n\n\t\t\t\t\tbuttons.css('width', (100/buttonsSize) + '%');\n\t\t\t\t},\n\t\t\t\tbuild: function()\n\t\t\t\t{\n\t\t\t\t\tthis.modal.buildOverlay();\n\n\t\t\t\t\tthis.$modalBox = $('<div id=\"redactor-modal-box\" />').hide();\n\t\t\t\t\tthis.$modal = $('<div id=\"redactor-modal\" />');\n\t\t\t\t\tthis.$modalHeader = $('<header />');\n\t\t\t\t\tthis.$modalClose = $('<span id=\"redactor-modal-close\" />').html('&times;');\n\t\t\t\t\tthis.$modalBody = $('<div id=\"redactor-modal-body\" />');\n\t\t\t\t\tthis.$modalFooter = $('<footer />');\n\n\t\t\t\t\tthis.$modal.append(this.$modalHeader);\n\t\t\t\t\tthis.$modal.append(this.$modalClose);\n\t\t\t\t\tthis.$modal.append(this.$modalBody);\n\t\t\t\t\tthis.$modal.append(this.$modalFooter);\n\t\t\t\t\tthis.$modalBox.append(this.$modal);\n\t\t\t\t\tthis.$modalBox.appendTo(document.body);\n\t\t\t\t},\n\t\t\t\tbuildOverlay: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$modalOverlay = $('<div id=\"redactor-modal-overlay\">').hide();\n\t\t\t\t\t$('body').prepend(this.$modalOverlay);\n\t\t\t\t},\n\t\t\t\tenableEvents: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$modalClose.on('click.redactor-modal', $.proxy(this.modal.close, this));\n\t\t\t\t\t$(document).on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\n\t\t\t\t\tthis.$editor.on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\n\t\t\t\t\tthis.$modalBox.on('click.redactor-modal', $.proxy(this.modal.close, this));\n\t\t\t\t},\n\t\t\t\tdisableEvents: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$modalClose.off('click.redactor-modal');\n\t\t\t\t\t$(document).off('keyup.redactor-modal');\n\t\t\t\t\tthis.$editor.off('keyup.redactor-modal');\n\t\t\t\t\tthis.$modalBox.off('click.redactor-modal');\n\t\t\t\t\t$(window).off('resize.redactor-modal');\n\t\t\t\t},\n\t\t\t\tcloseHandler: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (e.which != this.keyCode.ESC) return;\n\n\t\t\t\t\tthis.modal.close(false);\n\t\t\t\t},\n\t\t\t\tclose: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!$(e.target).hasClass('redactor-modal-close-btn') && e.target != this.$modalClose[0] && e.target != this.$modalBox[0])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.$modalBox) return;\n\n\t\t\t\t\tthis.modal.disableEvents();\n\n\t\t\t\t\tthis.$modalOverlay.remove();\n\n\t\t\t\t\tthis.$modalBox.fadeOut('fast', $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$modalBox.remove();\n\n\t\t\t\t\t\tsetTimeout($.proxy(this.utils.restoreScroll, this), 0);\n\n\t\t\t\t\t\tif (e !== undefined) this.selection.restore();\n\n\t\t\t\t\t\t$(document.body).css('overflow', this.modal.bodyOveflow);\n\t\t\t\t\t\tthis.core.setCallback('modalClosed', this.modal.templateName);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tobserve: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tload: function()\n\t\t\t\t{\n\t\t\t\t\tthis.observe.images();\n\t\t\t\t\tthis.observe.links();\n\t\t\t\t},\n\t\t\t\tbuttons: function(e, btnName)\n\t\t\t\t{\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\t\t\t\t\tvar parent = this.selection.getParent();\n\n\t\t\t\t\tif (e !== false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.button.setInactiveAll();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.button.setInactiveAll(btnName);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e === false && btnName !== 'html')\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($.inArray(btnName, this.opts.activeButtons) != -1) this.button.toggleActive(btnName);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//var linkButtonName = (this.utils.isCurrentOrParent('A')) ? this.lang.get('link_edit') : this.lang.get('link_insert');\n\t\t\t\t\t//$('body').find('a.redactor-dropdown-link').text(linkButtonName);\n\n\t\t\t\t\t$.each(this.opts.activeButtonsStates, $.proxy(function(key, value)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar parentEl = $(parent).closest(key);\n\t\t\t\t\t\tvar currentEl = $(current).closest(key);\n\n\t\t\t\t\t\tif (parentEl.length !== 0 && !this.utils.isRedactorParent(parentEl)) return;\n\t\t\t\t\t\tif (!this.utils.isRedactorParent(currentEl)) return;\n\t\t\t\t\t\tif (parentEl.length !== 0 || currentEl.closest(key).length !== 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.button.setActive(value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tvar $parent = $(parent).closest(this.opts.alignmentTags.toString().toLowerCase());\n\t\t\t\t\tif (this.utils.isRedactorParent(parent) && $parent.length)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar align = ($parent.css('text-align') === '') ? 'left' : $parent.css('text-align');\n\t\t\t\t\t\tthis.button.setActive('align' + align);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\taddButton: function(tag, btnName)\n\t\t\t\t{\n\t\t\t\t\tthis.opts.activeButtons.push(btnName);\n\t\t\t\t\tthis.opts.activeButtonsStates[tag] = btnName;\n\t\t\t\t},\n\t\t\t\timages: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.find('img').each($.proxy(function(i, img)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $img = $(img);\n\n\t\t\t\t\t\t// IE fix (when we clicked on an image and then press backspace IE does goes to image's url)\n\t\t\t\t\t\t$img.closest('a').on('click', function(e) { e.preventDefault(); });\n\n\t\t\t\t\t\tif (this.utils.browser('msie')) $img.attr('unselectable', 'on');\n\n\t\t\t\t\t\tthis.image.setEditable($img);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\t$(document).on('click.redactor-image-delete.' + this.uuid, $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.observe.image = false;\n\t\t\t\t\t\tif (e.target.tagName == 'IMG' && this.utils.isRedactorParent(e.target))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.observe.image = (this.observe.image && this.observe.image == e.target) ? false : e.target;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t},\n\t\t\t\tlinks: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.linkTooltip) return;\n\n\t\t\t\t\tthis.$editor.find('a').on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.showTooltip, this));\n\t\t\t\t\tthis.$editor.on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\n\t\t\t\t\t$(document).on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\n\t\t\t\t},\n\t\t\t\tgetTooltipPosition: function($link)\n\t\t\t\t{\n\t\t\t\t\treturn $link.offset();\n\t\t\t\t},\n\t\t\t\tshowTooltip: function(e)\n\t\t\t\t{\n\t\t\t\t\tvar $link = $(e.target);\n\t\t\t\t\tvar $parent = $link.closest('a');\n\t\t\t\t\tvar tag = ($link.length !== 0) ? $link[0].tagName : false;\n\n\t\t\t\t\tif ($parent[0].tagName === 'A')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (tag === 'IMG') return;\n\t\t\t\t\t\telse if (tag !== 'A') $link = $parent;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tag !== 'A')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar pos = this.observe.getTooltipPosition($link);\n\t\t\t\t\tvar tooltip = $('<span class=\"redactor-link-tooltip\"></span>');\n\n\t\t\t\t\tvar href = $link.attr('href');\n\t\t\t\t\tif (href === undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\thref = '';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (href.length > 24) href = href.substring(0, 24) + '...';\n\n\t\t\t\t\tvar aLink = $('<a href=\"' + $link.attr('href') + '\" target=\"_blank\" />').html(href).addClass('redactor-link-tooltip-action');\n\t\t\t\t\tvar aEdit = $('<a href=\"#\" />').html(this.lang.get('edit')).on('click', $.proxy(this.link.show, this)).addClass('redactor-link-tooltip-action');\n\t\t\t\t\tvar aUnlink = $('<a href=\"#\" />').html(this.lang.get('unlink')).on('click', $.proxy(this.link.unlink, this)).addClass('redactor-link-tooltip-action');\n\n\t\t\t\t\ttooltip.append(aLink).append(' | ').append(aEdit).append(' | ').append(aUnlink);\n\t\t\t\t\ttooltip.css({\n\t\t\t\t\t\ttop: (pos.top + parseInt($link.css('line-height'), 10)) + 'px',\n\t\t\t\t\t\tleft: pos.left + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\n\t\t\t\t\t$('body').append(tooltip);\n\t\t\t\t},\n\t\t\t\tcloseTooltip: function(e)\n\t\t\t\t{\n\t\t\t\t\te = e.originalEvent || e;\n\n\t\t\t\t\tvar target = e.target;\n\t\t\t\t\tvar $parent = $(target).closest('a');\n\t\t\t\t\tif ($parent.length !== 0 && $parent[0].tagName === 'A' && target.tagName !== 'A')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if ((target.tagName === 'A' && this.utils.isRedactorParent(target)) || $(target).hasClass('redactor-link-tooltip-action'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$('.redactor-link-tooltip').remove();\n\t\t\t\t}\n\n\t\t\t};\n\t\t},\n\t\tparagraphize: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tload: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.linebreaks) return html;\n\t\t\t\t\tif (html === '' || html === '<p></p>') return this.opts.emptyHtml;\n\n\t\t\t\t\tthis.paragraphize.blocks = ['table', 'div', 'pre', 'form', 'ul', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dl', 'blockquote', 'figcaption',\n\t\t\t\t\t'address', 'section', 'header', 'footer', 'aside', 'article', 'object', 'style', 'script', 'iframe', 'select', 'input', 'textarea',\n\t\t\t\t\t'button', 'option', 'map', 'area', 'math', 'hr', 'fieldset', 'legend', 'hgroup', 'nav', 'figure', 'details', 'menu', 'summary', 'p'];\n\n\t\t\t\t\thtml = html + \"\\n\";\n\n\t\t\t\t\tthis.paragraphize.safes = [];\n\t\t\t\t\tthis.paragraphize.z = 0;\n\n\t\t\t\t\thtml = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\n\n\t\t\t\t\thtml = this.paragraphize.getSafes(html);\n\t\t\t\t\thtml = this.paragraphize.getSafesComments(html);\n\t\t\t\t\thtml = this.paragraphize.replaceBreaksToNewLines(html);\n\t\t\t\t\thtml = this.paragraphize.replaceBreaksToParagraphs(html);\n\t\t\t\t\thtml = this.paragraphize.clear(html);\n\t\t\t\t\thtml = this.paragraphize.restoreSafes(html);\n\n\t\t\t\t\thtml = html.replace(new RegExp('<br\\\\s?/?>\\n?<(' + this.paragraphize.blocks.join('|') + ')(.*?[^>])>', 'gi'), '<p><br /></p>\\n<$1$2>');\n\n\t\t\t\t\treturn $.trim(html);\n\t\t\t\t},\n\t\t\t\tgetSafes: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar $div = $('<div />').append(html);\n\n\t\t\t\t\t// remove paragraphs in blockquotes\n\t\t\t\t\t$div.find('blockquote p').replaceWith(function()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn $(this).append('<br />').contents();\n\t\t\t\t\t});\n\n\t\t\t\t\thtml = $div.html();\n\n\t\t\t\t\t$div.find(this.paragraphize.blocks.join(', ')).each($.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.paragraphize.z++;\n\t\t\t\t\t\tthis.paragraphize.safes[this.paragraphize.z] = s.outerHTML;\n\t\t\t\t\t\thtml = html.replace(s.outerHTML, '\\n{replace' + this.paragraphize.z + '}');\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tgetSafesComments: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar commentsMatches = html.match(/<!--([\\w\\W]*?)-->/gi);\n\n\t\t\t\t\tif (!commentsMatches) return html;\n\n\t\t\t\t\t$.each(commentsMatches, $.proxy(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.paragraphize.z++;\n\t\t\t\t\t\tthis.paragraphize.safes[this.paragraphize.z] = s;\n\t\t\t\t\t\thtml = html.replace(s, '\\n{replace' + this.paragraphize.z + '}');\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\trestoreSafes: function(html)\n\t\t\t\t{\n\t\t\t\t\t$.each(this.paragraphize.safes, function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\ts = (typeof s !== 'undefined') ? s.replace(/\\$/g, '&#36;') : s;\n\t\t\t\t\t\thtml = html.replace('{replace' + i + '}', s);\n\n\t\t\t\t\t});\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceBreaksToParagraphs: function(html)\n\t\t\t\t{\n\t\t\t\t\tvar htmls = html.split(new RegExp('\\n', 'g'), -1);\n\n\t\t\t\t\thtml = '';\n\t\t\t\t\tif (htmls)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar len = htmls.length;\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!htmls.hasOwnProperty(i)) return;\n\n\t\t\t\t\t\t\tif (htmls[i].search('{replace') == -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\thtmls[i] = htmls[i].replace(/<p>\\n\\t?<\\/p>/gi, '');\n\t\t\t\t\t\t\t\thtmls[i] = htmls[i].replace(/<p><\\/p>/gi, '');\n\n\t\t\t\t\t\t\t\tif (htmls[i] !== '')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thtml += '<p>' +  htmls[i].replace(/^\\n+|\\n+$/g, \"\") + \"</p>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse html += htmls[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceBreaksToNewLines: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/<br \\/>\\s*<br \\/>/gi, \"\\n\\n\");\n\t\t\t\t\thtml = html.replace(/<br\\s?\\/?>\\n?<br\\s?\\/?>/gi, \"\\n<br /><br />\");\n\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\r\\n\", 'g'), \"\\n\");\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\r\", 'g'), \"\\n\");\n\t\t\t\t\thtml = html.replace(new RegExp(\"/\\n\\n+/\"), 'g', \"\\n\\n\");\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tclear: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(new RegExp('</blockquote></p>', 'gi'), '</blockquote>');\n\t\t\t\t\thtml = html.replace(new RegExp('<p></blockquote>', 'gi'), '</blockquote>');\n\t\t\t\t\thtml = html.replace(new RegExp('<p><blockquote>', 'gi'), '<blockquote>');\n\t\t\t\t\thtml = html.replace(new RegExp('<blockquote></p>', 'gi'), '<blockquote>');\n\n\t\t\t\t\thtml = html.replace(new RegExp('<p><p ', 'gi'), '<p ');\n\t\t\t\t\thtml = html.replace(new RegExp('<p><p>', 'gi'), '<p>');\n\t\t\t\t\thtml = html.replace(new RegExp('</p></p>', 'gi'), '</p>');\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\\\s?</p>', 'gi'), '');\n\t\t\t\t\thtml = html.replace(new RegExp(\"\\n</p>\", 'gi'), '</p>');\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\t?\\t?\\n?<p>', 'gi'), '<p>');\n\t\t\t\t\thtml = html.replace(new RegExp('<p>\\t*</p>', 'gi'), '');\n\n\t\t\t\t\treturn html;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tpaste: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function(e)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.cleanOnPaste)\n\t\t\t\t\t{\n\t\t\t\t\t\tsetTimeout($.proxy(this.code.sync, this), 1);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.rtePaste = true;\n\n\t\t\t\t\tthis.buffer.set();\n\t\t\t\t\tthis.selection.save();\n\t\t\t\t\tthis.utils.saveScroll();\n\n\t\t\t\t\tthis.paste.createPasteBox();\n\n\t\t\t\t\t$(window).on('scroll.redactor-freeze', $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(window).scrollTop(this.saveBodyScroll);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\tsetTimeout($.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar html = this.$pasteBox.html();\n\n\t\t\t\t\t\tthis.$pasteBox.remove();\n\n\t\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\t\tthis.utils.restoreScroll();\n\n\t\t\t\t\t\tthis.paste.insert(html);\n\n\t\t\t\t\t\t$(window).off('scroll.redactor-freeze');\n\n\t\t\t\t\t}, this), 1);\n\n\t\t\t\t},\n\t\t\t\tcreatePasteBox: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$pasteBox = $('<div>').html('').attr('contenteditable', 'true').css({ position: 'fixed', width: 0, top: 0, left: '-9999px' });\n\n\t\t\t\t\tif (this.utils.browser('msie'))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$box.append(this.$pasteBox);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$('body').append(this.$pasteBox);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$pasteBox.focus();\n\t\t\t\t},\n\t\t\t\tinsert: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = this.core.setCallback('pasteBefore', html);\n\n\t\t\t\t\t// clean\n\t\t\t\t\thtml = (this.utils.isSelectAll()) ? this.clean.onPaste(html, false) : this.clean.onPaste(html);\n\n\t\t\t\t\thtml = this.core.setCallback('paste', html);\n\n\t\t\t\t\tif (this.utils.isSelectAll())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insert.set(html, false);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.insert.html(html, false);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.utils.disableSelectAll();\n\t\t\t\t\tthis.rtePaste = false;\n\n\t\t\t\t\tsetTimeout($.proxy(this.clean.clearUnverified, this), 10);\n\n\t\t\t\t\t// clean empty spans\n\t\t\t\t\tsetTimeout($.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar spans = this.$editor.find('span');\n\t\t\t\t\t\t$.each(spans, function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar html = s.innerHTML.replace(/[\\u200B-\\u200D\\uFEFF]/, '');\n\t\t\t\t\t\t\tif (html === '' && s.attributes.length === 0) $(s).remove();\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}, this), 10);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tplaceholder: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tenable: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.placeholder.is()) return;\n\n\t\t\t\t\tthis.$editor.attr('placeholder', this.$element.attr('placeholder'));\n\n\t\t\t\t\tthis.placeholder.toggle();\n\t\t\t\t\tthis.$editor.on('keyup.redactor-placeholder', $.proxy(this.placeholder.toggle, this));\n\n\t\t\t\t},\n\t\t\t\ttoggle: function()\n\t\t\t\t{\n\t\t\t\t\tvar func = 'removeClass';\n\t\t\t\t\tif (this.utils.isEmpty(this.$editor.html(), false)) func = 'addClass';\n\t\t\t\t\tthis.$editor[func]('redactor-placeholder');\n\t\t\t\t},\n\t\t\t\tremove: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.removeClass('redactor-placeholder');\n\t\t\t\t},\n\t\t\t\tis: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.placeholder)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.$element.attr('placeholder', this.opts.placeholder);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn !(typeof this.$element.attr('placeholder') == 'undefined' || this.$element.attr('placeholder') === '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tprogress: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tshow: function()\n\t\t\t\t{\n\t\t\t\t\t$(document.body).append($('<div id=\"redactor-progress\"><span></span></div>'));\n\t\t\t\t\t$('#redactor-progress').fadeIn();\n\t\t\t\t},\n\t\t\t\thide: function()\n\t\t\t\t{\n\t\t\t\t\t$('#redactor-progress').fadeOut(1500, function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t};\n\t\t},\n\t\tselection: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tget: function()\n\t\t\t\t{\n\t\t\t\t\tthis.sel = document.getSelection();\n\n\t\t\t\t\tif (document.getSelection && this.sel.getRangeAt && this.sel.rangeCount)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range = this.sel.getRangeAt(0);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range = document.createRange();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\taddRange: function()\n\t\t\t\t{\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.sel.removeAllRanges();\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\tthis.sel.addRange(this.range);\n\t\t\t\t},\n\t\t\t\tgetCurrent: function()\n\t\t\t\t{\n\t\t\t\t\tvar el = false;\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.sel && this.sel.rangeCount > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tel = this.sel.getRangeAt(0).startContainer;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.utils.isRedactorParent(el);\n\t\t\t\t},\n\t\t\t\tgetParent: function(elem)\n\t\t\t\t{\n\t\t\t\t\telem = elem || this.selection.getCurrent();\n\t\t\t\t\tif (elem)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.utils.isRedactorParent($(elem).parent()[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tgetBlock: function(node)\n\t\t\t\t{\n\t\t\t\t\tnode = node || this.selection.getCurrent();\n\n\t\t\t\t\twhile (node)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.utils.isBlockTag(node.tagName))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn ($(node).hasClass('redactor-editor')) ? false : node;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tgetInlines: function(nodes, tags)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.range && this.range.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar inlines = [];\n\t\t\t\t\tnodes = (typeof nodes == 'undefined' || nodes === false) ? this.selection.getNodes() : nodes;\n\t\t\t\t\tvar inlineTags = this.opts.inlineTags;\n\t\t\t\t\tinlineTags.push('span');\n\n\t\t\t\t\tif (typeof tags !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (var i = 0; i < tags.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinlineTags.push(tags[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($.inArray(node.tagName.toLowerCase(), inlineTags) != -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinlines.push(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn (inlines.length === 0) ? false : inlines;\n\t\t\t\t},\n\t\t\t\tgetInlinesTags: function(tags)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.range && this.range.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar inlines = [];\n\t\t\t\t\tvar nodes =  this.selection.getNodes();\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($.inArray(node.tagName.toLowerCase(), tags) != -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinlines.push(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn (inlines.length === 0) ? false : inlines;\n\t\t\t\t},\n\t\t\t\tgetBlocks: function(nodes)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.range && this.range.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [this.selection.getBlock()];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar blocks = [];\n\t\t\t\t\tnodes = (typeof nodes == 'undefined') ? this.selection.getNodes() : nodes;\n\t\t\t\t\t$.each(nodes, $.proxy(function(i,node)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.utils.isBlock(node))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selection.lastBlock = node;\n\t\t\t\t\t\t\tblocks.push(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn (blocks.length === 0) ? [this.selection.getBlock()] : blocks;\n\t\t\t\t},\n\t\t\t\tgetLastBlock: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.selection.lastBlock;\n\t\t\t\t},\n\t\t\t\tgetNodes: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tvar startNode = this.selection.getNodesMarker(1);\n\t\t\t\t\tvar endNode = this.selection.getNodesMarker(2);\n\t\t\t\t\tvar range = this.range.cloneRange();\n\n\t\t\t\t\tif (this.range.collapsed === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar startContainer = range.startContainer;\n\t\t\t\t\t\tvar startOffset = range.startOffset;\n\n\t\t\t\t\t\t// end marker\n\t\t\t\t\t\tthis.selection.setNodesMarker(range, endNode, false);\n\n\t\t\t\t\t\t// start marker\n\t\t\t\t\t\trange.setStart(startContainer, startOffset);\n\t\t\t\t\t\tthis.selection.setNodesMarker(range, startNode, true);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.selection.setNodesMarker(range, startNode, true);\n\t\t\t\t\t\tendNode = startNode;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar nodes = [];\n\t\t\t\t\tvar counter = 0;\n\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tthis.$editor.find('*').each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this == startNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar parent = $(this).parent();\n\t\t\t\t\t\t\tif (parent.length !== 0 && parent[0].tagName != 'BODY' && self.utils.isRedactorParent(parent[0]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnodes.push(parent[0]);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnodes.push(this);\n\t\t\t\t\t\t\tcounter = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (counter > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnodes.push(this);\n\t\t\t\t\t\t\t\tcounter = counter + 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this == endNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t\tvar finalNodes = [];\n\t\t\t\t\tvar len = nodes.length;\n\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (nodes[i].id != 'nodes-marker-1' && nodes[i].id != 'nodes-marker-2')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfinalNodes.push(nodes[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.removeNodesMarkers();\n\n\t\t\t\t\treturn finalNodes;\n\n\t\t\t\t},\n\t\t\t\tgetNodesMarker: function(num)\n\t\t\t\t{\n\t\t\t\t\treturn $('<span id=\"nodes-marker-' + num + '\" class=\"redactor-nodes-marker\" data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\n\t\t\t\t},\n\t\t\t\tsetNodesMarker: function(range, node, type)\n\t\t\t\t{\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.collapse(type);\n\t\t\t\t\t\trange.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {}\n\t\t\t\t},\n\t\t\t\tremoveNodesMarkers: function()\n\t\t\t\t{\n\t\t\t\t\t$(document).find('span.redactor-nodes-marker').remove();\n\t\t\t\t\tthis.$editor.find('span.redactor-nodes-marker').remove();\n\t\t\t\t},\n\t\t\t\tfromPoint: function(start, end)\n\t\t\t\t{\n\t\t\t\t\tthis.caret.setOffset(start, end);\n\t\t\t\t},\n\t\t\t\twrap: function(tag)\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (this.range.collapsed) return false;\n\n\t\t\t\t\tvar wrapper = document.createElement(tag);\n\t\t\t\t\twrapper.appendChild(this.range.extractContents());\n\t\t\t\t\tthis.range.insertNode(wrapper);\n\n\t\t\t\t\treturn wrapper;\n\t\t\t\t},\n\t\t\t\tselectElement: function(node)\n\t\t\t\t{\n\t\t\t\t\tthis.caret.set(node, 0, node, 1);\n\t\t\t\t},\n\t\t\t\tselectAll: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tthis.range.selectNodeContents(this.$editor[0]);\n\t\t\t\t\tthis.selection.addRange();\n\t\t\t\t},\n\t\t\t\tremove: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tthis.sel.removeAllRanges();\n\t\t\t\t},\n\t\t\t\tsave: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.createMarkers();\n\t\t\t\t},\n\t\t\t\t// createMarkers: function()\n\t\t\t\t// {\n\t\t\t\t// \tthis.selection.get();\n\n\t\t\t\t// \tvar node1 = this.selection.getMarker(1);\n\n\t\t\t\t// \tthis.selection.setMarker(this.range, node1, true);\n\n\t\t\t\t// \tif (this.range.collapsed === false)\n\t\t\t\t// \t{\n\t\t\t\t// \t\tvar node2 = this.selection.getMarker(2);\n\t\t\t\t// \t\tthis.selection.setMarker(this.range, node2, false);\n\t\t\t\t// \t}\n\n\t\t\t\t// \tthis.savedSel = this.$editor.html();\n\t\t\t\t// },\n                createMarkers: function()\n                {\n                  this.selection.get();\n\n                  var node1 = this.selection.getMarker(1);\n\n                  this.selection.setMarker(this.range, node1, true);\n\n                  if (this.range.collapsed === false)\n                  {\n                    var node2 = this.selection.getMarker(2);\n                    this.selection.setMarker(this.range, node2, false);\n\n                    // Fix for Chrome58 Issues\n                    if (this.utils.browser('chrome')) {\n                          this.caret.set(node1, 0, node2, 0);\n                     }\n                     // End Chrome58 Issues\n                  }\n\n                  this.savedSel = this.$editor.html();\n                },\n\t\t\t\tgetMarker: function(num)\n\t\t\t\t{\n\t\t\t\t\tif (typeof num == 'undefined') num = 1;\n\n\t\t\t\t\treturn $('<span id=\"selection-marker-' + num + '\" class=\"redactor-selection-marker\"  data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\n\t\t\t\t},\n\t\t\t\tgetMarkerAsHtml: function(num)\n\t\t\t\t{\n\t\t\t\t\treturn this.utils.getOuterHtml(this.selection.getMarker(num));\n\t\t\t\t},\n\t\t\t\tsetMarker: function(range, node, type)\n\t\t\t\t{\n\t\t\t\t\trange = range.cloneRange();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.collapse(type);\n\t\t\t\t\t\trange.insertNode(node);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focus.setStart();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trestore: function()\n\t\t\t\t{\n\t\t\t\t\tvar node1 = this.$editor.find('span#selection-marker-1');\n\t\t\t\t\tvar node2 = this.$editor.find('span#selection-marker-2');\n\n\t\t\t\t\tif (node1.length !== 0 && node2.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.set(node1, 0, node2, 0);\n\t\t\t\t\t}\n\t\t\t\t\telse if (node1.length !== 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.caret.set(node1, 0, node1, 0);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.focus();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.removeMarkers();\n\t\t\t\t\tthis.savedSel = false;\n\n\t\t\t\t},\n\t\t\t\tremoveMarkers: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$editor.find('span.redactor-selection-marker').each(function(i,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar text = $(s).text().replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\t\t\t\t\t\tif (text === '') $(s).remove();\n\t\t\t\t\t\telse $(s).replaceWith(function() { return $(this).contents(); });\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tgetText: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\treturn this.sel.toString();\n\t\t\t\t},\n\t\t\t\tgetHtml: function()\n\t\t\t\t{\n\t\t\t\t\tvar html = '';\n\n\t\t\t\t\tthis.selection.get();\n\t\t\t\t\tif (this.sel.rangeCount)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar container = document.createElement('div');\n\t\t\t\t\t\tvar len = this.sel.rangeCount;\n\t\t\t\t\t\tfor (var i = 0; i < len; ++i)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontainer.appendChild(this.sel.getRangeAt(i).cloneContents());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thtml = container.innerHTML;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.clean.onSync(html);\n\t\t\t\t},\n\t\t\t\treplaceWithHtml: function(html)\n\t\t\t\t{\n\t\t\t\t\thtml = this.selection.getMarkerAsHtml(1) + html + this.selection.getMarkerAsHtml(2);\n\n\t\t\t\t\tthis.selection.get();\n\n\t\t\t\t\tif (window.getSelection && window.getSelection().getRangeAt)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.deleteContents();\n\t\t\t\t\t\tvar div = document.createElement(\"div\");\n\t\t\t\t\t\tdiv.innerHTML = html;\n\n\t\t\t\t\t\tvar frag = document.createDocumentFragment(), child;\n\t\t\t\t\t\twhile ((child = div.firstChild))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfrag.appendChild(child);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.range.insertNode(frag);\n\t\t\t\t\t}\n\t\t\t\t\telse if (document.selection && document.selection.createRange)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.range.pasteHTML(html);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.selection.restore();\n\t\t\t\t\tthis.code.sync();\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tshortcuts: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function(e, key)\n\t\t\t\t{\n\t\t\t\t\t// disable browser's hot keys for bold and italic\n\t\t\t\t\tif (!this.opts.shortcuts)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ((e.ctrlKey || e.metaKey) && (key === 66 || key === 73)) e.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(this.opts.shortcuts, $.proxy(function(str, command)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar keys = str.split(',');\n\t\t\t\t\t\tvar len = keys.length;\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (typeof keys[i] === 'string')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.shortcuts.handler(e, $.trim(keys[i]), $.proxy(function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar func;\n\t\t\t\t\t\t\t\t\tif (command.func.search(/\\./) != '-1')\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfunc = command.func.split('.');\n\t\t\t\t\t\t\t\t\t\tif (typeof this[func[0]] != 'undefined')\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis[func[0]][func[1]].apply(this, command.params);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis[command.func].apply(this, command.params);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}, this));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\thandler: function(e, keys, origHandler)\n\t\t\t\t{\n\t\t\t\t\t// based on https://github.com/jeresig/jquery.hotkeys\n\t\t\t\t\tvar hotkeysSpecialKeys =\n\t\t\t\t\t{\n\t\t\t\t\t\t8: \"backspace\", 9: \"tab\", 10: \"return\", 13: \"return\", 16: \"shift\", 17: \"ctrl\", 18: \"alt\", 19: \"pause\",\n\t\t\t\t\t\t20: \"capslock\", 27: \"esc\", 32: \"space\", 33: \"pageup\", 34: \"pagedown\", 35: \"end\", 36: \"home\",\n\t\t\t\t\t\t37: \"left\", 38: \"up\", 39: \"right\", 40: \"down\", 45: \"insert\", 46: \"del\", 59: \";\", 61: \"=\",\n\t\t\t\t\t\t96: \"0\", 97: \"1\", 98: \"2\", 99: \"3\", 100: \"4\", 101: \"5\", 102: \"6\", 103: \"7\",\n\t\t\t\t\t\t104: \"8\", 105: \"9\", 106: \"*\", 107: \"+\", 109: \"-\", 110: \".\", 111 : \"/\",\n\t\t\t\t\t\t112: \"f1\", 113: \"f2\", 114: \"f3\", 115: \"f4\", 116: \"f5\", 117: \"f6\", 118: \"f7\", 119: \"f8\",\n\t\t\t\t\t\t120: \"f9\", 121: \"f10\", 122: \"f11\", 123: \"f12\", 144: \"numlock\", 145: \"scroll\", 173: \"-\", 186: \";\", 187: \"=\",\n\t\t\t\t\t\t188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\", 221: \"]\", 222: \"'\"\n\t\t\t\t\t};\n\n\n\t\t\t\t\tvar hotkeysShiftNums =\n\t\t\t\t\t{\n\t\t\t\t\t\t\"`\": \"~\", \"1\": \"!\", \"2\": \"@\", \"3\": \"#\", \"4\": \"$\", \"5\": \"%\", \"6\": \"^\", \"7\": \"&\",\n\t\t\t\t\t\t\"8\": \"*\", \"9\": \"(\", \"0\": \")\", \"-\": \"_\", \"=\": \"+\", \";\": \": \", \"'\": \"\\\"\", \",\": \"<\",\n\t\t\t\t\t\t\".\": \">\",  \"/\": \"?\",  \"\\\\\": \"|\"\n\t\t\t\t\t};\n\n\t\t\t\t\tkeys = keys.toLowerCase().split(\" \");\n\t\t\t\t\tvar special = hotkeysSpecialKeys[e.keyCode],\n\t\t\t\t\t\tcharacter = String.fromCharCode( e.which ).toLowerCase(),\n\t\t\t\t\t\tmodif = \"\", possible = {};\n\n\t\t\t\t\t$.each([ \"alt\", \"ctrl\", \"meta\", \"shift\"], function(index, specialKey)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (e[specialKey + 'Key'] && special !== specialKey)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmodif += specialKey + '+';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\tif (special) possible[modif + special] = true;\n\t\t\t\t\tif (character)\n\t\t\t\t\t{\n\t\t\t\t\t\tpossible[modif + character] = true;\n\t\t\t\t\t\tpossible[modif + hotkeysShiftNums[character]] = true;\n\n\t\t\t\t\t\t// \"$\" can be triggered as \"Shift+4\" or \"Shift+$\" or just \"$\"\n\t\t\t\t\t\tif (modif === \"shift+\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpossible[hotkeysShiftNums[character]] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var i = 0, len = keys.length; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (possible[keys[i]])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn origHandler.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\ttabifier: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tget: function(code)\n\t\t\t\t{\n\t\t\t\t\tif (!this.opts.tabifier) return code;\n\n\t\t\t\t\t// clean setup\n\t\t\t\t\tvar ownLine = ['area', 'body', 'head', 'hr', 'i?frame', 'link', 'meta', 'noscript', 'style', 'script', 'table', 'tbody', 'thead', 'tfoot'];\n\t\t\t\t\tvar contOwnLine = ['li', 'dt', 'dt', 'h[1-6]', 'option', 'script'];\n\t\t\t\t\tvar newLevel = ['p', 'blockquote', 'div', 'dl', 'fieldset', 'form', 'frameset', 'map', 'ol', 'pre', 'select', 'td', 'th', 'tr', 'ul'];\n\n\t\t\t\t\tthis.tabifier.lineBefore = new RegExp('^<(/?' + ownLine.join('|/?' ) + '|' + contOwnLine.join('|') + ')[ >]');\n\t\t\t\t\tthis.tabifier.lineAfter = new RegExp('^<(br|/?' + ownLine.join('|/?' ) + '|/' + contOwnLine.join('|/') + ')[ >]');\n\t\t\t\t\tthis.tabifier.newLevel = new RegExp('^</?(' + newLevel.join('|' ) + ')[ >]');\n\n\t\t\t\t\tvar i = 0,\n\t\t\t\t\tcodeLength = code.length,\n\t\t\t\t\tpoint = 0,\n\t\t\t\t\tstart = null,\n\t\t\t\t\tend = null,\n\t\t\t\t\ttag = '',\n\t\t\t\t\tout = '',\n\t\t\t\t\tcont = '';\n\n\t\t\t\t\tthis.tabifier.cleanlevel = 0;\n\n\t\t\t\t\tfor (; i < codeLength; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tpoint = i;\n\n\t\t\t\t\t\t// if no more tags, copy and exit\n\t\t\t\t\t\tif (-1 == code.substr(i).indexOf( '<' ))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tout += code.substr(i);\n\n\t\t\t\t\t\t\treturn this.tabifier.finish(out);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// copy verbatim until a tag\n\t\t\t\t\t\twhile (point < codeLength && code.charAt(point) != '<')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpoint++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (i != point)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcont = code.substr(i, point - i);\n\t\t\t\t\t\t\tif (!cont.match(/^\\s{2,}$/g))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\n\t\t\t\t\t\t\t\telse if ('\\n' == cont.charAt(0))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tout += '\\n' + this.tabifier.getTabs();\n\t\t\t\t\t\t\t\t\tcont = cont.replace(/^\\s+/, '');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tout += cont;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (cont.match(/\\n/)) out += '\\n' + this.tabifier.getTabs();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = point;\n\n\t\t\t\t\t\t// find the end of the tag\n\t\t\t\t\t\twhile (point < codeLength && '>' != code.charAt(point))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpoint++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttag = code.substr(start, point - start);\n\t\t\t\t\t\ti = point;\n\n\t\t\t\t\t\tvar t;\n\n\t\t\t\t\t\tif ('!--' == tag.substr(1, 3))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (!tag.match(/--$/))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twhile ('-->' != code.substr(point, 3))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpoint++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpoint += 2;\n\t\t\t\t\t\t\t\ttag = code.substr(start, point - start);\n\t\t\t\t\t\t\t\ti = point;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ('\\n' != out.charAt(out.length - 1)) out += '\\n';\n\n\t\t\t\t\t\t\tout += this.tabifier.getTabs();\n\t\t\t\t\t\t\tout += tag + '>\\n';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if ('!' == tag[1])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag + '>', out);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if ('?' == tag[1])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tout += tag + '>\\n';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (t = tag.match(/^<(script|style|pre)/i))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tt[1] = t[1].toLowerCase();\n\t\t\t\t\t\t\ttag = this.tabifier.cleanTag(tag);\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag, out);\n\t\t\t\t\t\t\tend = String(code.substr(i + 1)).toLowerCase().indexOf('</' + t[1]);\n\n\t\t\t\t\t\t\tif (end)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcont = code.substr(i + 1, end);\n\t\t\t\t\t\t\t\ti += end;\n\t\t\t\t\t\t\t\tout += cont;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttag = this.tabifier.cleanTag(tag);\n\t\t\t\t\t\t\tout = this.tabifier.placeTag(tag, out);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.tabifier.finish(out);\n\t\t\t\t},\n\t\t\t\tgetTabs: function()\n\t\t\t\t{\n\t\t\t\t\tvar s = '';\n\t\t\t\t\tfor ( var j = 0; j < this.tabifier.cleanlevel; j++ )\n\t\t\t\t\t{\n\t\t\t\t\t\ts += '\\t';\n\t\t\t\t\t}\n\n\t\t\t\t\treturn s;\n\t\t\t\t},\n\t\t\t\tfinish: function(code)\n\t\t\t\t{\n\t\t\t\t\tcode = code.replace(/\\n\\s*\\n/g, '\\n');\n\t\t\t\t\tcode = code.replace(/^[\\s\\n]*/, '');\n\t\t\t\t\tcode = code.replace(/[\\s\\n]*$/, '');\n\t\t\t\t\tcode = code.replace(/<script(.*?)>\\n<\\/script>/gi, '<script$1></script>');\n\n\t\t\t\t\tthis.tabifier.cleanlevel = 0;\n\n\t\t\t\t\treturn code;\n\t\t\t\t},\n\t\t\t\tcleanTag: function (tag)\n\t\t\t\t{\n\t\t\t\t\tvar tagout = '';\n\t\t\t\t\ttag = tag.replace(/\\n/g, ' ');\n\t\t\t\t\ttag = tag.replace(/\\s{2,}/g, ' ');\n\t\t\t\t\ttag = tag.replace(/^\\s+|\\s+$/g, ' ');\n\n\t\t\t\t\tvar suffix = '';\n\t\t\t\t\tif (tag.match(/\\/$/))\n\t\t\t\t\t{\n\t\t\t\t\t\tsuffix = '/';\n\t\t\t\t\t\ttag = tag.replace(/\\/+$/, '');\n\t\t\t\t\t}\n\n\t\t\t\t\tvar m;\n\t\t\t\t\twhile (m = /\\s*([^= ]+)(?:=((['\"']).*?\\3|[^ ]+))?/.exec(tag))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (m[2]) tagout += m[1].toLowerCase() + '=' + m[2];\n\t\t\t\t\t\telse if (m[1]) tagout += m[1].toLowerCase();\n\n\t\t\t\t\t\ttagout += ' ';\n\t\t\t\t\t\ttag = tag.substr(m[0].length);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn tagout.replace(/\\s*$/, '') + suffix + '>';\n\t\t\t\t},\n\t\t\t\tplaceTag: function (tag, out)\n\t\t\t\t{\n\t\t\t\t\tvar nl = tag.match(this.tabifier.newLevel);\n\n\t\t\t\t\tif (tag.match(this.tabifier.lineBefore) || nl)\n\t\t\t\t\t{\n\t\t\t\t\t\tout = out.replace(/\\s*$/, '');\n\t\t\t\t\t\tout += '\\n';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (nl && '/' == tag.charAt(1)) this.tabifier.cleanlevel--;\n\t\t\t\t\tif ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\n\t\t\t\t\tif (nl && '/' != tag.charAt(1)) this.tabifier.cleanlevel++;\n\n\t\t\t\t\tout += tag;\n\n\t\t\t\t\tif (tag.match(this.tabifier.lineAfter) || tag.match(this.tabifier.newLevel))\n\t\t\t\t\t{\n\t\t\t\t\t\tout = out.replace(/ *$/, '');\n\t\t\t\t\t\t//out += '\\n';\n\t\t\t\t\t}\n\n\t\t\t\t\treturn out;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\ttidy: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsetupAllowed: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.allowedTags) this.opts.deniedTags = false;\n\t\t\t\t\tif (this.opts.allowedAttr) this.opts.removeAttr = false;\n\n\t\t\t\t\tif (this.opts.linebreaks) return;\n\n\t\t\t\t\tvar tags = ['p', 'section'];\n\t\t\t\t\tif (this.opts.allowedTags) this.tidy.addToAllowed(tags);\n\t\t\t\t\tif (this.opts.deniedTags) this.tidy.removeFromDenied(tags);\n\n\t\t\t\t},\n\t\t\t\taddToAllowed: function(tags)\n\t\t\t\t{\n\t\t\t\t\tvar len = tags.length;\n\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($.inArray(tags[i], this.opts.allowedTags) == -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.opts.allowedTags.push(tags[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveFromDenied: function(tags)\n\t\t\t\t{\n\t\t\t\t\tvar len = tags.length;\n\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar pos = $.inArray(tags[i], this.opts.deniedTags);\n\t\t\t\t\t\tif (pos != -1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.opts.deniedTags.splice(pos, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tload: function(html, options)\n\t\t\t\t{\n\t\t\t\t\tthis.tidy.settings = {\n\t\t\t\t\t\tdeniedTags: this.opts.deniedTags,\n\t\t\t\t\t\tallowedTags: this.opts.allowedTags,\n\t\t\t\t\t\tremoveComments: this.opts.removeComments,\n\t\t\t\t\t\treplaceTags: this.opts.replaceTags,\n\t\t\t\t\t\treplaceStyles: this.opts.replaceStyles,\n\t\t\t\t\t\tremoveDataAttr: this.opts.removeDataAttr,\n\t\t\t\t\t\tremoveAttr: this.opts.removeAttr,\n\t\t\t\t\t\tallowedAttr: this.opts.allowedAttr,\n\t\t\t\t\t\tremoveWithoutAttr: this.opts.removeWithoutAttr,\n\t\t\t\t\t\tremoveEmpty: this.opts.removeEmpty\n\t\t\t\t\t};\n\n\t\t\t\t\t$.extend(this.tidy.settings, options);\n\n\t\t\t\t\thtml = this.tidy.removeComments(html);\n\n\t\t\t\t\t// create container\n\t\t\t\t\tthis.tidy.$div = $('<div />').append(html);\n\n\t\t\t\t\t// clean\n\t\t\t\t\tthis.tidy.replaceTags();\n\t\t\t\t\tthis.tidy.replaceStyles();\n\t\t\t\t\tthis.tidy.removeTags();\n\n\t\t\t\t\tthis.tidy.removeAttr();\n\t\t\t\t\tthis.tidy.removeEmpty();\n\t\t\t\t\tthis.tidy.removeParagraphsInLists();\n\t\t\t\t\tthis.tidy.removeDataAttr();\n\t\t\t\t\tthis.tidy.removeWithoutAttr();\n\n\t\t\t\t\thtml = this.tidy.$div.html();\n\t\t\t\t\tthis.tidy.$div.remove();\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\tremoveComments: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.removeComments) return html;\n\n\t\t\t\t\treturn html.replace(/<!--[\\s\\S]*?-->/gi, '');\n\t\t\t\t},\n\t\t\t\treplaceTags: function(html)\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.replaceTags) return html;\n\n\t\t\t\t\tvar len = this.tidy.settings.replaceTags.length;\n\t\t\t\t\tvar replacement = [], rTags = [];\n\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\trTags.push(this.tidy.settings.replaceTags[i][1]);\n\t\t\t\t\t\treplacement.push(this.tidy.settings.replaceTags[i][0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.tidy.$div.find(replacement.join(',')).each($.proxy(function(n,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar tag = rTags[n];\n\t\t\t\t\t\t$(s).replaceWith(function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar replaced = $('<' + tag + ' />').append($(this).contents());\n\n\t\t\t\t\t\t\tfor (var i = 0; i < this.attributes.length; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treplaced.attr(this.attributes[i].name, this.attributes[i].value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn replaced;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn html;\n\t\t\t\t},\n\t\t\t\treplaceStyles: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.replaceStyles) return;\n\n\t\t\t\t\tvar len = this.tidy.settings.replaceStyles.length;\n\t\t\t\t\tthis.tidy.$div.find('span').each($.proxy(function(n,s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(s);\n\t\t\t\t\t\tvar style = $el.attr('style');\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (style && style.match(new RegExp('^' + this.tidy.settings.replaceStyles[i][0], 'i')))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar tagName = this.tidy.settings.replaceStyles[i][1];\n\t\t\t\t\t\t\t\t$el.replaceWith(function()\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar tag = document.createElement(tagName);\n\t\t\t\t\t\t\t\t\treturn $(tag).append($(this).contents());\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t},\n\t\t\t\tremoveTags: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.deniedTags && this.tidy.settings.allowedTags)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.tidy.$div.find('*').not(this.tidy.settings.allowedTags.join(',')).each(function(i, s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (s.innerHTML === '') $(s).remove();\n\t\t\t\t\t\t\telse $(s).contents().unwrap();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.tidy.settings.deniedTags)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.deniedTags.join(',')).each(function(i, s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (s.innerHTML === '') $(s).remove();\n\t\t\t\t\t\t\telse $(s).contents().unwrap();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveAttr: function()\n\t\t\t\t{\n\t\t\t\t\tvar len;\n\t\t\t\t\tif (!this.tidy.settings.removeAttr && this.tidy.settings.allowedAttr)\n\t\t\t\t\t{\n\n\t\t\t\t\t\tvar allowedAttrTags = [], allowedAttrData = [];\n\t\t\t\t\t\tlen = this.tidy.settings.allowedAttr.length;\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tallowedAttrTags.push(this.tidy.settings.allowedAttr[i][0]);\n\t\t\t\t\t\t\tallowedAttrData.push(this.tidy.settings.allowedAttr[i][1]);\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tthis.tidy.$div.find('*').each($.proxy(function(n,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar $el = $(s);\n\t\t\t\t\t\t\tvar pos = $.inArray($el[0].tagName.toLowerCase(), allowedAttrTags);\n\t\t\t\t\t\t\tvar attributesRemove = this.tidy.removeAttrGetRemoves(pos, allowedAttrData, $el);\n\n\t\t\t\t\t\t\tif (attributesRemove)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t$.each(attributesRemove, function(z,f) {\n\t\t\t\t\t\t\t\t\t$el.removeAttr(f);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.tidy.settings.removeAttr)\n\t\t\t\t\t{\n\t\t\t\t\t\tlen = this.tidy.settings.removeAttr.length;\n\t\t\t\t\t\tfor (var i = 0; i < len; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar attrs = this.tidy.settings.removeAttr[i][1];\n\t\t\t\t\t\t\tif ($.isArray(attrs)) attrs = attrs.join(' ');\n\n\t\t\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeAttr[i][0]).removeAttr(attrs);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tremoveAttrGetRemoves: function(pos, allowed, $el)\n\t\t\t\t{\n\t\t\t\t\tvar attributesRemove = [];\n\n\t\t\t\t\t// remove all attrs\n\t\t\t\t\tif (pos == -1)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each($el[0].attributes, function(i, item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattributesRemove.push(item.name);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\t\t\t\t\t// allow all attrs\n\t\t\t\t\telse if (allowed[pos] == '*')\n\t\t\t\t\t{\n\t\t\t\t\t\tattributesRemove = [];\n\t\t\t\t\t}\n\t\t\t\t\t// allow specific attrs\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each($el[0].attributes, function(i, item)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif ($.isArray(allowed[pos]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif ($.inArray(item.name, allowed[pos]) == -1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattributesRemove.push(item.name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (allowed[pos] != item.name)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattributesRemove.push(item.name);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn attributesRemove;\n\t\t\t\t},\n\t\t\t\tremoveAttrs: function (el, regex)\n\t\t\t\t{\n\t\t\t\t\tregex = new RegExp(regex, \"g\");\n\t\t\t\t\treturn el.each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar self = $(this);\n\t\t\t\t\t\tvar len = this.attributes.length - 1;\n\t\t\t\t\t\tfor (var i = len; i >= 0; i--)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar item = this.attributes[i];\n\t\t\t\t\t\t\tif (item && item.specified && item.name.search(regex)>=0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tself.removeAttr(item.name);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveEmpty: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.removeEmpty) return;\n\n\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeEmpty.join(',')).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tvar $el = $(this);\n\t\t\t\t\t\tvar text = $el.text();\n\t\t\t\t\t\ttext = text.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\t\t\t\t\t\ttext = text.replace(/&nbsp;/gi, '');\n\t\t\t\t\t\ttext = text.replace(/\\s/g, '');\n\n\t\t    \t    \tif (text === '' && $el.children().length === 0)\n\t\t    \t    \t{\n\t\t\t    \t    \t$el.remove();\n\t\t    \t    \t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremoveParagraphsInLists: function()\n\t\t\t\t{\n\t\t\t\t\tthis.tidy.$div.find('li p').contents().unwrap();\n\t\t\t\t},\n\t\t\t\tremoveDataAttr: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.removeDataAttr) return;\n\n\t\t\t\t\tvar tags = this.tidy.settings.removeDataAttr;\n\t\t\t\t\tif ($.isArray(this.tidy.settings.removeDataAttr)) tags = this.tidy.settings.removeDataAttr.join(',');\n\n\t\t\t\t\tthis.tidy.removeAttrs(this.tidy.$div.find(tags), '^(data-)');\n\n\t\t\t\t},\n\t\t\t\tremoveWithoutAttr: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.tidy.settings.removeWithoutAttr) return;\n\n\t\t\t\t\tthis.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(',')).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.attributes.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$(this).contents().unwrap();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\ttoolbar: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function()\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\thtml:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('html'),\n\t\t\t\t\t\t\tfunc: 'code.toggle'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tformatting:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('formatting'),\n\t\t\t\t\t\t\tdropdown:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tp:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('paragraph'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tblockquote:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('quote'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tpre:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('code'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\th1:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header1'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\th2:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header2'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\th3:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header3'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\th4:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header4'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\th5:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('header5'),\n\t\t\t\t\t\t\t\t\tfunc: 'block.format'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbold:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('bold'),\n\t\t\t\t\t\t\tfunc: 'inline.format'\n\t\t\t\t\t\t},\n\t\t\t\t\t\titalic:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('italic'),\n\t\t\t\t\t\t\tfunc: 'inline.format'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdeleted:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('deleted'),\n\t\t\t\t\t\t\tfunc: 'inline.format'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tunderline:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('underline'),\n\t\t\t\t\t\t\tfunc: 'inline.format'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tunorderedlist:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: '&bull; ' + this.lang.get('unorderedlist'),\n\t\t\t\t\t\t\tfunc: 'list.toggle'\n\t\t\t\t\t\t},\n\t\t\t\t\t\torderedlist:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: '1. ' + this.lang.get('orderedlist'),\n\t\t\t\t\t\t\tfunc: 'list.toggle'\n\t\t\t\t\t\t},\n\t\t\t\t\t\toutdent:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: '< ' + this.lang.get('outdent'),\n\t\t\t\t\t\t\tfunc: 'indent.decrease'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tindent:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: '> ' + this.lang.get('indent'),\n\t\t\t\t\t\t\tfunc: 'indent.increase'\n\t\t\t\t\t\t},\n\t\t\t\t\t\timage:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('image'),\n\t\t\t\t\t\t\tfunc: 'image.show'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfile:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('file'),\n\t\t\t\t\t\t\tfunc: 'file.show'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlink:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('link'),\n\t\t\t\t\t\t\tdropdown:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlink:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('link_insert'),\n\t\t\t\t\t\t\t\t\tfunc: 'link.show'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tunlink:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('unlink'),\n\t\t\t\t\t\t\t\t\tfunc: 'link.unlink'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\talignment:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('alignment'),\n\t\t\t\t\t\t\tdropdown:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tleft:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_left'),\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.left'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcenter:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_center'),\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.center'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tright:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_right'),\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.right'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tjustify:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttitle: this.lang.get('align_justify'),\n\t\t\t\t\t\t\t\t\tfunc: 'alignment.justify'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\thorizontalrule:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: this.lang.get('horizontalrule'),\n\t\t\t\t\t\t\tfunc: 'line.insert'\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tbuild: function()\n\t\t\t\t{\n\t\t\t\t\tthis.toolbar.hideButtons();\n\t\t\t\t\tthis.toolbar.hideButtonsOnMobile();\n\t\t\t\t\tthis.toolbar.isButtonSourceNeeded();\n\n\t\t\t\t\tif (this.opts.buttons.length === 0) return;\n\n\t\t\t\t\tthis.$toolbar = this.toolbar.createContainer();\n\n\t\t\t\t\tthis.toolbar.setOverflow();\n\t\t\t\t\tthis.toolbar.append();\n\t\t\t\t\tthis.toolbar.setFormattingTags();\n\t\t\t\t\tthis.toolbar.loadButtons();\n\t\t\t\t\tthis.toolbar.setFixed();\n\n\t\t\t\t\t// buttons response\n\t\t\t\t\tif (this.opts.activeButtons)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$editor.on('mouseup.redactor keyup.redactor focus.redactor', $.proxy(this.observe.buttons, this));\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tcreateContainer: function()\n\t\t\t\t{\n\t\t\t\t\treturn $('<ul>').addClass('redactor-toolbar').attr('id', 'redactor-toolbar-' + this.uuid);\n\t\t\t\t},\n\t\t\t\tsetFormattingTags: function()\n\t\t\t\t{\n\t\t\t\t\t$.each(this.opts.toolbar.formatting.dropdown, $.proxy(function (i, s)\n\t\t\t\t\t{\n\t\t\t\t\t\tif ($.inArray(i, this.opts.formatting) == -1) delete this.opts.toolbar.formatting.dropdown[i];\n\t\t\t\t\t}, this));\n\n\t\t\t\t},\n\t\t\t\tloadButtons: function()\n\t\t\t\t{\n\t\t\t\t\t$.each(this.opts.buttons, $.proxy(function(i, btnName)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!this.opts.toolbar[btnName]) return;\n\n\t\t\t\t\t\tif (btnName === 'file')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t if (this.opts.fileUpload === false) return;\n\t\t\t\t\t\t\t else if (!this.opts.fileUpload && this.opts.s3 === false) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (btnName === 'image')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t if (this.opts.imageUpload === false) return;\n\t\t\t\t\t\t\t else if (!this.opts.imageUpload && this.opts.s3 === false) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar btnObject = this.opts.toolbar[btnName];\n\t\t\t\t\t\tthis.$toolbar.append($('<li>').append(this.button.build(btnName, btnObject)));\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tappend: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.toolbarExternal)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$toolbar.addClass('redactor-toolbar-external');\n\t\t\t\t\t\t$(this.opts.toolbarExternal).html(this.$toolbar);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$box.prepend(this.$toolbar);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetFixed: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.isDesktop()) return;\n\t\t\t\t\tif (this.opts.toolbarExternal) return;\n\t\t\t\t\tif (!this.opts.toolbarFixed) return;\n\n\t\t\t\t\tthis.toolbar.observeScroll();\n\t\t\t\t\t$(this.opts.toolbarFixedTarget).on('scroll.redactor.' + this.uuid, $.proxy(this.toolbar.observeScroll, this));\n\n\t\t\t\t},\n\t\t\t\tsetOverflow: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.utils.isMobile() && this.opts.toolbarOverflow)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$toolbar.addClass('redactor-toolbar-overflow');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisButtonSourceNeeded: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.source) return;\n\n\t\t\t\t\tvar index = this.opts.buttons.indexOf('html');\n\t\t\t\t\tif (index !== -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thideButtons: function()\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.buttonsHide.length === 0) return;\n\n\t\t\t\t\t$.each(this.opts.buttonsHide, $.proxy(function(i, s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar index = this.opts.buttons.indexOf(s);\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\thideButtonsOnMobile: function()\n\t\t\t\t{\n\t\t\t\t\tif (!this.utils.isMobile() || this.opts.buttonsHideOnMobile.length === 0) return;\n\n\t\t\t\t\t$.each(this.opts.buttonsHideOnMobile, $.proxy(function(i, s)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar index = this.opts.buttons.indexOf(s);\n\t\t\t\t\t\tthis.opts.buttons.splice(index, 1);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tobserveScroll: function()\n\t\t\t\t{\n\t\t\t\t\tvar scrollTop = $(this.opts.toolbarFixedTarget).scrollTop();\n\t\t\t\t\tvar boxTop = 1;\n\n\t\t\t\t\tif (this.opts.toolbarFixedTarget === document)\n\t\t\t\t\t{\n\t\t\t\t\t\tboxTop = this.$box.offset().top;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (scrollTop > boxTop)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.toolbar.observeScrollEnable(scrollTop, boxTop);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.toolbar.observeScrollDisable();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tobserveScrollEnable: function(scrollTop, boxTop)\n\t\t\t\t{\n\t\t\t\t\tvar top = this.opts.toolbarFixedTopOffset + scrollTop - boxTop;\n\t\t\t\t\tvar left = 0;\n\t\t\t\t\tvar end = boxTop + this.$box.height() - 32;\n\t\t\t\t\tvar width = this.$box.innerWidth();\n\n\t\t\t\t\tthis.$toolbar.addClass('toolbar-fixed-box');\n\t\t\t\t\tthis.$toolbar.css({\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\ttop: top + 'px',\n\t\t\t\t\t\tleft: left\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.toolbar.setDropdownsFixed();\n\t\t\t\t\tthis.$toolbar.css('visibility', (scrollTop < end) ? 'visible' : 'hidden');\n\t\t\t\t},\n\t\t\t\tobserveScrollDisable: function()\n\t\t\t\t{\n\t\t\t\t\tthis.$toolbar.css({\n\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\twidth: 'auto',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\tvisibility: 'visible'\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.toolbar.unsetDropdownsFixed();\n\t\t\t\t\tthis.$toolbar.removeClass('toolbar-fixed-box');\n\n\n\t\t\t\t},\n\t\t\t\tsetDropdownsFixed: function()\n\t\t\t\t{\n\t\t\t\t\tvar top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\n\t\t\t\t\tvar position = 'fixed';\n\t\t\t\t\tif (this.opts.toolbarFixedTarget !== document)\n\t\t\t\t\t{\n\t\t\t\t\t\ttop = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\n\t\t\t\t\t\tposition = 'absolute';\n\t\t\t\t\t}\n\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this).css({ position: position, top: top + 'px' });\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tunsetDropdownsFixed: function()\n\t\t\t\t{\n\t\t\t\t\tvar top = (this.$toolbar.innerHeight() + this.$toolbar.offset().top);\n\t\t\t\t\t$('.redactor-dropdown-' + this.uuid).each(function()\n\t\t\t\t\t{\n\t\t\t\t\t\t$(this).css({ position: 'absolute', top: top + 'px' });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tupload: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tinit: function(id, url, callback)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.direct = false;\n\t\t\t\t\tthis.upload.callback = callback;\n\t\t\t\t\tthis.upload.url = url;\n\t\t\t\t\tthis.upload.$el = $(id);\n\t\t\t\t\tthis.upload.$droparea = $('<div id=\"redactor-droparea\" />');\n\n\t\t\t\t\tthis.upload.$placeholdler = $('<div id=\"redactor-droparea-placeholder\" />').text(this.lang.get('upload_label'));\n\t\t\t\t\tthis.upload.$input = $('<input type=\"file\" name=\"file\" />');\n\n\t\t\t\t\tthis.upload.$placeholdler.append(this.upload.$input);\n\t\t\t\t\tthis.upload.$droparea.append(this.upload.$placeholdler);\n\t\t\t\t\tthis.upload.$el.append(this.upload.$droparea);\n\n\t\t\t\t\tthis.upload.$droparea.off('redactor.upload');\n\t\t\t\t\tthis.upload.$input.off('redactor.upload');\n\n\t\t\t\t\tthis.upload.$droparea.on('dragover.redactor.upload', $.proxy(this.upload.onDrag, this));\n\t\t\t\t\tthis.upload.$droparea.on('dragleave.redactor.upload', $.proxy(this.upload.onDragLeave, this));\n\n\t\t\t\t\t// change\n\t\t\t\t\tthis.upload.$input.on('change.redactor.upload', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\te = e.originalEvent || e;\n\t\t\t\t\t\tthis.upload.traverseFile(this.upload.$input[0].files[0], e);\n\t\t\t\t\t}, this));\n\n\t\t\t\t\t// drop\n\t\t\t\t\tthis.upload.$droparea.on('drop.redactor.upload', $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-hover').addClass('drag-drop');\n\t\t\t\t\t\tthis.upload.onDrop(e);\n\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\tdirectUpload: function(file, e)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.direct = true;\n\t\t\t\t\tthis.upload.traverseFile(file, e);\n\t\t\t\t},\n\t\t\t\tonDrop: function(e)\n\t\t\t\t{\n\t\t\t\t\te = e.originalEvent || e;\n\t\t\t\t\tvar files = e.dataTransfer.files;\n\n\t\t\t\t\tthis.upload.traverseFile(files[0], e);\n\t\t\t\t},\n\t\t\t\ttraverseFile: function(file, e)\n\t\t\t\t{\n\t\t\t\t\tif (this.opts.s3)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.upload.setConfig(file);\n\t\t\t\t\t\tthis.upload.s3uploadFile(file);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar formData = !!window.FormData ? new FormData() : null;\n\t\t\t\t\tif (window.FormData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.upload.setConfig(file);\n\n\t\t\t\t\t\tvar name = (this.upload.type == 'image') ? this.opts.imageUploadParam : this.opts.fileUploadParam;\n\t\t\t\t\t\tformData.append(name, file);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.progress.show();\n\t\t\t\t\tthis.core.setCallback('uploadStart', e, formData);\n\t\t\t\t\tthis.upload.sendData(formData, e);\n\t\t\t\t},\n\t\t\t\tsetConfig: function(file)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.getType(file);\n\n\t\t\t\t\tif (this.upload.direct)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.upload.url = (this.upload.type == 'image') ? this.opts.imageUpload : this.opts.fileUpload;\n\t\t\t\t\t\tthis.upload.callback = (this.upload.type == 'image') ? this.image.insert : this.file.insert;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetType: function(file)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.type = 'image';\n\t\t\t\t\tif (this.opts.imageTypes.indexOf(file.type) == -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.upload.type = 'file';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetHiddenFields: function(obj, fd)\n\t\t\t\t{\n\t\t\t\t\tif (obj === false || typeof obj !== 'object') return fd;\n\n\t\t\t\t\t$.each(obj, $.proxy(function(k, v)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\n\t\t\t\t\t\tfd.append(k, v);\n\n\t\t\t\t\t}, this));\n\n\t\t\t\t\treturn fd;\n\n\t\t\t\t},\n\t\t\t\tsendData: function(formData, e)\n\t\t\t\t{\n\t\t\t\t\t// append hidden fields\n\t\t\t\t\tif (this.upload.type == 'image')\n\t\t\t\t\t{\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.opts.uploadImageFields, formData);\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.upload.imageFields, formData);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.opts.uploadFileFields, formData);\n\t\t\t\t\t\tformData = this.upload.getHiddenFields(this.upload.fileFields, formData);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\t\txhr.open('POST', this.upload.url);\n\n\t\t\t\t\t// complete\n\t\t\t\t\txhr.onreadystatechange = $.proxy(function()\n\t\t\t\t\t{\n\t\t\t\t\t    if (xhr.readyState == 4)\n\t\t\t\t\t    {\n\t\t\t\t\t        var data = xhr.responseText;\n\n\t\t\t\t\t\t\tdata = data.replace(/^\\[/, '');\n\t\t\t\t\t\t\tdata = data.replace(/\\]$/, '');\n\n\t\t\t\t\t\t\tvar json;\n\t\t\t\t\t\t\ttry\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tjson = (typeof data === 'string' ? $.parseJSON(data) : data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch(err)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tjson = {\n\t\t\t\t\t\t\t\t\terror: true\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tthis.progress.hide();\n\n\t\t\t\t\t\t\tif (!this.upload.direct)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-drop');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.upload.callback(json, this.upload.direct, e);\n\t\t\t\t\t    }\n\t\t\t\t\t}, this);\n\n\n\t\t\t\t\t/*\n\t\t\t\t\txhr.upload.onprogress = $.proxy(function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (e.lengthComputable)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar complete = (e.loaded / e.total * 100 | 0);\n\t\t\t\t\t\t\t//progress.value = progress.innerHTML = complete;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, this);\n\t\t\t\t\t*/\n\n\n\t\t\t\t\txhr.send(formData);\n\t\t\t\t},\n\t\t\t\tonDrag: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.upload.$droparea.addClass('drag-hover');\n\t\t\t\t},\n\t\t\t\tonDragLeave: function(e)\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.upload.$droparea.removeClass('drag-hover');\n\t\t\t\t},\n\t\t\t\tclearImageFields: function()\n\t\t\t\t{\n\t\t\t\t\tthis.upload.imageFields = {};\n\t\t\t\t},\n\t\t\t\taddImageFields: function(name, value)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.imageFields[name] = value;\n\t\t\t\t},\n\t\t\t\tremoveImageFields: function(name)\n\t\t\t\t{\n\t\t\t\t\tdelete this.upload.imageFields[name];\n\t\t\t\t},\n\t\t\t\tclearFileFields: function()\n\t\t\t\t{\n\t\t\t\t\tthis.upload.fileFields = {};\n\t\t\t\t},\n\t\t\t\taddFileFields: function(name, value)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.fileFields[name] = value;\n\t\t\t\t},\n\t\t\t\tremoveFileFields: function(name)\n\t\t\t\t{\n\t\t\t\t\tdelete this.upload.fileFields[name];\n\t\t\t\t},\n\n\n\t\t\t\t// S3\n\t\t\t\ts3uploadFile: function(file)\n\t\t\t\t{\n\t\t\t\t\tthis.upload.s3executeOnSignedUrl(file, $.proxy(function(signedURL)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.upload.s3uploadToS3(file, signedURL);\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\ts3executeOnSignedUrl: function(file, callback)\n\t\t\t\t{\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\n\n\t\t\t\t\tvar mark = '?';\n\t\t\t\t\tif (this.opts.s3.search(/\\?/) != '-1') mark = '&';\n\n\t\t\t\t\txhr.open('GET', this.opts.s3 + mark + 'name=' + file.name + '&type=' + file.type, true);\n\n\t\t\t\t\t// Hack to pass bytes through unprocessed.\n\t\t\t\t\tif (xhr.overrideMimeType) xhr.overrideMimeType('text/plain; charset=x-user-defined');\n\n\t\t\t\t\tvar that = this;\n\t\t\t\t\txhr.onreadystatechange = function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.readyState == 4 && this.status == 200)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthat.progress.show();\n\t\t\t\t\t\t\tcallback(decodeURIComponent(this.responseText));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (this.readyState == 4 && this.status != 200)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//setProgress(0, 'Could not contact signing script. Status = ' + this.status);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\txhr.send();\n\t\t\t\t},\n\t\t\t\ts3createCORSRequest: function(method, url)\n\t\t\t\t{\n\t\t\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\t\t\tif (\"withCredentials\" in xhr)\n\t\t\t\t\t{\n\t\t\t\t\t\txhr.open(method, url, true);\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof XDomainRequest != \"undefined\")\n\t\t\t\t\t{\n\t\t\t\t\t\txhr = new XDomainRequest();\n\t\t\t\t\t\txhr.open(method, url);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\txhr = null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn xhr;\n\t\t\t\t},\n\t\t\t\ts3uploadToS3: function(file, url)\n\t\t\t\t{\n\t\t\t\t\tvar xhr = this.upload.s3createCORSRequest('PUT', url);\n\t\t\t\t\tif (!xhr)\n\t\t\t\t\t{\n\t\t\t\t\t\t//setProgress(0, 'CORS not supported');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\txhr.onload = $.proxy(function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (xhr.status == 200)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//setProgress(100, 'Upload completed.');\n\n\t\t\t\t\t\t\t\tthis.progress.hide();\n\n\t\t\t\t\t\t\t\tvar s3file = url.split('?');\n\n\t\t\t\t\t\t\t\tif (!s3file[0])\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t // url parsing is fail\n\t\t\t\t\t\t\t\t\t return false;\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\tif (!this.upload.direct)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.upload.$droparea.removeClass('drag-drop');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvar json = { filelink: s3file[0] };\n\t\t\t\t\t\t\t\tif (this.upload.type == 'file')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar arr = s3file[0].split('/');\n\t\t\t\t\t\t\t\t\tjson.filename = arr[arr.length-1];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.upload.callback(json, this.upload.direct, false);\n\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//setProgress(0, 'Upload error: ' + xhr.status);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this);\n\n\t\t\t\t\t\txhr.onerror = function()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//setProgress(0, 'XHR error.');\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\txhr.upload.onprogress = function(e)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\tif (e.lengthComputable)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar percentLoaded = Math.round((e.loaded / e.total) * 100);\n\t\t\t\t\t\t\t\tsetProgress(percentLoaded, percentLoaded == 100 ? 'Finalizing.' : 'Uploading.');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\txhr.setRequestHeader('Content-Type', file.type);\n\t\t\t\t\t\txhr.setRequestHeader('x-amz-acl', 'public-read');\n\n\t\t\t\t\t\txhr.send(file);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tutils: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\tisMobile: function()\n\t\t\t\t{\n\t\t\t\t\treturn /(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent);\n\t\t\t\t},\n\t\t\t\tisDesktop: function()\n\t\t\t\t{\n\t\t\t\t\treturn !/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent);\n\t\t\t\t},\n\t\t\t\tisString: function(obj)\n\t\t\t\t{\n\t\t\t\t\treturn Object.prototype.toString.call(obj) == '[object String]';\n\t\t\t\t},\n\t\t\t\tisEmpty: function(html, removeEmptyTags)\n\t\t\t\t{\n\t\t\t\t\thtml = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\t\t\t\t\thtml = html.replace(/&nbsp;/gi, '');\n\t\t\t\t\thtml = html.replace(/<\\/?br\\s?\\/?>/g, '');\n\t\t\t\t\thtml = html.replace(/\\s/g, '');\n\t\t\t\t\thtml = html.replace(/^<p>[^\\W\\w\\D\\d]*?<\\/p>$/i, '');\n\t\t\t\t\thtml = html.replace(/<iframe(.*?[^>])>$/i, 'iframe');\n\t\t\t\t\thtml = html.replace(/<source(.*?[^>])>$/i, 'source');\n\n\t\t\t\t\t// remove empty tags\n\t\t\t\t\tif (removeEmptyTags !== false)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\n\t\t\t\t\t\thtml = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\n\t\t\t\t\t}\n\n\t\t\t\t\thtml = $.trim(html);\n\n\t\t\t\t\treturn html === '';\n\t\t\t\t},\n\t\t\t\tnormalize: function(str)\n\t\t\t\t{\n\t\t\t\t\tif (typeof(str) === 'undefined') return 0;\n\t\t\t\t\treturn parseInt(str.replace('px',''), 10);\n\t\t\t\t},\n\t\t\t\thexToRgb: function(hex)\n\t\t\t\t{\n\t\t\t\t\tif (typeof hex == 'undefined') return;\n\t\t\t\t\tif (hex.search(/^#/) == -1) return hex;\n\n\t\t\t\t\tvar shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n\t\t\t\t\thex = hex.replace(shorthandRegex, function(m, r, g, b)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn r + r + g + g + b + b;\n\t\t\t\t\t});\n\n\t\t\t\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\t\t\t\t\treturn 'rgb(' + parseInt(result[1], 16) + ', ' + parseInt(result[2], 16) + ', ' + parseInt(result[3], 16) + ')';\n\t\t\t\t},\n\t\t\t\tgetOuterHtml: function(el)\n\t\t\t\t{\n\t\t\t\t\treturn $('<div>').append($(el).eq(0).clone()).html();\n\t\t\t\t},\n\t\t\t\tgetAlignmentElement: function(el)\n\t\t\t\t{\n\t\t\t\t\tif ($.inArray(el.tagName, this.opts.alignmentTags) !== -1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn $(el);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn $(el).closest(this.opts.alignmentTags.toString().toLowerCase(), this.$editor[0]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveEmptyAttr: function(el, attr)\n\t\t\t\t{\n\t\t\t\t\tvar $el = $(el);\n\t\t\t\t\tif (typeof $el.attr(attr) == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($el.attr(attr) === '')\n\t\t\t\t\t{\n\t\t\t\t\t\t$el.removeAttr(attr);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tremoveEmpty: function(i, s)\n\t\t\t\t{\n\t\t\t\t\tvar $s = $(s);\n\n\t\t\t\t\t$s.find('.redactor-invisible-space').removeAttr('style').removeAttr('class');\n\n\t\t\t\t\tif ($s.find('hr, br, img, iframe, source').length !== 0) return;\n\t\t\t\t\tvar text = $.trim($s.text());\n\t\t\t\t\tif (this.utils.isEmpty(text, false))\n\t\t\t\t\t{\n\t\t\t\t\t\t$s.remove();\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// save and restore scroll\n\t\t\t\tsaveScroll: function()\n\t\t\t\t{\n\t\t\t\t\tthis.saveEditorScroll = this.$editor.scrollTop();\n\t\t\t\t\tthis.saveBodyScroll = $(window).scrollTop();\n\n\t\t\t\t\tif (this.opts.scrollTarget) this.saveTargetScroll = $(this.opts.scrollTarget).scrollTop();\n\t\t\t\t},\n\t\t\t\trestoreScroll: function()\n\t\t\t\t{\n\t\t\t\t\tif (typeof this.saveScroll === 'undefined' && typeof this.saveBodyScroll === 'undefined') return;\n\n\t\t\t\t\t$(window).scrollTop(this.saveBodyScroll);\n\t\t\t\t\tthis.$editor.scrollTop(this.saveEditorScroll);\n\n\t\t\t\t\tif (this.opts.scrollTarget) $(this.opts.scrollTarget).scrollTop(this.saveTargetScroll);\n\t\t\t\t},\n\n\t\t\t\t// get invisible space element\n\t\t\t\tcreateSpaceElement: function()\n\t\t\t\t{\n\t\t\t\t\tvar space = document.createElement('span');\n\t\t\t\t\tspace.className = 'redactor-invisible-space';\n\t\t\t\t\tspace.innerHTML = this.opts.invisibleSpace;\n\n\t\t\t\t\treturn space;\n\t\t\t\t},\n\n\t\t\t\t// replace\n\t\t\t\tremoveInlineTags: function(node)\n\t\t\t\t{\n\t\t\t\t\tvar tags = this.opts.inlineTags;\n\t\t\t\t\ttags.push('span');\n\n\t\t\t\t\tif (node.tagName == 'PRE') tags.push('a');\n\n\t\t\t\t\t$(node).find(tags.join(',')).not('span.redactor-selection-marker').contents().unwrap();\n\t\t\t\t},\n\t\t\t\treplaceWithContents: function(node, removeInlineTags)\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\t$(node).replaceWith(function()\n\t\t\t\t\t{\n\t\t\t\t\t\tif (removeInlineTags === true) self.utils.removeInlineTags(this);\n\n\t\t\t\t\t\treturn $(this).contents();\n\t\t\t\t\t});\n\n\t\t\t\t\treturn $(node);\n\t\t\t\t},\n\t\t\t\treplaceToTag: function(node, tag, removeInlineTags)\n\t\t\t\t{\n\t\t\t\t\tvar replacement;\n\t\t\t\t\tvar self = this;\n\t\t\t\t\t$(node).replaceWith(function()\n\t\t\t\t\t{\n\t\t\t\t\t\treplacement = $('<' + tag + ' />').append($(this).contents());\n\n\t\t\t\t\t\tfor (var i = 0; i < this.attributes.length; i++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treplacement.attr(this.attributes[i].name, this.attributes[i].value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (removeInlineTags === true) self.utils.removeInlineTags(replacement);\n\n\t\t\t\t\t\treturn replacement;\n\t\t\t\t\t});\n\n\t\t\t\t\treturn replacement;\n\t\t\t\t},\n\n\t\t\t\t// start and end of element\n\t\t\t\tisStartOfElement: function()\n\t\t\t\t{\n\t\t\t\t\tvar block = this.selection.getBlock();\n\t\t\t\t\tif (!block) return false;\n\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(block);\n\n\t\t\t\t\treturn (offset === 0) ? true : false;\n\t\t\t\t},\n\t\t\t\tisEndOfElement: function(element)\n\t\t\t\t{\n\t\t\t\t\tif (typeof element == 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tvar element = this.selection.getBlock();\n\t\t\t\t\t\tif (!element) return false;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(element);\n\t\t\t\t\tvar text = $.trim($(element).text()).replace(/\\n\\r\\n/g, '');\n\n\t\t\t\t\treturn (offset == text.length) ? true : false;\n\t\t\t\t},\n\t\t\t\tisEndOfEditor: function()\n\t\t\t\t{\n\t\t\t\t\tvar block = this.$editor[0];\n\n\t\t\t\t\tvar offset = this.caret.getOffsetOfElement(block);\n\t\t\t\t\tvar text = $.trim($(block).html().replace(/(<([^>]+)>)/gi,''));\n\n\t\t\t\t\treturn (offset == text.length) ? true : false;\n\t\t\t\t},\n\n\t\t\t\t// test blocks\n\t\t\t\tisBlock: function(block)\n\t\t\t\t{\n\t\t\t\t\tblock = block[0] || block;\n\n\t\t\t\t\treturn block && this.utils.isBlockTag(block.tagName);\n\t\t\t\t},\n\t\t\t\tisBlockTag: function(tag)\n\t\t\t\t{\n\t\t\t\t\tif (typeof tag == 'undefined') return false;\n\n\t\t\t\t\treturn this.reIsBlock.test(tag);\n\t\t\t\t},\n\n\t\t\t\t// tag detection\n\t\t\t\tisTag: function(current, tag)\n\t\t\t\t{\n\t\t\t\t\tvar element = $(current).closest(tag);\n\t\t\t\t\tif (element.length == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn element[0];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\n\t\t\t\t// select all\n\t\t\t\tisSelectAll: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.selectAll;\n\t\t\t\t},\n\t\t\t\tenableSelectAll: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selectAll = true;\n\t\t\t\t},\n\t\t\t\tdisableSelectAll: function()\n\t\t\t\t{\n\t\t\t\t\tthis.selectAll = false;\n\t\t\t\t},\n\n\t\t\t\t// parents detection\n\t\t\t\tisRedactorParent: function(el)\n\t\t\t\t{\n\t\t\t\t\tif (!el)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($(el).parents('.redactor-editor').length === 0 || $(el).hasClass('redactor-editor'))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn el;\n\t\t\t\t},\n\t\t\t\tisCurrentOrParentHeader: function()\n\t\t\t\t{\n\t\t\t\t\treturn this.utils.isCurrentOrParent(['H1', 'H2', 'H3', 'H4', 'H5', 'H6']);\n\t\t\t\t},\n\t\t\t\tisCurrentOrParent: function(tagName)\n\t\t\t\t{\n\t\t\t\t\tvar parent = this.selection.getParent();\n\t\t\t\t\tvar current = this.selection.getCurrent();\n\n\t\t\t\t\tif ($.isArray(tagName))\n\t\t\t\t\t{\n\t\t\t\t\t\tvar matched = 0;\n\t\t\t\t\t\t$.each(tagName, $.proxy(function(i, s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this.utils.isCurrentOrParentOne(current, parent, s))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmatched++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t\treturn (matched === 0) ? false : true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.utils.isCurrentOrParentOne(current, parent, tagName);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisCurrentOrParentOne: function(current, parent, tagName)\n\t\t\t\t{\n\t\t\t\t\ttagName = tagName.toUpperCase();\n\n\t\t\t\t\treturn parent && parent.tagName === tagName ? parent : current && current.tagName === tagName ? current : false;\n\t\t\t\t},\n\n\n\t\t\t\t// browsers detection\n\t\t\t\tisOldIe: function()\n\t\t\t\t{\n\t\t\t\t\treturn (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 9) ? true : false;\n\t\t\t\t},\n\t\t\t\tisLessIe10: function()\n\t\t\t\t{\n\t\t\t\t\treturn (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 10) ? true : false;\n\t\t\t\t},\n\t\t\t\tisIe11: function()\n\t\t\t\t{\n\t\t\t\t\treturn !!navigator.userAgent.match(/Trident\\/7\\./);\n\t\t\t\t},\n\t\t\t\tbrowser: function(browser)\n\t\t\t\t{\n\t\t\t\t\tvar ua = navigator.userAgent.toLowerCase();\n\t\t\t\t\tvar match = /(opr)[\\/]([\\w.]+)/.exec( ua ) ||\n\t\t            /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\n\t\t            /(webkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) ||\n\t\t            /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\n\t\t            /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\n\t\t            /(msie) ([\\w.]+)/.exec( ua ) ||\n\t\t            ua.indexOf(\"trident\") >= 0 && /(rv)(?::| )([\\w.]+)/.exec( ua ) ||\n\t\t            ua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\n\t\t            [];\n\n\t\t\t\t\tif (browser == 'safari') return (typeof match[3] != 'undefined') ? match[3] == 'safari' : false;\n\t\t\t\t\tif (browser == 'version') return match[2];\n\t\t\t\t\tif (browser == 'webkit') return (match[1] == 'chrome' || match[1] == 'opr' || match[1] == 'webkit');\n\t\t\t\t\tif (match[1] == 'rv') return browser == 'msie';\n\t\t\t\t\tif (match[1] == 'opr') return browser == 'webkit';\n\n\t\t\t\t\treturn browser == match[1];\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n\n\t$(window).on('load.tools.redactor', function()\n\t{\n\t\t$('[data-tools=\"redactor\"]').redactor();\n\t});\n\n\t// constructor\n\tRedactor.prototype.init.prototype = Redactor.prototype;\n\n\t// LINKIFY\n\t$.Redactor.fn.formatLinkify = function(protocol, convertLinks, convertUrlLinks, convertImageLinks, convertVideoLinks, linkSize)\n\t{\n\t\tvar urlCheck = '((?:http[s]?:\\\\/\\\\/(?:www\\\\.)?|www\\\\.){1}(?:[0-9A-Za-z\\\\-%_]+\\\\.)+[a-zA-Z]{2,}(?::[0-9]+)?(?:(?:/[0-9A-Za-z\\\\-#\\\\.%\\+_]*)+)?(?:\\\\?(?:[0-9A-Za-z\\\\-\\\\.%_]+(?:=[0-9A-Za-z\\\\-\\\\.%_\\\\+]*)?)?(?:&(?:[0-9A-Za-z\\\\-\\\\.%_]+(?:=[0-9A-Za-z\\\\-\\\\.%_\\\\+]*)?)?)*)?(?:#[0-9A-Za-z\\\\-\\\\.%_\\\\+=\\\\?&;]*)?)';\n\t\tvar regex = new RegExp(urlCheck, 'gi');\n\t\tvar rProtocol = /(https?|ftp):\\/\\//i;\n\t\tvar urlImage = new RegExp('(?:([^:/?#]+):)?(?:\\/\\/([^/?#]*))?([^?#]*\\\\.(?:jpg|gif|png))(?:\\\\?([^#]*))?(?:#(.*))?', 'gi');\n\n\t\tvar childNodes = (this.$editor ? this.$editor[0] : this).childNodes, i = childNodes.length;\n\t\twhile (i--)\n\t\t{\n\t\t\tvar n = childNodes[i];\n\n\t\t\tif (n.nodeType === 3 && n.parentNode !== 'PRE')\n\t\t\t{\n\t\t\t\tvar html = n.nodeValue;\n\n\t\t\t\t// youtube & vimeo\n\t\t\t\tif (convertVideoLinks && html)\n\t\t\t\t{\n\t\t\t\t\tvar iframeStart = '<iframe width=\"500\" height=\"281\" src=\"',\n\t\t\t\t\t\tiframeEnd = '\" frameborder=\"0\" allowfullscreen></iframe>';\n\n\t\t\t\t\tif (html.match(reUrlYoutube))\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(reUrlYoutube, iframeStart + '//www.youtube.com/embed/$1' + iframeEnd);\n\t\t\t\t\t\t$(n).after(html).remove();\n\t\t\t\t\t}\n\t\t\t\t\telse if (html.match(reUrlVimeo))\n\t\t\t\t\t{\n\t\t\t\t\t\thtml = html.replace(reUrlVimeo, iframeStart + '//player.vimeo.com/video/$2' + iframeEnd);\n\t\t\t\t\t\t$(n).after(html).remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// image\n\t\t\t\tif (convertImageLinks && html && html.match(urlImage))\n\t\t\t\t{\n\t\t\t\t\tvar matches = html.match(urlImage);\n\t\t\t\t\thtml = html.replace(urlImage, '<img src=\"' + matches + '\" />');\n\n\t\t\t\t\t$(n).after(html).remove();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// link\n\t\t\t\tif (html.search(/\\$/g) != -1) html = html.replace(/\\$/g, '&#36;');\n\n\t\t\t\tvar matches = html.match(regex);\n\t\t\t\tif (convertUrlLinks && html && matches)\n\t\t\t\t{\n\t\t\t\t\tvar len = matches.length;\n\t\t\t\t\tfor (var z = 0; z < len; z++)\n\t\t\t\t\t{\n\t\t\t\t\t\t// remove dot in the end\n\t\t\t\t\t\tif (matches[z].match(/\\.$/) !== null) matches[z] = matches[z].replace(/\\.$/, '');\n\n\t\t\t\t\t\tvar href = matches[z];\n\t\t\t\t\t\tvar text = href;\n\n\t\t\t\t\t\tvar space = '';\n\t\t\t\t\t\tif (href.match(/\\s$/) !== null) space = ' ';\n\n\t\t\t\t\t\tvar addProtocol = protocol + '://';\n\t\t\t\t\t\tif (href.match(rProtocol) !== null) addProtocol = '';\n\n\t\t\t\t\t\tif (text.length > linkSize) text = text.substring(0, linkSize) + '...';\n\t\t\t\t\t\ttext = text.replace(/&#36;/g, '$').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\n\t\t\t\t\t\t// buffer\n\t\t\t\t\t\tvar buffer = [];\n\t\t\t\t\t\tvar links = html.match('<a(.*?)</a>');\n\t\t\t\t\t\tif (links !== null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar len = links.length;\n\t\t\t\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbuffer[i] = links[i];\n\t\t\t\t\t\t\t\thtml = html.replace(links[i], '{abuffer' + i + '}');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\thtml = html.replace(href, '<a href=\\\"' + addProtocol + $.trim(href) + '\\\">' + $.trim(text) + '</a>' + space);\n\n\t\t\t\t\t\t// rebuffer\n\t\t\t\t\t\t$.each(buffer, function(i,s)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = html.replace('{abuffer' + i + '}', s);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t$(n).after(html).remove();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (n.nodeType === 1 && !/^(pre|a|button|textarea)$/i.test(n.tagName))\n\t\t\t{\n\t\t\t\t$.Redactor.fn.formatLinkify.call(n, protocol, convertLinks, convertUrlLinks, convertImageLinks, convertVideoLinks, linkSize);\n\t\t\t}\n\t\t}\n\t};\n\n})(jQuery);\n","if ( ! RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.instructions = function() {\n\treturn {\n\t\tinit: function() {\n\t\t\tvar dropdown = {};\n\t\t\tdropdown.nombres = { title: 'Insertar Campo', func: this.instructions.insertSubscriberFirstName };\n\t\t\t// dropdown.apellidos = { title: 'Insertar Variable Apellidos', func: this.instructions.insertSubscriberLastName };\n\t\t\t// dropdown.email = { title: 'Insertar Variable Email', func: this.instructions.insertSubscriberEmail };\n\n\t\t\tvar button = this.button.add('instructions', 'Campos');\n\t\t\tthis.button.setAwesome('instructions', 'fa-pencil');\n\t\t\tthis.button.addDropdown(button, dropdown);\n\t\t},\n        testButton: function(buttonName) {\n            alert(buttonName);\n        },\n\t\tinsertSubscriberFirstName: function(buttonName) {\n\t\t\t// this.$editor.focus();\n\t\t\t// this.selection.restore();\n\t\t\t// var node = $('<span>{{nombres}}</span>');\n\t\t\t// this.insert.node(node);\n\t\t\t// this.code.sync();\n\t\t\tthis.insert.text('{{campo}}');\n\t\t},\n\t\tinsertSubscriberLastName: function(buttonName) {\n\t\t\tthis.insert.text('{{apellidos}}');\n\t\t},\n\t\tinsertSubscriberEmail: function(buttonName) {\n\t\t\tthis.insert.text('{{email}}');\n\t\t}\n\t};\n};\n","if (!RedactorPlugins) var RedactorPlugins = {};\n\n(function($)\n{\n\tRedactorPlugins.table = function()\n\t{\n\t\treturn {\n\t\t\tgetTemplate: function()\n\t\t\t{\n\t\t\t\treturn String()\n\t\t\t\t+ '<section id=\"redactor-modal-table-insert\">'\n\t\t\t\t\t+ '<label>' + this.lang.get('rows') + '</label>'\n\t\t\t\t\t+ '<input type=\"text\" size=\"5\" value=\"2\" id=\"redactor-table-rows\" />'\n\t\t\t\t\t+ '<label>' + this.lang.get('columns') + '</label>'\n\t\t\t\t\t+ '<input type=\"text\" size=\"5\" value=\"3\" id=\"redactor-table-columns\" />'\n\t\t\t\t+ '</section>';\n\t\t\t},\n\t\t\tinit: function()\n\t\t\t{\n\n\t\t\t\tvar dropdown = {};\n\n\t\t\t\tdropdown.insert_table = { title: this.lang.get('insert_table'), func: this.table.show };\n\t\t\t\tdropdown.insert_row_above = { title: this.lang.get('insert_row_above'), func: this.table.addRowAbove };\n\t\t\t\tdropdown.insert_row_below = { title: this.lang.get('insert_row_below'), func: this.table.addRowBelow };\n\t\t\t\tdropdown.insert_column_left = { title: this.lang.get('insert_column_left'), func: this.table.addColumnLeft };\n\t\t\t\tdropdown.insert_column_right = { title: this.lang.get('insert_column_right'), func: this.table.addColumnRight };\n\t\t\t\tdropdown.add_head = { title: this.lang.get('add_head'), func: this.table.addHead };\n\t\t\t\tdropdown.delete_head = { title: this.lang.get('delete_head'), func: this.table.deleteHead };\n\t\t\t\tdropdown.delete_column = { title: this.lang.get('delete_column'), func: this.table.deleteColumn };\n\t\t\t\tdropdown.delete_row = { title: this.lang.get('delete_row'), func: this.table.deleteRow };\n\t\t\t\tdropdown.delete_table = { title: this.lang.get('delete_table'), func: this.table.deleteTable };\n\n\t\t\t\tthis.observe.addButton('td', 'table');\n\t\t\t\tthis.observe.addButton('th', 'table');\n\n\t\t\t\tvar button = this.button.addBefore('link', 'table', this.lang.get('table'));\n\t\t\t\tthis.button.addDropdown(button, dropdown);\n\t\t\t},\n\t\t\tshow: function()\n\t\t\t{\n\t\t\t\tthis.modal.addTemplate('table', this.table.getTemplate());\n\n\t\t\t\tthis.modal.load('table', this.lang.get('insert_table'), 300);\n\t\t\t\tthis.modal.createCancelButton();\n\n\t\t\t\tvar button = this.modal.createActionButton(this.lang.get('insert'));\n\t\t\t\tbutton.on('click', this.table.insert);\n\n\t\t\t\tthis.selection.save();\n\t\t\t\tthis.modal.show();\n\n\t\t\t\t$('#redactor-table-rows').focus();\n\n\t\t\t},\n\t\t\tinsert: function()\n\t\t\t{\n\t\t\t\tthis.placeholder.remove();\n\t\t\t\tthis.clean.cleanEmptyParagraph();\n\t\t\t\t\n\t\t\t\tvar rows = $('#redactor-table-rows').val(),\n\t\t\t\t\tcolumns = $('#redactor-table-columns').val(),\n\t\t\t\t\t$tableBox = $('<div>'),\n\t\t\t\t\ttableId = Math.floor(Math.random() * 99999),\n\t\t\t\t\t$table = $('<table id=\"table' + tableId + '\"><tbody></tbody></table>'),\n\t\t\t\t\ti, $row, z, $column;\n\n\t\t\t\tfor (i = 0; i < rows; i++)\n\t\t\t\t{\n\t\t\t\t\t$row = $('<tr>');\n\n\t\t\t\t\tfor (z = 0; z < columns; z++)\n\t\t\t\t\t{\n\t\t\t\t\t\t$column = $('<td>' + this.opts.invisibleSpace + '</td>');\n\n\t\t\t\t\t\t// set the focus to the first td\n\t\t\t\t\t\tif (i === 0 && z === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t$column.append(this.selection.getMarker());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$($row).append($column);\n\t\t\t\t\t}\n\n\t\t\t\t\t$table.append($row);\n\t\t\t\t}\n\n\t\t\t\t$tableBox.append($table);\n\t\t\t\tvar html = $tableBox.html();\n\n\t\t\t\tthis.modal.close();\n\t\t\t\tthis.selection.restore();\n\n\t\t\t\tif (this.table.getTable()) return;\n\n\t\t\t\tthis.buffer.set();\n\n\t\t\t\tvar current = this.selection.getBlock() || this.selection.getCurrent();\n\t\t\t\tif (current && current.tagName != 'BODY')\n\t\t\t\t{\n\t\t\t\t\tif (current.tagName == 'LI') current = $(current).closest('ul, ol');\n\t\t\t\t\t$(current).after(html);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.insert.html(html, false);\n\t\t\t\t}\n\n\t\t\t\tthis.selection.restore();\n\n\t\t\t\tvar table = this.$editor.find('#table' + tableId);\n\n\t\t\t\tif (!this.opts.linebreaks && (this.utils.browser('mozilla') || this.utils.browser('msie')))\n\t\t\t\t{\n\t\t\t\t\tvar $next = table.next();\n\t\t\t\t\tif ($next.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t table.after(this.opts.emptyHtml);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.observe.buttons();\n\n\t\t\t\ttable.find('span.redactor-selection-marker').remove();\n\t\t\t\ttable.removeAttr('id');\n\n\t\t\t\tthis.code.sync();\n\t\t\t\tthis.core.setCallback('insertedTable', table);\n\t\t\t},\n\t\t\tgetTable: function()\n\t\t\t{\n\t\t\t\tvar $table = $(this.selection.getParent()).closest('table');\n\n\t\t\t\tif (!this.utils.isRedactorParent($table)) return false;\n\t\t\t\tif ($table.size() === 0) return false;\n\n\t\t\t\treturn $table;\n\t\t\t},\n\t\t\trestoreAfterDelete: function($table)\n\t\t\t{\n\t\t\t\tthis.selection.restore();\n\t\t\t\t$table.find('span.redactor-selection-marker').remove();\n\t\t\t\tthis.code.sync();\n\t\t\t},\n\t\t\tdeleteTable: function()\n\t\t\t{\n\t\t\t\tvar $table = this.table.getTable();\n\t\t\t\tif (!$table) return;\n\n\t\t\t\tthis.buffer.set();\n\n\n\t\t\t\tvar $next = $table.next();\n\t\t\t\tif (!this.opts.linebreaks && $next.length !== 0)\n\t\t\t\t{\n\t\t\t\t\tthis.caret.setStart($next);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.caret.setAfter($table);\n\t\t\t\t}\n\n\n\t\t\t\t$table.remove();\n\n\t\t\t\tthis.code.sync();\n\t\t\t},\n\t\t\tdeleteRow: function()\n\t\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tvar $current = $(this.selection.getCurrent());\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current_tr = $current.closest('tr');\n\t\t\tvar $focus_tr = $current_tr.prev().length ? $current_tr.prev() : $current_tr.next();\n\t\t\tif ($focus_tr.length)\n\t\t\t{\n\t\t\t\tvar $focus_td = $focus_tr.children('td, th').first();\n\t\t\t\tif ($focus_td.length) $focus_td.prepend(this.selection.getMarker());\n\t\t\t}\n\n\t\t\t$current_tr.remove();\n\t\t\tthis.table.restoreAfterDelete($table);\n\t\t},\n\t\t\tdeleteColumn: function()\n\t\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current = $(this.selection.getCurrent());\n\t\t\tvar $current_td = $current.closest('td, th');\n\t\t\tvar index = $current_td[0].cellIndex;\n\n\t\t\t$table.find('tr').each($.proxy(function(i, elem)\n\t\t\t{\n\t\t\t\tvar $elem = $(elem);\n\t\t\t\tvar focusIndex = index - 1 < 0 ? index + 1 : index - 1;\n\t\t\t\tif (i === 0) $elem.find('td, th').eq(focusIndex).prepend(this.selection.getMarker());\n\n\t\t\t\t$elem.find('td, th').eq(index).remove();\n\n\t\t\t}, this));\n\n\t\t\tthis.table.restoreAfterDelete($table);\n\t\t},\n\t\t\taddHead: function()\n\t\t\t{\n\t\t\t\tvar $table = this.table.getTable();\n\t\t\t\tif (!$table) return;\n\n\t\t\t\tthis.buffer.set();\n\n\t\t\t\tif ($table.find('thead').size() !== 0)\n\t\t\t\t{\n\t\t\t\t\tthis.table.deleteHead();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar tr = $table.find('tr').first().clone();\n\t\t\t\ttr.find('td').replaceWith($.proxy(function()\n\t\t\t\t{\n\t\t\t\t\treturn $('<th>').html(this.opts.invisibleSpace);\n\t\t\t\t}, this));\n\n\t\t\t\t$thead = $('<thead></thead>').append(tr);\n\t\t\t\t$table.prepend($thead);\n\n\t\t\t\tthis.code.sync();\n\n\t\t\t},\n\t\t\tdeleteHead: function()\n\t\t\t{\n\t\t\t\tvar $table = this.table.getTable();\n\t\t\t\tif (!$table) return;\n\n\t\t\t\tvar $thead = $table.find('thead');\n\t\t\t\tif ($thead.size() === 0) return;\n\n\t\t\t\tthis.buffer.set();\n\n\t\t\t\t$thead.remove();\n\t\t\t\tthis.code.sync();\n\t\t\t},\n\t\t\taddRowAbove: function()\n\t\t\t{\n\t\t\t\tthis.table.addRow('before');\n\t\t\t},\n\t\t\taddRowBelow: function()\n\t\t\t{\n\t\t\t\tthis.table.addRow('after');\n\t\t\t},\n\t\t\taddColumnLeft: function()\n\t\t\t{\n\t\t\t\tthis.table.addColumn('before');\n\t\t\t},\n\t\t\taddColumnRight: function()\n\t\t\t{\n\t\t\t\tthis.table.addColumn('after');\n\t\t\t},\n\t\t\taddRow: function(type)\n\t\t\t{\n\t\t\t\tvar $table = this.table.getTable();\n\t\t\t\tif (!$table) return;\n\n\t\t\t\tthis.buffer.set();\n\n\t\t\t\tvar $current = $(this.selection.getCurrent());\n\t\t\t\tvar $current_tr = $current.closest('tr');\n\t\t\t\tvar new_tr = $current_tr.clone();\n\n\t\t\t\tnew_tr.find('th').replaceWith(function()\n\t\t\t\t{\n\t\t\t\t\tvar $td = $('<td>');\n\t\t\t\t\t$td[0].attributes = this.attributes;\n\n\t\t\t\t\treturn $td.append($(this).contents());\n\t\t\t\t});\n\n\t\t\t\tnew_tr.find('td').html(this.opts.invisibleSpace);\n\n\t\t\t\tif (type == 'after')\n\t\t\t\t{\n\t\t\t\t\t$current_tr.after(new_tr);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$current_tr.before(new_tr);\n\t\t\t\t}\n\n\t\t\t\tthis.code.sync();\n\t\t\t},\n\t\t\taddColumn: function (type)\n\t\t\t{\n\t\t\t\tvar $table = this.table.getTable();\n\t\t\t\tif (!$table) return;\n\n\t\t\t\tvar index = 0;\n\t\t\t\tvar current = $(this.selection.getCurrent());\n\n\t\t\t\tthis.buffer.set();\n\n\t\t\t\tvar $current_tr = current.closest('tr');\n\t\t\t\tvar $current_td = current.closest('td, th');\n\n\t\t\t\t$current_tr.find('td, th').each($.proxy(function(i, elem)\n\t\t\t\t{\n\t\t\t\t\tif ($(elem)[0] === $current_td[0]) index = i;\n\n\t\t\t\t}, this));\n\n\t\t\t\t$table.find('tr').each($.proxy(function(i, elem)\n\t\t\t\t{\n\t\t\t\t\tvar $current = $(elem).find('td, th').eq(index);\n\n\t\t\t\t\tvar td = $current.clone();\n\t\t\t\t\ttd.html(this.opts.invisibleSpace);\n\n\t\t\t\t\tif (type == 'after')\n\t\t\t\t\t{\n\t\t\t\t\t\t$current.after(td);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t$current.before(td);\n\t\t\t\t\t}\n\n\t\t\t\t}, this));\n\n\t\t\t\tthis.code.sync();\n\t\t\t}\n\t\t};\n\t};\n})(jQuery);","if (!RedactorPlugins) var RedactorPlugins = {};\n\n(function($)\n{\n\tRedactorPlugins.imagemanager = function()\n\t{\n\t\treturn {\n\t\t\tinit: function()\n\t\t\t{\n\t\t\t\tif (!this.opts.imageManagerJson) return;\n\n\t\t\t\tthis.modal.addCallback('image', this.imagemanager.load);\n\t\t\t},\n\t\t\tload: function()\n\t\t\t{\n\t\t\t\tvar $modal = this.modal.getModal();\n\n\t\t\t\tthis.modal.createTabber($modal);\n\t\t\t\tthis.modal.addTab(1, 'Cargar', 'active');\n\t\t\t\tthis.modal.addTab(2, 'Seleccionar');\n\n\t\t\t\t$('#redactor-modal-image-droparea').addClass('redactor-tab redactor-tab1');\n\n\t\t\t\tvar $box = $('<div id=\"redactor-image-manager-box\" style=\"overflow: auto; height: 300px;\" class=\"redactor-tab redactor-tab2\">').hide();\n\t\t\t\t$modal.append($box);\n\n\t\t\t\t$.ajax({\n\t\t\t\t  dataType: \"json\",\n\t\t\t\t  cache: false,\n\t\t\t\t  url: this.opts.imageManagerJson,\n\t\t\t\t  success: $.proxy(function(data)\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each(data, $.proxy(function(key, val)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// title\n\t\t\t\t\t\t\tvar thumbtitle = '';\n\t\t\t\t\t\t\tif (typeof val.title !== 'undefined') thumbtitle = val.title;\n\n\t\t\t\t\t\t\tvar img = $('<img src=\"' + val.thumb + '\" rel=\"' + val.image + '\" title=\"' + thumbtitle + '\" style=\"width: 100px; height: 75px; cursor: pointer;\" />');\n\t\t\t\t\t\t\t$('#redactor-image-manager-box').append(img);\n\t\t\t\t\t\t\t$(img).click($.proxy(this.imagemanager.insert, this));\n\n\t\t\t\t\t\t}, this));\n\n\n\t\t\t\t\t}, this)\n\t\t\t\t});\n\n\n\t\t\t},\n\t\t\tinsert: function(e)\n\t\t\t{\n\t\t\t\tthis.image.insert('<img src=\"' + $(e.target).attr('rel') + '\" alt=\"' + $(e.target).attr('title') + '\">');\n\t\t\t}\n\t\t};\n\t};\n})(jQuery);\n","if (!RedactorPlugins) var RedactorPlugins = {};\n\n(function($)\n{\n\tRedactorPlugins.filemanager = function()\n\t{\n\t\treturn {\n\t\t\tinit: function()\n\t\t\t{\n\t\t\t\tif (!this.opts.fileManagerJson) return;\n\n\t\t\t\tthis.modal.addCallback('file', this.filemanager.load);\n\t\t\t},\n\t\t\tload: function()\n\t\t\t{\n\t\t\t\tvar $modal = this.modal.getModal();\n\n\t\t\t\tthis.modal.createTabber($modal);\n\t\t\t\tthis.modal.addTab(1, 'Cargar', 'active');\n\t\t\t\tthis.modal.addTab(2, 'Seleccionar');\n\n\t\t\t\t$('#redactor-modal-file-upload-box').addClass('redactor-tab redactor-tab1');\n\n\t\t\t\tvar $box = $('<div id=\"redactor-file-manager-box\" style=\"overflow: auto; height: 300px;\" class=\"redactor-tab redactor-tab2\">').hide();\n\t\t\t\t$modal.append($box);\n\n\n\t\t\t\t$.ajax({\n\t\t\t\t  dataType: \"json\",\n\t\t\t\t  cache: false,\n\t\t\t\t  url: this.opts.fileManagerJson,\n\t\t\t\t  success: $.proxy(function(data)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar ul = $('<ul id=\"redactor-modal-list\">');\n\t\t\t\t\t\t$.each(data, $.proxy(function(key, val)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar a = $('<a href=\"#\" title=\"' + val.title + '\" rel=\"' + val.link + '\" class=\"redactor-file-manager-link\">' + val.title + ' <span style=\"font-size: 11px; color: #888;\">' + val.name + '</span> <span style=\"position: absolute; right: 10px; font-size: 11px; color: #888;\">(' + val.size + ')</span></a>');\n\t\t\t\t\t\t\tvar li = $('<li />');\n\n\t\t\t\t\t\t\ta.on('click', $.proxy(this.filemanager.insert, this));\n\n\t\t\t\t\t\t\tli.append(a);\n\t\t\t\t\t\t\tul.append(li);\n\n\t\t\t\t\t\t}, this));\n\n\t\t\t\t\t\t$('#redactor-file-manager-box').append(ul);\n\n\n\t\t\t\t\t}, this)\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tinsert: function(e)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar $target = $(e.target).closest('.redactor-file-manager-link');\n\n\t\t\t\tthis.file.insert('<a href=\"' + $target.attr('rel') + '\">' + $target.attr('title') + '</a>');\n\t\t\t}\n\t\t};\n\t};\n})(jQuery);\n","(function ($) {\n$.Redactor.opts.langs['es_ar'] = {\n\thtml: 'HTML',\n\tvideo: 'Video',\n\timage: 'Imagen',\n\ttable: 'Tabla',\n\tlink: 'Enlace',\n\tlink_insert: 'Insertar enlace ...',\n\tlink_edit: 'Editar enlace',\n\tunlink: 'Eliminar enlace',\n\tformatting: 'Estilos',\n\tparagraph: 'Prrafo',\n\tquote: 'Comillas',\n\tcode: 'Cdigo',\n\theader1: 'Cabecera 1',\n\theader2: 'Cabecera 2',\n\theader3: 'Cabecera 3',\n\theader4: 'Cabecera 4',\n\theader5: 'Cabecera 5',\n\tbold:  'Negrita',\n\titalic: 'Itlica',\n\tfontcolor: 'Color fuente',\n\tbackcolor: 'Color fondo',\n\tunorderedlist: 'Lista sin orden',\n\torderedlist: 'Lista ordenada',\n\toutdent: 'Disminuir sangra',\n\tindent: 'Aumentar sangra',\n\tcancel: 'Cancelar',\n\tinsert: 'Agregar',\n\tsave: 'Guardar',\n\t_delete: 'Eliminar',\n\tinsert_table: 'Agregar tabla',\n\tinsert_row_above: 'Agregar fila arriba',\n\tinsert_row_below: 'Agregar fila debajo',\n\tinsert_column_left: 'Agregar columna a la izquierda',\n\tinsert_column_right: 'Agregar column a la derecha',\n\tdelete_column: 'Eliminar columna',\n\tdelete_row: 'Eliminar fila',\n\tdelete_table: 'Eliminar tabla',\n\trows: 'Filas',\n\tcolumns: 'Columnas',\n\tadd_head: 'Agregar encabezado',\n\tdelete_head: 'Eliminar encabezado',\n\ttitle: 'Ttulo',\n\timage_position: 'Posicin',\n\tnone: 'ninguna',\n\tleft: 'izquierda',\n\tright: 'derecha',\n\timage_web_link: 'Enlace de imagen web',\n\ttext: 'Texto',\n\tmailto: 'Email',\n\tweb: 'URL',\n\tvideo_html_code: 'Cdigo embebido del video',\n\tfile: 'Archivo',\n\tupload: 'Cargar',\n\tdownload: 'Descargar',\n\tchoose: 'Seleccionar',\n\tor_choose: 'O seleccionar',\n\tdrop_file_here: 'Soltar el archivo aqu',\n\talign_left:\t'Alinear a la izquierda',\n\talign_center: 'Alinear al centro',\n\talign_right: 'Alinear a la derecha',\n\talign_justify: 'Justificar',\n\thorizontalrule: 'Trazo horizontal',\n\tfullscreen: 'Pantalla completa',\n\tdeleted: 'Eliminado',\n\tanchor: 'Anclaje',\n\tlink_new_tab: 'Abrir enlace en otra pestaa',\n\tunderline: 'Subrayado',\n\talignment: 'Alineacin',\n\tfilename: 'Nombre (opcional)',\n\tedit: 'Editar',\n\tcenter: 'centrar',\n\tupload_label: 'Suelte el archivo aqu o '\n};\n})( jQuery );\n"]}